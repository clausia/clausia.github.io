<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>QC-CPP: /qc-cpp/itpp_ext_math.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">QC-CPP
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_b3284b80b1d59ed8281421a6a4de3841.html">qc-cpp</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">itpp_ext_math.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="itpp__ext__math_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// include files {{{</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#ifndef  ITPP_EXT_MATH_VARIOUS</span></div><div class="line"><a name="l00003"></a><span class="lineno"><a class="line" href="itpp__ext__math_8cpp.html#a22e9494d1aa1bdfd27fa624702057fa4">    3</a></span>&#160;<span class="preprocessor">#define ITPP_EXT_MATH_VARIOUS</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="itpp__ext__math_8h.html">itpp_ext_math.h</a>&quot;</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="cfp__math_8cpp.html">cfp_math.cpp</a>&quot;</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// #include &lt;purity_RMT.cpp&gt;</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;itpp/itbase.h&gt;</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;itpp/stat/misc_stat.h&gt;</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// }}}</span></div><div class="line"><a name="l00010"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html">   10</a></span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceitppextmath.html">itppextmath</a>{ <span class="comment">// {{{</span></div><div class="line"><a name="l00011"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a9b56cdfb45116723442c1434a4975279">   11</a></span>&#160;  itpp::mat <a class="code" href="namespaceitppextmath.html#a9b56cdfb45116723442c1434a4975279">rotation_matrix</a>(<span class="keywordtype">double</span> theta){ <span class="comment">// {{{</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    itpp::mat R(2,2);</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    R(0,0)=cos(theta);</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    R(1,1)=R(0,0);</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    R(1,0)=sin(theta);</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    R(0,1)=-R(1,0);</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    <span class="keywordflow">return</span> R;</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;  } <span class="comment">//}}}</span></div><div class="line"><a name="l00019"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#aaa330146cd7fa196506d393531bb8e3a">   19</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="namespaceitppextmath.html#aaa330146cd7fa196506d393531bb8e3a">sum_positive_derivatives</a>(<span class="keyword">const</span> itpp::vec&amp; f){ <span class="comment">// {{{</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    <span class="keywordtype">double</span> tmp=0;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;f.size()-1; i++){</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;      <span class="keywordflow">if</span>(f(i+1)&gt;f(i)){</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;        tmp+=f(i+1)-f(i);</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;      }</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    }</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  } <span class="comment">// }}}</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <span class="comment">// number theoretical</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">// Inquiry {{{</span></div><div class="line"><a name="l00030"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#abda0475e2e66d17a104aadf815755166">   30</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; <span class="keywordtype">int</span> <a class="code" href="namespaceitppextmath.html#abda0475e2e66d17a104aadf815755166">locateLargestAbs</a>(<span class="keyword">const</span> itpp::Vec&lt;Num_T&gt;&amp; e){ <span class="comment">// {{{</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="test__spins_8cpp.html#a081a3c90b5ddb319e1866471b948e0c5">position</a>=0;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;e.size(); i++){</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="keywordflow">if</span> (abs(e(i)) &gt; abs(e(position))){</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;      position=i;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    }</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  }</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="test__spins_8cpp.html#a081a3c90b5ddb319e1866471b948e0c5">position</a>;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a70ccdba26ac2984b3a1acc5dea2835ff">   39</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="namespaceitppextmath.html#a70ccdba26ac2984b3a1acc5dea2835ff">compare</a>(<span class="keyword">const</span> itpp::cmat&amp; A, <span class="keyword">const</span> itpp::cmat&amp; B){ <span class="comment">// {{{</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="keywordflow">return</span> itpp::norm(A - B);</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;} <span class="comment">//}}}</span></div><div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#ac8dcabc8b02af619d6cde04eacbcf29c">   42</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; <span class="keywordtype">bool</span> <a class="code" href="namespaceitppextmath.html#ac8dcabc8b02af619d6cde04eacbcf29c">Contains</a>(<span class="keyword">const</span> itpp::Mat&lt;Num_T&gt;&amp; v, <span class="keyword">const</span> itpp::Vec&lt;Num_T&gt;&amp; e){<span class="comment">// {{{</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;v.rows();i++){ <span class="keywordflow">if</span> (e==v.get_row(i)) <span class="keywordflow">return</span> <span class="keyword">true</span>; }</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;} <span class="comment">//}}}</span></div><div class="line"><a name="l00046"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a82e9c92239f7f42501843b19eb7c7cf6">   46</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; <span class="keywordtype">bool</span> <a class="code" href="namespaceitppextmath.html#ac8dcabc8b02af619d6cde04eacbcf29c">Contains</a>(<span class="keyword">const</span> itpp::Array&lt;Num_T &gt;&amp; v, <span class="keyword">const</span> Num_T&amp; e){<span class="comment">// {{{</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;v.size();i++){ <span class="keywordflow">if</span> (e==v(i)) <span class="keywordflow">return</span> <span class="keyword">true</span>; }</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;} <span class="comment">//}}}</span></div><div class="line"><a name="l00050"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a343429c16a136c222ccf2fd96a282473">   50</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; <span class="keywordtype">bool</span> <a class="code" href="namespaceitppextmath.html#ac8dcabc8b02af619d6cde04eacbcf29c">Contains</a>(<span class="keyword">const</span> itpp::Array&lt;Num_T &gt;&amp; BigArray, <span class="keyword">const</span> itpp::Array&lt;Num_T &gt;&amp; SmallArray){<span class="comment">// {{{</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;SmallArray.size();i++){ <span class="keywordflow">if</span> ( !<a class="code" href="namespaceitppextmath.html#ac8dcabc8b02af619d6cde04eacbcf29c">Contains</a>(BigArray, SmallArray(i))) <span class="keywordflow">return</span> <span class="keyword">false</span>; }</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;} <span class="comment">//}}}</span></div><div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a0dc30346c37222cb0e8f2b13cdc9d5e1">   54</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; <span class="keywordtype">bool</span> <a class="code" href="namespaceitppextmath.html#ac8dcabc8b02af619d6cde04eacbcf29c">Contains</a>(<span class="keyword">const</span> itpp::Vec&lt;Num_T &gt;&amp; v, <span class="keyword">const</span> Num_T&amp; e){<span class="comment">// {{{</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;v.size();i++){ <span class="keywordflow">if</span> (e==v(i)) <span class="keywordflow">return</span> <span class="keyword">true</span>; }</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;} <span class="comment">//}}}</span></div><div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#abaa0ae2d646957edc4e61a2737d013f5">   58</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; <span class="keywordtype">bool</span> <a class="code" href="namespaceitppextmath.html#abaa0ae2d646957edc4e61a2737d013f5">AreEqual</a>(<span class="keyword">const</span> itpp::Array&lt;Num_T &gt;&amp; a1, <span class="keyword">const</span> itpp::Array&lt;Num_T &gt;&amp; a2){<span class="comment">// {{{</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <span class="keywordflow">if</span> (a1.size() != a2.size()) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;a1.size();i++){ <span class="keywordflow">if</span> (a1(i)!=a2(i)) <span class="keywordflow">return</span> <span class="keyword">false</span>; }</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;} <span class="comment">//}}}</span></div><div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a5c149ffb1a8f97dae2cb8ec5969a8d2f">   66</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; <span class="keywordtype">bool</span> <a class="code" href="namespaceitppextmath.html#a5c149ffb1a8f97dae2cb8ec5969a8d2f">AreAllEqual</a>(<span class="keyword">const</span> itpp::Vec&lt;Num_T &gt;&amp; v){<span class="comment">// {{{</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <span class="keywordflow">if</span> (v.size() == 0) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  Num_T e=v(0);</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=1; i&lt;v.size();i++){ <span class="keywordflow">if</span> (e!=v(i)) <span class="keywordflow">return</span> <span class="keyword">false</span>; }</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;} <span class="comment">//}}}</span></div><div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a76c3aff62b81888e8bd7d56b5dc3fbd4">   72</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespaceitppextmath.html#a76c3aff62b81888e8bd7d56b5dc3fbd4">DoTheyIntersect</a>(<span class="keyword">const</span> itpp::Array&lt; itpp::ivec &gt;&amp; Array1, <span class="keyword">const</span> itpp::Array&lt; itpp::ivec &gt;&amp; Array2){<span class="comment">// {{{</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;Array1.size(); i++){</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="namespaceitppextmath.html#ac8dcabc8b02af619d6cde04eacbcf29c">itppextmath::Contains</a>(Array2, Array1(i) )) {<span class="keywordflow">return</span> <span class="keyword">true</span>;}</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  } </div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;} <span class="comment">//}}}</span></div><div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a84a859248955c9f3a8e4c4f969168d92">   81</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; <span class="keywordtype">bool</span> <a class="code" href="namespaceitppextmath.html#a84a859248955c9f3a8e4c4f969168d92">AreEqual_modulo_order</a>(<span class="keyword">const</span> itpp::Array&lt;Num_T &gt;&amp; a1, <span class="keyword">const</span> itpp::Array&lt;Num_T &gt;&amp; a2){<span class="comment">// {{{</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="keywordflow">if</span> (a1.size() != a2.size()) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;a1.size();i++){ <span class="keywordflow">if</span> ( !<a class="code" href="namespaceitppextmath.html#ac8dcabc8b02af619d6cde04eacbcf29c">Contains</a>(a1, a2(i))) {<span class="keywordflow">return</span> <span class="keyword">false</span>; }}</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;} <span class="comment">//}}}</span></div><div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a65eb87e2d7ca0696c0f5cdb1fb13499d">   89</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; <span class="keywordtype">int</span> <a class="code" href="namespaceitppextmath.html#a65eb87e2d7ca0696c0f5cdb1fb13499d">total_elements_depth_2</a>(<span class="keyword">const</span> itpp::Array&lt;Num_T &gt;&amp; v){<span class="comment">// {{{</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="keywordtype">int</span> result = 0;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;v.size(); i++){</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    result += v(i).size();</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  }</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <span class="keywordflow">return</span> result;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;} <span class="comment">//}}}</span></div><div class="line"><a name="l00096"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a3bcd230a7582a2c56fd9e77cbd39d7bc">   96</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; Num_T <a class="code" href="namespaceitppextmath.html#a3bcd230a7582a2c56fd9e77cbd39d7bc">Last</a>(<span class="keyword">const</span> itpp::Array&lt;Num_T &gt;&amp; v){<span class="comment">// {{{</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="keywordflow">return</span> v(v.length()-1);</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;} <span class="comment">//}}}</span></div><div class="line"><a name="l00099"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a973576807093c6ff42014306311f888b">   99</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; <span class="keywordtype">int</span> <a class="code" href="namespaceitppextmath.html#a973576807093c6ff42014306311f888b">Position_FirstIntersection</a>(<span class="keyword">const</span> itpp::Array&lt;Num_T &gt;&amp; v, <span class="keyword">const</span> Num_T&amp; e){<span class="comment">// {{{</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;v.size();i++){ <span class="keywordflow">if</span> (e==v(i)) <span class="keywordflow">return</span> i; }</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  std::cerr &lt;&lt; <span class="stringliteral">&quot;Not found in Position_FirstIntersection\n&quot;</span>;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  abort();</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;} <span class="comment">//}}}</span></div><div class="line"><a name="l00105"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a75aa49737920b4b6a4ad21392832391a">  105</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; <span class="keywordtype">double</span> <a class="code" href="namespaceitppextmath.html#a70ccdba26ac2984b3a1acc5dea2835ff">compare</a>(<span class="keyword">const</span> itpp::Array&lt;Num_T &gt;&amp; a1, <span class="keyword">const</span> itpp::Array&lt;Num_T &gt;&amp; a2){<span class="comment">// {{{</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="keywordflow">if</span> (a1.size() != a2.size()) <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="keywordtype">double</span> x=0;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;a1.size();i++){ </div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    x+= <a class="code" href="namespaceitppextmath.html#a70ccdba26ac2984b3a1acc5dea2835ff">compare</a>(a1(i),a2(i));</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  }</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="keywordflow">return</span> x;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;} <span class="comment">//}}}</span></div><div class="line"><a name="l00116"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a69d7429d0bccffb25ef684db99b439bb">  116</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; Num_T <a class="code" href="namespaceitppextmath.html#a69d7429d0bccffb25ef684db99b439bb">proportionality_constant</a>(<span class="keyword">const</span> itpp::Vec&lt;Num_T &gt;&amp; a1, <span class="keyword">const</span> itpp::Vec&lt;Num_T &gt;&amp; a2){<span class="comment">// {{{</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="keywordflow">if</span> (a1.size() != a2.size()){</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    std::cerr &lt;&lt; <span class="stringliteral">&quot;Not even wrong&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    abort();</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  }</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <span class="keywordtype">int</span> position_largest = <a class="code" href="namespaceitppextmath.html#abda0475e2e66d17a104aadf815755166">locateLargestAbs</a>(a1);</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="keywordflow">return</span> a1(position_largest)/a2(position_largest);</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;} <span class="comment">//}}}</span></div><div class="line"><a name="l00127"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#aaef6ee82ad47629961429a15f68a7e20">  127</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; <span class="keywordtype">double</span> <a class="code" href="namespaceitppextmath.html#aaef6ee82ad47629961429a15f68a7e20">proportionality_test</a>(<span class="keyword">const</span> itpp::Vec&lt;Num_T &gt;&amp; a1, <span class="keyword">const</span> itpp::Vec&lt;Num_T &gt;&amp; a2, Num_T <a class="code" href="namespaceitppextmath.html#a69d7429d0bccffb25ef684db99b439bb">proportionality_constant</a>){<span class="comment">// {{{</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <span class="keywordflow">if</span> (a1.size() != a2.size()) <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="keywordflow">return</span> norm(a1-proportionality_constant*a2)/norm(a1);</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;} <span class="comment">//}}}</span></div><div class="line"><a name="l00134"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a21237b838322b98ba1177688518da1cd">  134</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; <span class="keywordtype">double</span> <a class="code" href="namespaceitppextmath.html#aaef6ee82ad47629961429a15f68a7e20">proportionality_test</a>(<span class="keyword">const</span> itpp::Vec&lt;Num_T &gt;&amp; a1, <span class="keyword">const</span> itpp::Vec&lt;Num_T &gt;&amp; a2){<span class="comment">// {{{</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <span class="keywordflow">if</span> (a1.size() != a2.size()) <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <span class="keywordtype">int</span> position_largest = <a class="code" href="namespaceitppextmath.html#abda0475e2e66d17a104aadf815755166">locateLargestAbs</a>(a1);</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">//   std::cout &lt;&lt; &quot;position_largest &quot; &lt;&lt; position_largest &lt;&lt;&quot;, a1(p)=&quot; &lt;&lt; a1(position_largest) &lt;&lt; std::endl; </span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  Num_T <a class="code" href="namespaceitppextmath.html#a69d7429d0bccffb25ef684db99b439bb">proportionality_constant</a>=a1(position_largest)/a2(position_largest);</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespaceitppextmath.html#aaef6ee82ad47629961429a15f68a7e20">proportionality_test</a>(a1, a2, proportionality_constant);</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;} <span class="comment">//}}}</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">// }}}</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">// Reordering, replacing, inequalities {{{</span></div><div class="line"><a name="l00146"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#aa1d2251fb9d9d3d08c5e9e12d62313ce">  146</a></span>&#160;itpp::cvec <a class="code" href="namespaceitppextmath.html#aa1d2251fb9d9d3d08c5e9e12d62313ce">ReorderLastTwoSubsystems</a>(itpp::cvec&amp; psi, <span class="keywordtype">int</span> n_middle, <span class="keywordtype">int</span> n_last){ <span class="comment">// {{{</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="comment">// the idea is to have a state psi_abc and to reorder it to get</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="comment">// the state psi_acb. n_middle is the dimension of the middle Hilbert space</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <span class="comment">// and n_last the dimension of the last Hilbert space </span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  itpp::cvec psi_reorderd(psi.size());</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  std::complex&lt;double&gt; tmp;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">//   std::cout &lt;&lt; &quot;en ReorderLastTwoSubsystems. n_middle=&quot;&lt;&lt;n_middle&lt;&lt;&quot;, n_last=&quot;&lt;&lt;n_last &lt;&lt; std::endl;</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="keywordtype">int</span> nb=n_middle, nc=n_last;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <span class="keywordtype">int</span> na=psi.size()/(nb*nc);</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="keywordtype">int</span> index_1, index_2;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ia=0; ia&lt;na; ia++){ <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ib=0; ib&lt;nb; ib++){ <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ic=0; ic&lt;nc; ic++){ </div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    </div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    index_1 = ia*nb*nc+ ib*nc+ ic;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    index_2 = ia*nb*nc+ ic*nb+ ib;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">//     std::cout &lt;&lt; &quot;[&quot;&lt;&lt;ia&lt;&lt;ib&lt;&lt;ic&lt;&lt;&quot;] Poniendo el original &quot;</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">//     &lt;&lt; index_1&lt;&lt;&quot; en la posicion &quot;&lt;&lt;index_2 &lt;&lt; std::endl;</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    psi_reorderd(index_2) = psi(index_1);</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">//     psi(index_1)= psi(index_2);</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">//     psi(index_2)= tmp; </span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  } } }</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <span class="keywordflow">return</span> psi_reorderd;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l00169"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a972d9558ac547657f651ac0eddeb85f1">  169</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceitppextmath.html#a972d9558ac547657f651ac0eddeb85f1">ReorderTwoSubsystems</a>(itpp::cvec&amp; psi, <span class="keywordtype">int</span> n_last){ <span class="comment">// {{{</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <span class="keywordtype">int</span> n_middle=psi.size()/n_last;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  psi = <a class="code" href="namespaceitppextmath.html#aa1d2251fb9d9d3d08c5e9e12d62313ce">ReorderLastTwoSubsystems</a>(psi, n_middle, n_last);</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="keywordflow">return</span>;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l00174"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a64687f56dda82cdd5ed267dde0af8122">  174</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespaceitppextmath.html#a64687f56dda82cdd5ed267dde0af8122">vector_greater_than</a>(<span class="keyword">const</span> itpp::ivec&amp; v, <span class="keyword">const</span> itpp::ivec&amp; w){ <span class="comment">// {{{</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="keywordflow">if</span> (v.size() &gt; w.size()){</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( v.size() &lt; w.size()){</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt; v.size(); i++){</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      <span class="keywordflow">if</span> ( v(i)&gt;w(i)) {</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( v(i)&lt;w(i)) {</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      } </div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    }</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  }</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;} <span class="comment">//}}}</span></div><div class="line"><a name="l00191"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#ad3aafab077621b362f7f10ee2324663c">  191</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; itpp::Array&lt;Num_T &gt;  <a class="code" href="namespaceitppextmath.html#ad3aafab077621b362f7f10ee2324663c">Replace</a>(<span class="keyword">const</span> itpp::Array&lt;Num_T &gt; v, Num_T old, Num_T nuevo){ <span class="comment">// {{{</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  itpp::Array&lt;Num_T &gt; tmp=v;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;v.size(); i++){</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordflow">if</span> (v(i)== old){</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      tmp(i)=nuevo;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    }</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  }</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="comment">//   return;</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;} <span class="comment">//}}}</span></div><div class="line"><a name="l00201"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a1497e509510ac3450b76342b601ea8f7">  201</a></span>&#160;itpp::Array&lt;itpp::ivec&gt; <a class="code" href="namespaceitppextmath.html#a1497e509510ac3450b76342b601ea8f7">sort</a>(<span class="keyword">const</span> itpp::Array&lt;itpp::ivec&gt;&amp; input){ <span class="comment">// {{{</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <span class="comment">//     http://en.wikipedia.org/wiki/Bubble_sort</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  itpp::Array&lt;itpp::ivec&gt; tmp(0), result(0);</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  itpp::ivec moco;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="keywordtype">bool</span> swaped;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> size=0; result.size() != input.size() ;size++){</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="comment">//       std::cerr &lt;&lt; &quot;size &quot; &lt;&lt; size &lt;&lt;&quot;\n&quot;;</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i&lt; input.size(); i++){</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      <span class="keywordflow">if</span> (input(i).size() == size){tmp = itpp::concat(tmp,input(i));}</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    }</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    swaped=<span class="keyword">true</span>;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="comment">//       std::cerr &lt;&lt; &quot; analizing size &quot; &lt;&lt; size &lt;&lt;&quot;\n&quot;;</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keywordflow">while</span> ( (swaped) &amp;&amp; tmp.size() &gt;1 ){</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      swaped=<span class="keyword">false</span>;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      <span class="comment">//         std::cerr &lt;&lt; &quot; New pass &quot; &lt;&lt;&quot;\n&quot;;</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;tmp.size() -1; i++){</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <span class="comment">//           std::cerr &lt;&lt; &quot;Analizing positions &quot; &lt;&lt; i &lt;&lt;&quot; and &quot;&lt;&lt;i+1 &lt;&lt;&quot;\n&quot;;</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="namespaceitppextmath.html#a64687f56dda82cdd5ed267dde0af8122">vector_greater_than</a>(tmp(i),tmp(i+1)) ){</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;          <span class="comment">//             std::cerr &lt;&lt; tmp(i) &lt;&lt; &quot; ?&gt;?&quot; &lt;&lt; tmp(i+1)  &lt;&lt;&quot;\n&quot;;</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;          moco=tmp(i); tmp(i)=tmp(i+1); tmp(i + 1)=moco;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;          swaped=<span class="keyword">true</span>;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        }</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      }</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    }</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    result = itpp::concat(tmp,result);</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    tmp.set_size(0);</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  }</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="keywordflow">return</span> result;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;} <span class="comment">//}}}</span></div><div class="line"><a name="l00231"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a7ea3a197d0c3a54f23af6363e74e4114">  231</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; itpp::Array&lt;Num_T &gt; <a class="code" href="namespaceitppextmath.html#a7ea3a197d0c3a54f23af6363e74e4114">Flatten</a>(<span class="keyword">const</span> itpp::Array&lt;itpp::Array&lt;Num_T &gt; &gt;&amp; vct){ <span class="comment">// {{{</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  itpp::Array&lt;Num_T &gt; tmp(0); </div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;vct.size(); i++){ </div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    tmp=itpp::concat(tmp,vct(i)); </div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  }</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;} <span class="comment">//}}}</span></div><div class="line"><a name="l00238"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#ab436d38c7f426bf653854ff7d919faa4">  238</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; itpp::Array&lt;Num_T &gt; <a class="code" href="namespaceitppextmath.html#ab436d38c7f426bf653854ff7d919faa4">Shuffle</a>(<span class="keyword">const</span> itpp::Array&lt;Num_T &gt;&amp; vct){ <span class="comment">// {{{</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <span class="comment">// from http://www.algoblog.com/2007/06/04/permutation/</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  itpp::Array&lt;Num_T &gt; v = vct;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=1; i&lt;v.size(); i++){ v.swap(i,itpp::randi(0,i)); }</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <span class="keywordflow">return</span> v;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;} <span class="comment">//}}}</span></div><div class="line"><a name="l00244"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a193eafa6d18269893f0419db5a089359">  244</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; <span class="keywordtype">void</span> <a class="code" href="namespaceitppextmath.html#a193eafa6d18269893f0419db5a089359">swap</a>(itpp::Vec&lt;Num_T &gt;&amp; v, <span class="keywordtype">int</span>&amp; p1, <span class="keywordtype">int</span>&amp; p2){ <span class="comment">// {{{</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  Num_T x;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  x=v(p1);</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  v(p1)=v(p2);</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  v(p2)=x;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  return ;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;} <span class="comment">//}}}</span></div><div class="line"><a name="l00251"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a1551882a7f03a19b1c2e5b8c07ab0970">  251</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; itpp::Array&lt;Num_T &gt; <a class="code" href="namespaceitppextmath.html#a1551882a7f03a19b1c2e5b8c07ab0970">CircularRotateRight</a>(<span class="keyword">const</span> itpp::Array&lt;Num_T &gt;&amp; v){ <span class="comment">// {{{</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  itpp::Array&lt;Num_T &gt; tmp=v;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  tmp.shift_right(<a class="code" href="namespaceitppextmath.html#a3bcd230a7582a2c56fd9e77cbd39d7bc">Last</a>(tmp)); </div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;} <span class="comment">//}}}</span></div><div class="line"><a name="l00256"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a1379a35d4f70d771ff5894299b818354">  256</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; itpp::Array&lt;Num_T &gt; <a class="code" href="namespaceitppextmath.html#a1551882a7f03a19b1c2e5b8c07ab0970">CircularRotateRight</a>(<span class="keyword">const</span> itpp::Array&lt;Num_T &gt;&amp; v, <span class="keyword">const</span> <span class="keywordtype">int</span> n){ <span class="comment">// {{{</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  <span class="keywordtype">int</span> n_true=n%v.size(); </div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <span class="keywordflow">if</span> (n_true == 0){<span class="keywordflow">return</span> v;}</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  <span class="keywordflow">if</span>(n_true&lt;0){n_true += v.size();}</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  itpp::Array&lt;Num_T &gt; tmp=v;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt; n_true; i++){ tmp = <a class="code" href="namespaceitppextmath.html#a1551882a7f03a19b1c2e5b8c07ab0970">CircularRotateRight</a>(tmp); }</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;} <span class="comment">//}}}</span></div><div class="line"><a name="l00264"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#ab7b5f2e5b5bbf86d9f36cd8901e239d5">  264</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; itpp::Array&lt;Num_T &gt; <a class="code" href="namespaceitppextmath.html#a1551882a7f03a19b1c2e5b8c07ab0970">CircularRotateRight</a>(<span class="keyword">const</span> itpp::Array&lt;Num_T &gt;&amp; v, <span class="keyword">const</span> <span class="keywordtype">int</span> i_left, <span class="keyword">const</span> <span class="keywordtype">int</span> i_right){ <span class="comment">// {{{</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  itpp::Array&lt;Num_T &gt; tmp=v(i_left, i_right);</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  tmp.shift_right(<a class="code" href="namespaceitppextmath.html#a3bcd230a7582a2c56fd9e77cbd39d7bc">Last</a>(tmp)); </div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;} <span class="comment">//}}}</span></div><div class="line"><a name="l00269"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a5c762614546e227cccac5f98cb574743">  269</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; itpp::Array&lt;Num_T &gt; <a class="code" href="namespaceitppextmath.html#a5c762614546e227cccac5f98cb574743">CircularRotateLeft</a>(<span class="keyword">const</span> itpp::Array&lt;Num_T &gt;&amp; v){ <span class="comment">// {{{</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  itpp::Array&lt;Num_T &gt; tmp=v;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  tmp.shift_left(v(0)); </div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;} <span class="comment">//}}}</span></div><div class="line"><a name="l00274"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a89117a3a364f78471cf07bdac7de934e">  274</a></span>&#160;itpp::cmat <a class="code" href="namespaceitppextmath.html#a89117a3a364f78471cf07bdac7de934e">Reorder_state_tensor_form</a>(itpp::cvec vector,<span class="keywordtype">int</span> which){ <span class="comment">// {{{</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  <span class="comment">//   std::cout &lt;&lt; &quot;@Reorder_state_tensor_form -2&quot; &lt;&lt; std::endl;</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <span class="keywordtype">int</span> dim1 = <a class="code" href="namespacecfpmath.html#abf5bd8dc5d8af42a850231816e60e95f">cfpmath::pow_2</a>(<a class="code" href="namespacecfpmath.html#a6500e09a78acb96aa9644c42d791f7ac">cfpmath::BitCount</a>(which)); </div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <span class="comment">//   std::cout &lt;&lt; &quot;@Reorder_state_tensor_form -1&quot; &lt;&lt; std::endl;</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  <span class="keywordtype">int</span> dim2 = vector.size()/dim1;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <span class="comment">//   std::cout &lt;&lt; &quot;@Reorder_state_tensor_form 0&quot; &lt;&lt; std::endl;</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">//   int qubits=cfpmath::log_base_2(vector.size());</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  itpp::cmat out(dim2,dim1); out=0.;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <span class="keywordtype">int</span> col, row; </div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  <span class="comment">//   std::cout &lt;&lt; &quot;@Reorder_state_tensor_form 1&quot; &lt;&lt; std::endl;</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;vector.size(); j++){</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <a class="code" href="namespacecfpmath.html#af25df9cc11a1a7a76dfa8262e44c1702">cfpmath::extract_digits</a>(j,col,row,which);</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    out(row,col)=vector(j);</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  }</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <span class="keywordflow">return</span> out;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">// }}}</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">// Linear Algebra {{{</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">// Traces and Partial traces </span></div><div class="line"><a name="l00293"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a5eba978dfe35f1f0bde18022126e5872">  293</a></span>&#160;itpp::cmat <a class="code" href="namespaceitppextmath.html#a5eba978dfe35f1f0bde18022126e5872">partial_trace</a>(<span class="keyword">const</span> itpp::cvec&amp; state, <span class="keywordtype">int</span> dim_leave){ <span class="comment">// {{{</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  <span class="comment">// This partial trace allows to leave a space of arbitrary dimension. Let </span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  <span class="comment">// H = H_a H_b be th ehilbert space. &quot;i&quot; labels H_a and &quot;j&quot; the H_b</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <span class="comment">// then</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  <span class="comment">// psi = \sum \alpha_ij |ij&gt;</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  <span class="comment">// so</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  <span class="comment">// rho_AB = \sum_{iji&#39;j&#39;} \alpha_{ij} \alpha_{i&#39;j&#39;}^* |ij&gt;&lt;i&#39;j&#39;|</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <span class="comment">// rho_B  = \sum_{ji&#39;j&#39;} \alpha_{ij} \alpha_{ij&#39;}^* |j&gt;&lt;j&#39;|</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  itpp::cmat rho_B(dim_leave,dim_leave );</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">//   std::cout &lt;&lt; &quot;@partial_trace_qubits 2&quot; &lt;&lt; itpp::norm(reordered_state) &lt;&lt;std::endl;</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j =0; j&lt; dim_leave; j++){</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jp =0; jp&lt; dim_leave; jp++){</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      rho_B(j,jp)=0;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i =0; i&lt; state.size()/dim_leave; i++){</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        rho_B(j,jp)+=conj(state(i*dim_leave +jp) )*state(i*dim_leave +j);</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      }</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    }</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  }</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">//   std::cout &lt;&lt; itpp::trace(rho_B) &lt;&lt; std::endl;</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">//   abort();</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  <span class="keywordflow">return</span> rho_B;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l00316"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#ab860b21cbbd29f9682209fb7ac337126">  316</a></span>&#160;itpp::cmat <a class="code" href="namespaceitppextmath.html#ab860b21cbbd29f9682209fb7ac337126">partial_trace_qubits</a>(itpp::cvec state, <span class="keywordtype">int</span> which){ <span class="comment">// {{{</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">//   std::cout &lt;&lt; &quot;@partial_trace_qubits 1&quot; &lt;&lt; std::endl;</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="keywordtype">int</span> size_rho=<a class="code" href="namespacecfpmath.html#abf5bd8dc5d8af42a850231816e60e95f">cfpmath::pow_2</a>(<a class="code" href="namespacecfpmath.html#a6500e09a78acb96aa9644c42d791f7ac">cfpmath::BitCount</a>(which));</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment">//   std::cout &lt;&lt; &quot;@partial_trace_qubits size_rho=&quot; &lt;&lt; size_rho </span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">//     &lt;&lt; &quot;, which = &quot; &lt;&lt; which &lt;&lt; std::endl;</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  itpp::cmat reordered_state = <a class="code" href="namespaceitppextmath.html#a89117a3a364f78471cf07bdac7de934e">Reorder_state_tensor_form</a>(state, which), rho(size_rho,size_rho );</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">//   std::cout &lt;&lt; &quot;@partial_trace_qubits 2&quot; &lt;&lt; itpp::norm(reordered_state) &lt;&lt;std::endl;</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="test__spins_8cpp.html#a3900d1f52906b420113c1d1d8310ea84">i1</a> =0; <a class="code" href="test__spins_8cpp.html#a3900d1f52906b420113c1d1d8310ea84">i1</a>&lt; size_rho; <a class="code" href="test__spins_8cpp.html#a3900d1f52906b420113c1d1d8310ea84">i1</a>++){</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="test__spins_8cpp.html#a09269322a87977965885dfb82976ef64">i2</a> =0; <a class="code" href="test__spins_8cpp.html#a09269322a87977965885dfb82976ef64">i2</a>&lt; size_rho; <a class="code" href="test__spins_8cpp.html#a09269322a87977965885dfb82976ef64">i2</a>++){</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      rho(<a class="code" href="test__spins_8cpp.html#a3900d1f52906b420113c1d1d8310ea84">i1</a>,<a class="code" href="test__spins_8cpp.html#a09269322a87977965885dfb82976ef64">i2</a>)=itpp::conj(reordered_state.get_col(<a class="code" href="test__spins_8cpp.html#a09269322a87977965885dfb82976ef64">i2</a>))*reordered_state.get_col(<a class="code" href="test__spins_8cpp.html#a3900d1f52906b420113c1d1d8310ea84">i1</a>);</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    }</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  }</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">//   std::cout &lt;&lt; itpp::trace(rho) &lt;&lt; std::endl;</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">//   abort();</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="keywordflow">return</span> rho;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l00333"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#aa20dfeca3f68eda17c2fcadfa31bf670">  333</a></span>&#160;itpp::cmat <a class="code" href="namespaceitppextmath.html#ab860b21cbbd29f9682209fb7ac337126">partial_trace_qubits</a>(<span class="keyword">const</span> itpp::cmat&amp; rho, <span class="keywordtype">int</span> which){ <span class="comment">// {{{</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">//   std::cout &lt;&lt; &quot;@partial_trace_qubits 1&quot; &lt;&lt; std::endl;</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <span class="keywordtype">int</span> DimensionB=<a class="code" href="namespacecfpmath.html#abf5bd8dc5d8af42a850231816e60e95f">cfpmath::pow_2</a>(<a class="code" href="namespacecfpmath.html#a6500e09a78acb96aa9644c42d791f7ac">cfpmath::BitCount</a>(which));</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">//   std::cout &lt;&lt; &quot;@partial_trace_qubits DimensionB &quot; &lt;&lt; DimensionB &lt;&lt; std::endl;</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  itpp::cmat rho_out(DimensionB, DimensionB);</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  <span class="keywordtype">int</span> TotalDimension=rho.cols();</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  <span class="keywordtype">int</span> DimensionA=TotalDimension/DimensionB;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  std::complex&lt;double&gt; tmp;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <span class="keywordtype">int</span> ab1, ab2;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> b1 =0; b1&lt; DimensionB; b1++){</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> b2 =0; b2&lt; DimensionB; b2++){</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      tmp=0.;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> a=0; a&lt;DimensionA; a++){</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        ab1=<a class="code" href="namespacecfpmath.html#a0e87a9ace78d12b29b6219ec271fa11a">cfpmath::merge_two_numbers</a>(b1, a, which);</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        ab2=<a class="code" href="namespacecfpmath.html#a0e87a9ace78d12b29b6219ec271fa11a">cfpmath::merge_two_numbers</a>(b2, a, which);</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        tmp+=rho(ab1, ab2);</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      }</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;      rho_out(b1,b2)=tmp;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    }</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  }</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">//   std::cout &lt;&lt; itpp::trace(rho) &lt;&lt; std::endl;</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">//   abort();</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  <span class="keywordflow">return</span> rho_out;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l00359"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#ad369a86d5a4ee2ad4f4006be7ae95596">  359</a></span>&#160;std::complex&lt;double&gt; <a class="code" href="namespaceitppextmath.html#ad369a86d5a4ee2ad4f4006be7ae95596">trAB</a>(<span class="keyword">const</span> itpp::cmat&amp; A, <span class="keyword">const</span> itpp::cmat&amp; B){ <span class="comment">// {{{</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  <span class="comment">// Calculates tr A.B</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  std::complex&lt;double&gt; tr=0;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  <span class="keywordtype">int</span> ni=A.cols(); <span class="comment">// 2</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  <span class="keywordtype">int</span> nj=A.rows(); <span class="comment">// 1</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <span class="keywordflow">if</span> (ni!=B.rows() || nj !=B.cols()){</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    std::cerr &lt;&lt; <span class="stringliteral">&quot;Error en trAB&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    abort();</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  }</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;ni; i++){</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;nj; j++){</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      tr+=B(i,j)*A(j,i);</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment">//       std::cout &lt;&lt; A(i,j)*B(j,i) &lt;&lt; </span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    }</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  }</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  <span class="keywordflow">return</span> tr;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">// Tensor Products </span></div><div class="line"><a name="l00378"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a15f176e454b10ef725db0f43e171496f">  378</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; itpp::Mat&lt;Num_T&gt; <a class="code" href="namespaceitppextmath.html#a15f176e454b10ef725db0f43e171496f">postpend_tensor_identity</a>(<span class="keyword">const</span> itpp::Mat&lt;Num_T&gt;&amp; Matrix, <span class="keyword">const</span> <span class="keywordtype">int</span> dim_identity){ <span class="comment">// {{{</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  itpp::Mat&lt;Num_T&gt; tmp(Matrix.rows()*dim_identity, Matrix.cols()*dim_identity);</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  tmp.zeros();</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  Num_T x;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  <span class="keywordtype">int</span> pos_cols, pos_rows;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_rows=0; i_rows &lt;  Matrix.rows(); i_rows++){</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_cols=0; i_cols &lt;  Matrix.cols(); i_cols++){</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      x=Matrix(i_rows, i_cols);</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      pos_cols=dim_identity*i_cols;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      pos_rows=dim_identity*i_rows;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_diag=0; i_diag&lt;dim_identity; i_diag++){tmp(pos_rows+i_diag, pos_cols+i_diag)= x;}</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    }</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  }</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l00393"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a5f9b38a799e52559d90d12d3672cb004">  393</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; itpp::Mat&lt;Num_T&gt; <a class="code" href="namespaceitppextmath.html#a5f9b38a799e52559d90d12d3672cb004">extend_qubit_operator</a>(<span class="keyword">const</span> itpp::Mat&lt;Num_T&gt;&amp; Matrix, <span class="keyword">const</span> <span class="keywordtype">int</span> encoded_nontrivial_positions, <span class="keyword">const</span> <span class="keywordtype">int</span> total_number_of_qubits){ <span class="comment">// {{{</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  itpp::Mat&lt;Num_T&gt; tmp(<a class="code" href="namespacecfpmath.html#abf5bd8dc5d8af42a850231816e60e95f">cfpmath::pow_2</a>(total_number_of_qubits),<a class="code" href="namespacecfpmath.html#abf5bd8dc5d8af42a850231816e60e95f">cfpmath::pow_2</a>(total_number_of_qubits));</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  tmp=0.;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  <span class="keywordtype">int</span> number_of_nontrivial_positions = <a class="code" href="namespacecfpmath.html#a6500e09a78acb96aa9644c42d791f7ac">cfpmath::BitCount</a>(encoded_nontrivial_positions);</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  <span class="keywordtype">int</span> i_col_total, j_col_total;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="namespacecfpmath.html#abf5bd8dc5d8af42a850231816e60e95f">cfpmath::pow_2</a>(total_number_of_qubits-number_of_nontrivial_positions); i++) {</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_col=0; i_col&lt;<a class="code" href="namespacecfpmath.html#abf5bd8dc5d8af42a850231816e60e95f">cfpmath::pow_2</a>(number_of_nontrivial_positions); i_col++){ </div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;      i_col_total = <a class="code" href="namespacecfpmath.html#a0e87a9ace78d12b29b6219ec271fa11a">cfpmath::merge_two_numbers</a>(i_col, i, encoded_nontrivial_positions);</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j_col=0; j_col&lt;<a class="code" href="namespacecfpmath.html#abf5bd8dc5d8af42a850231816e60e95f">cfpmath::pow_2</a>(number_of_nontrivial_positions); j_col++){ </div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        j_col_total = <a class="code" href="namespacecfpmath.html#a0e87a9ace78d12b29b6219ec271fa11a">cfpmath::merge_two_numbers</a>(j_col, i, encoded_nontrivial_positions);</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        tmp(i_col_total, j_col_total)=Matrix(i_col, j_col);</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;      }</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    }</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  }</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;}</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment">// }}}</span></div><div class="line"><a name="l00412"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#afe49034f5f5fe3d1283091d37e8cdd7d">  412</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; itpp::Mat&lt;Num_T&gt; <a class="code" href="namespaceitppextmath.html#afe49034f5f5fe3d1283091d37e8cdd7d">single_qubit_operator_tensor_identity</a>(<span class="keyword">const</span> itpp::Mat&lt;Num_T&gt;&amp; Matrix, <span class="keyword">const</span> <span class="keywordtype">int</span> position_operator, <span class="keyword">const</span> <span class="keywordtype">int</span> total_number_of_qubits){ <span class="comment">// {{{</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  itpp::Mat&lt;Num_T&gt; tmp(<a class="code" href="namespacecfpmath.html#abf5bd8dc5d8af42a850231816e60e95f">cfpmath::pow_2</a>(total_number_of_qubits),<a class="code" href="namespacecfpmath.html#abf5bd8dc5d8af42a850231816e60e95f">cfpmath::pow_2</a>(total_number_of_qubits));</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  <span class="keywordtype">int</span> i0,<a class="code" href="test__spins_8cpp.html#a3900d1f52906b420113c1d1d8310ea84">i1</a>;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  tmp=0.;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="namespacecfpmath.html#abf5bd8dc5d8af42a850231816e60e95f">cfpmath::pow_2</a>(total_number_of_qubits-1); i++) {</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    i0=<a class="code" href="namespacecfpmath.html#aa9552f51ffa8ef05e0724fe8a18f4456">cfpmath::insert_bit</a>(i, position_operator, 0);</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    i1=<a class="code" href="namespacecfpmath.html#aa9552f51ffa8ef05e0724fe8a18f4456">cfpmath::insert_bit</a>(i, position_operator, 1);</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    tmp(i0,i0)=Matrix(0,0);</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    tmp(i0,i1)=Matrix(0,1);</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    tmp(i1,i0)=Matrix(1,0);</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    tmp(i1,i1)=Matrix(1,1);</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  }</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l00427"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a07082ab034f2a60722bdc871d3fe7f4c">  427</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; itpp::Mat&lt;Num_T&gt; <a class="code" href="namespaceitppextmath.html#a07082ab034f2a60722bdc871d3fe7f4c">prepend_tensor_identity</a>(<span class="keyword">const</span> itpp::Mat&lt;Num_T&gt;&amp; Matrix, <span class="keyword">const</span> <span class="keywordtype">int</span> dim_identity){ <span class="comment">// {{{</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  <span class="keywordtype">int</span> rows_mat= Matrix.rows(), cols_mat= Matrix.cols() ;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  itpp::Mat&lt;Num_T&gt; tmp(rows_mat*dim_identity, cols_mat*dim_identity);</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  tmp.zeros();</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_diag=0; i_diag&lt;dim_identity; i_diag++){</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    tmp.set_submatrix(rows_mat*i_diag, cols_mat*i_diag, Matrix);</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  }</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l00436"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#ac8477886770d8df6d3dedba2eca68d43">  436</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; itpp::Mat&lt;Num_T&gt; <a class="code" href="namespaceitppextmath.html#ac8477886770d8df6d3dedba2eca68d43">TensorProduct</a>(<span class="keyword">const</span> itpp::Mat&lt;Num_T&gt;&amp; Matrix1, <span class="keyword">const</span> itpp::Mat&lt;Num_T&gt;&amp; Matrix2, <span class="keyword">const</span> itpp::Mat&lt;Num_T&gt;&amp; Matrix3){ <span class="comment">// {{{</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="keywordflow">return</span> <a class="code" href="namespaceitppextmath.html#ac8477886770d8df6d3dedba2eca68d43">TensorProduct</a>(<a class="code" href="namespaceitppextmath.html#ac8477886770d8df6d3dedba2eca68d43">TensorProduct</a>(Matrix1,Matrix2),Matrix3);</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l00439"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a700631626cf0e4481139401c6ed6bf6f">  439</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; itpp::Vec&lt;Num_T&gt; <a class="code" href="namespaceitppextmath.html#ac8477886770d8df6d3dedba2eca68d43">TensorProduct</a>(<span class="keyword">const</span> itpp::Vec&lt;Num_T&gt;&amp; Vec1, <span class="keyword">const</span> itpp::Vec&lt;Num_T&gt;&amp; Vec2){ <span class="comment">// {{{</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  itpp::Vec&lt;Num_T&gt; tmp(Vec1.size()*Vec2.size());</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  tmp.zeros();</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="test__spins_8cpp.html#a3900d1f52906b420113c1d1d8310ea84">i1</a>=0; <a class="code" href="test__spins_8cpp.html#a3900d1f52906b420113c1d1d8310ea84">i1</a>&lt;Vec1.size(); <a class="code" href="test__spins_8cpp.html#a3900d1f52906b420113c1d1d8310ea84">i1</a>++){</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="test__spins_8cpp.html#a09269322a87977965885dfb82976ef64">i2</a>=0; <a class="code" href="test__spins_8cpp.html#a09269322a87977965885dfb82976ef64">i2</a>&lt;Vec2.size(); <a class="code" href="test__spins_8cpp.html#a09269322a87977965885dfb82976ef64">i2</a>++){</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment">//       std::cout &lt;&lt; i1 &lt;&lt; &quot;, &quot; &lt;&lt; i2 &lt;&lt; &quot;, &quot; &lt;&lt;i1*Vec1.size() + i2 &lt;&lt; std::endl;</span></div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      tmp(<a class="code" href="test__spins_8cpp.html#a3900d1f52906b420113c1d1d8310ea84">i1</a>*Vec2.size() + <a class="code" href="test__spins_8cpp.html#a09269322a87977965885dfb82976ef64">i2</a> )=Vec1(<a class="code" href="test__spins_8cpp.html#a3900d1f52906b420113c1d1d8310ea84">i1</a>)*Vec2(<a class="code" href="test__spins_8cpp.html#a09269322a87977965885dfb82976ef64">i2</a>);</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment">//       std::cout &lt;&lt; Vec1(i1)*Vec2(i2) &lt;&lt; std::endl;</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    }</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  }</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment">//       std::cout &lt;&lt; &quot;Hola cabron &quot; &lt;&lt; std::endl;</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l00452"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a35811732178ec37e754aa1c53b3f4da0">  452</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; itpp::Vec&lt;Num_T&gt; <a class="code" href="namespaceitppextmath.html#ac8477886770d8df6d3dedba2eca68d43">TensorProduct</a>(<span class="keyword">const</span> itpp::Array&lt;itpp::Vec&lt;Num_T&gt; &gt;&amp; States){ <span class="comment">// {{{</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  itpp::Vec&lt;Num_T&gt; tmp=States(0);</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=1; i&lt;States.size(); i++){</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    tmp=<a class="code" href="namespaceitppextmath.html#ac8477886770d8df6d3dedba2eca68d43">TensorProduct</a>(tmp,States(i));</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  }</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l00459"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a6631d2e657766ca4f7188ca5085706c0">  459</a></span>&#160;itpp::cvec <a class="code" href="namespaceitppextmath.html#ac8477886770d8df6d3dedba2eca68d43">TensorProduct</a>(<span class="keyword">const</span> itpp::cvec&amp; Vec1, <span class="keyword">const</span> itpp::vec&amp; Vec2){ <span class="comment">// {{{</span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="keywordflow">return</span> <a class="code" href="namespaceitppextmath.html#ac8477886770d8df6d3dedba2eca68d43">TensorProduct</a>(Vec1, to_cvec(Vec2));</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="comment">// return Vec1;</span></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l00463"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#add1973a5f621a0d0ca84ca95461bb7b8">  463</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; itpp::Mat&lt;Num_T&gt; <a class="code" href="namespaceitppextmath.html#ac8477886770d8df6d3dedba2eca68d43">TensorProduct</a>(<span class="keyword">const</span> itpp::Mat&lt;Num_T&gt;&amp; Matrix1, <span class="keyword">const</span> itpp::Mat&lt;Num_T&gt;&amp; Matrix2){ <span class="comment">// {{{</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment">//   cerr &lt;&lt; &quot;There is the itpp::kron function that does exactly what I wanted here&quot; &lt;&lt; endl ; </span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment">//   abort();</span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment">//   itpp::Mat&lt;Num_T&gt; tmp(Matrix1.rows()*Matrix2.rows(), Matrix1.cols()*Matrix2.cols());</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="comment">//   tmp.zeros();</span></div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="comment">//   for (int i_row=0; i_row&lt; Matrix1.rows(); i_row++){</span></div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="comment">//     for (int i_col=0; i_col&lt; Matrix1.cols(); i_col++){</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment">//       tmp.set_submatrix(i_row*Matrix2.rows(),i_col*Matrix2.cols(), Matrix1(i_row,i_col)*Matrix2);</span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="comment">//     }</span></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="comment">//   }</span></div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  <span class="keywordflow">return</span> itpp::kron(Matrix1, Matrix2);</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l00475"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a6af53d4d1f01f6e90d8e91a62cef4de8">  475</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; itpp::Mat&lt;Num_T&gt; <a class="code" href="namespaceitppextmath.html#ac8477886770d8df6d3dedba2eca68d43">TensorProduct</a>(<span class="keyword">const</span> itpp::Array&lt;itpp::Mat&lt;Num_T&gt; &gt;&amp; Matrices){ <span class="comment">// {{{</span></div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  itpp::Mat&lt;Num_T&gt; tmp=Matrices(0);</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=1; i&lt;Matrices.size(); i++){</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    tmp=itpp::kron(tmp,Matrices(i));</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  }</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l00482"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#aa85670a604e77be318577a0c8dfd7ef1">  482</a></span>&#160;itpp::cvec <a class="code" href="namespaceitppextmath.html#aa85670a604e77be318577a0c8dfd7ef1">TensorPow</a>(<span class="keyword">const</span> itpp::cvec state, <span class="keywordtype">int</span> qub){ <span class="comment">//{{{</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;itpp::cvec newstate;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;newstate=state;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;qub-1;i++){</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;newstate=<a class="code" href="namespaceitppextmath.html#ac8477886770d8df6d3dedba2eca68d43">TensorProduct</a>(newstate,state);</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;}</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="keywordflow">return</span> newstate;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;} <span class="comment">//}}}</span></div><div class="line"><a name="l00490"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a28180dcf2f4fa554a686764f392dd934">  490</a></span>&#160;itpp::cmat <a class="code" href="namespaceitppextmath.html#aa85670a604e77be318577a0c8dfd7ef1">TensorPow</a>(<span class="keyword">const</span> itpp::cmat Matrix, <span class="keywordtype">int</span> qub){ <span class="comment">//{{{</span></div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;itpp::cmat newMatrix;</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;newMatrix=Matrix;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;qub-1;i++){</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;newMatrix=<a class="code" href="namespaceitppextmath.html#ac8477886770d8df6d3dedba2eca68d43">TensorProduct</a>(newMatrix,Matrix);</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;}</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="keywordflow">return</span> newMatrix;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;} <span class="comment">//}}}</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="comment">// Exponentiation</span></div><div class="line"><a name="l00499"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#afaf99d19367b6887a3d6ad79622eee98">  499</a></span>&#160;itpp::mat <a class="code" href="namespaceitppextmath.html#afaf99d19367b6887a3d6ad79622eee98">exponentiate_real_symmetric</a>(<span class="keyword">const</span> itpp::mat&amp; Matrix){ <span class="comment">// {{{</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="comment">// template &lt;class Num_T&gt; itpp::Mat&lt;Num_T&gt; exponentiate(itpp::Mat&lt;Num_T&gt; Matrix){</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  <span class="comment">//Calculates exp(H)</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  itpp::mat tmp;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  itpp::vec eigenvalues;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  itpp::mat V;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  <span class="keywordtype">bool</span> exito = itpp::eig_sym(Matrix, eigenvalues, V);</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  <span class="keywordtype">double</span> how_symmetric = <a class="code" href="namespaceitppextmath.html#a16056fce786f8680434907f52f86c4d5">test_symmetry</a>(Matrix);</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  <span class="keywordflow">if</span> (exito==<span class="keyword">false</span> || how_symmetric &gt; 10e-12){</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    std::cerr &lt;&lt; <span class="stringliteral">&quot;Algun pedo en exponentiate_real_symmetric\n&quot;</span>; </div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    abort();</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  }</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  tmp = V*itpp::diag(itpp::exp(eigenvalues))* V.hermitian_transpose();</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l00514"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#af0b1e30122a83066769ccf797e2a8a57">  514</a></span>&#160;itpp::cmat <a class="code" href="namespaceitppextmath.html#af0b1e30122a83066769ccf797e2a8a57">exponentiate</a>(<span class="keyword">const</span> itpp::cmat&amp; Matrix){ <span class="comment">// {{{</span></div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment">//   std::cout &lt;&lt; &quot;@exponentiate, 1&quot; &lt;&lt; std::endl;</span></div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment">// template &lt;class Num_T&gt; itpp::Mat&lt;Num_T&gt; exponentiate(itpp::Mat&lt;Num_T&gt; Matrix){</span></div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;  <span class="comment">//Calculates exp(H)</span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  <span class="keywordtype">double</span> how_real_symmetric = <a class="code" href="namespaceitppextmath.html#adb8774c97d655de71f3bf73fd3fc4103">test_real_symmetric</a>(Matrix);</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  <span class="keywordflow">if</span> (how_real_symmetric &lt; 10e-14){</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="keywordflow">return</span> itpp::to_cmat(<a class="code" href="namespaceitppextmath.html#afaf99d19367b6887a3d6ad79622eee98">exponentiate_real_symmetric</a>(itpp::real(Matrix)));</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  }</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  itpp::cmat tmp;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  itpp::cvec eigenvalues;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  itpp::cmat V;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  <span class="keywordtype">bool</span> exito = itpp::eig(Matrix, eigenvalues, V);</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  <span class="keywordtype">double</span> revision; </div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  revision = itpp::norm(Matrix -</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;      V*itpp::diag(eigenvalues)* V.hermitian_transpose())/itpp::norm(Matrix);</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="comment">//   std::cout &lt;&lt; &quot;@exponentiate, 50. Error es &quot; &lt;&lt; revision &lt;&lt; std::endl;</span></div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  <span class="keywordflow">if</span> (revision &gt; 10e-12 || !exito){</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    std::cerr &lt;&lt; <span class="stringliteral">&quot;Matrix=&quot;</span> &lt;&lt; Matrix &lt;&lt; std::endl;  </div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    std::cerr &lt;&lt; <span class="stringliteral">&quot;Eigenvalores=&quot;</span> &lt;&lt; eigenvalues &lt;&lt; std::endl;  </div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    std::cerr &lt;&lt; <span class="stringliteral">&quot;Ortonormalidad de eigenvectores=&quot;</span> &lt;&lt; itpp::norm(V*V.hermitian_transpose()-itpp::eye_c(Matrix.size())) &lt;&lt; std::endl;  </div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    std::cerr &lt;&lt; <span class="stringliteral">&quot;Ortonormalidad de eigenvectores, matriz completa=\n&quot;</span> &lt;&lt; abs(V*V.hermitian_transpose()) &lt;&lt; std::endl;  </div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;Matrix.rows(); i++){</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;      std::cerr &lt;&lt; <span class="stringliteral">&quot;Ecuacion de eigengectores sirve? i=&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; norm(Matrix*V.get_col(i)-eigenvalues(i)*V.get_col(i)) &lt;&lt; std::endl;  </div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    }</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    std::cerr &lt;&lt; <span class="stringliteral">&quot;Algun pedo en exponentiate! \nRevision=&quot;</span> &lt;&lt; revision </div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;      &lt;&lt;<span class="stringliteral">&quot;Normas, &quot;</span>&lt;&lt;itpp::norm(Matrix) &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; exito &lt;&lt; std::endl; </div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    std::cerr &lt;&lt; <span class="stringliteral">&quot;La rutina de lapack tiene pedos cuando esta muy sparse la matriz,\n&quot;</span></div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;      &lt;&lt;<span class="stringliteral">&quot;por ejemplo un elemento del modelo de free fermions con 2D en primeros vecinos&quot;</span> &lt;&lt; std::endl; </div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    abort();</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  }</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;  tmp = V*itpp::diag(itpp::exp(eigenvalues))* V.hermitian_transpose();</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">//   std::cout &lt;&lt; &quot;@exponentiate, 100&quot; &lt;&lt; std::endl;</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l00549"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#abedfdae89806f348cd9f1001f858473c">  549</a></span>&#160;itpp::cmat <a class="code" href="namespaceitppextmath.html#abedfdae89806f348cd9f1001f858473c">exponentiate_nonsym</a>(<span class="keyword">const</span> itpp::cmat&amp; Matrix){ <span class="comment">// {{{</span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="comment">// template &lt;class Num_T&gt; itpp::Mat&lt;Num_T&gt; exponentiate(itpp::Mat&lt;Num_T&gt; Matrix){</span></div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  <span class="comment">//Calculates exp(H) for NON-HERMITIAN matrix</span></div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  <span class="keywordtype">double</span> how_real_symmetric = <a class="code" href="namespaceitppextmath.html#adb8774c97d655de71f3bf73fd3fc4103">test_real_symmetric</a>(Matrix);</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;  <span class="keywordflow">if</span> (how_real_symmetric &lt; 10e-14){</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <span class="keywordflow">return</span> itpp::to_cmat(<a class="code" href="namespaceitppextmath.html#afaf99d19367b6887a3d6ad79622eee98">exponentiate_real_symmetric</a>(itpp::real(Matrix)));</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  }</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  itpp::cmat tmp;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  itpp::cvec eigenvalues;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  itpp::cmat V;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  itpp::cmat invV;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  <span class="keywordtype">bool</span> exito = itpp::eig(Matrix, eigenvalues, V);</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;  <span class="keywordtype">bool</span> exito2 = itpp::inv(V,invV);</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  <span class="keywordtype">double</span> revition; </div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  revition = itpp::norm(Matrix -</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;      (V*itpp::diag(eigenvalues)* invV));</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  <span class="keywordflow">if</span> (revition &gt; 10e-12 || !exito || !exito2){</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    std::cerr &lt;&lt; <span class="stringliteral">&quot;Algun xxx pedo en exponentiate &quot;</span> &lt;&lt; revition &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; exito &lt;&lt; std::endl; </div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    std::cerr &lt;&lt; <span class="stringliteral">&quot;La rutina de lapack tiene pedos cuando esta muy sparse la matriz,\n&quot;</span></div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;      &lt;&lt;<span class="stringliteral">&quot;por ejemplo un elemento del modelo de free fermions con 2D en primeros vecinos&quot;</span> &lt;&lt; std::endl; </div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    abort();</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;  }</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  tmp = V*itpp::diag(itpp::exp(eigenvalues))* invV;</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l00575"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a34772ce3f049e18d9ac7b686df16736f">  575</a></span>&#160;itpp::cmat <a class="code" href="namespaceitppextmath.html#af0b1e30122a83066769ccf797e2a8a57">exponentiate</a>(<span class="keyword">const</span> itpp::mat&amp; Matrix){ <span class="comment">// {{{</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="comment">// template &lt;class Num_T&gt; itpp::Mat&lt;Num_T&gt; exponentiate(itpp::Mat&lt;Num_T&gt; Matrix){</span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  <span class="comment">//Calculates exp(H)</span></div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  <span class="keywordtype">double</span> how_symmetric = <a class="code" href="namespaceitppextmath.html#a16056fce786f8680434907f52f86c4d5">test_symmetry</a>(Matrix);</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;  <span class="keywordflow">if</span> (how_symmetric &lt; 10e-14){</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <span class="keywordflow">return</span> itpp::to_cmat(<a class="code" href="namespaceitppextmath.html#afaf99d19367b6887a3d6ad79622eee98">exponentiate_real_symmetric</a>(Matrix));</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;  }</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;  itpp::cmat tmp;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;  itpp::cvec eigenvalues;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;  itpp::cmat V;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  <span class="keywordtype">bool</span> exito = itpp::eig(Matrix, eigenvalues, V);</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;  <span class="keywordtype">double</span> revition; </div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  revition = itpp::norm(Matrix -</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;      V*itpp::diag(eigenvalues)* V.hermitian_transpose());</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  <span class="keywordflow">if</span> (revition &gt; 10e-12 || !exito){</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    std::cerr &lt;&lt; <span class="stringliteral">&quot;Algun pedo en exponentiate&quot;</span> &lt;&lt; revition &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; exito &lt;&lt; std::endl; </div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    std::cerr &lt;&lt; <span class="stringliteral">&quot;La rutina de lapack tiene pedos cuando esta muy sparse la matriz,\n&quot;</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;      &lt;&lt;<span class="stringliteral">&quot;por ejemplo un elemento del modelo de free fermions con 2D en primeros vecinos&quot;</span> &lt;&lt; std::endl; </div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    abort();</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  }</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  tmp = V*itpp::diag(itpp::exp(eigenvalues))* V.hermitian_transpose();</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="comment">// Others</span></div><div class="line"><a name="l00600"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#acc807c2273283a3fe0b404851943f874">  600</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceitppextmath.html#acc807c2273283a3fe0b404851943f874">applyUDiagUdagger</a>(<span class="keyword">const</span> itpp::cmat&amp; U, <span class="keyword">const</span> itpp::cvec&amp; E,  itpp::cvec&amp; psi){ <span class="comment">// {{{</span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  <span class="comment">// Calculates U.diag(E).U^\dagger.psi with diag(E) a diagonal matrix</span></div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  psi = U.hermitian_transpose()*psi;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  psi = elem_mult(E, psi);</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  psi = U*psi;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;  return ;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l00607"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a675965a2ef652e3bca87e74a0946b343">  607</a></span>&#160;itpp::cmat <a class="code" href="namespaceitppextmath.html#a675965a2ef652e3bca87e74a0946b343">UDiagUdagger</a>(<span class="keyword">const</span> itpp::cmat&amp; U, <span class="keyword">const</span> itpp::cvec&amp; E){ <span class="comment">// {{{</span></div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;  <span class="comment">// Calculates U.diag(E).U^\dagger with diag(E) a diagonal matrix</span></div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="comment">// template &lt;class Num_T&gt; itpp::Mat&lt;Num_T&gt; exponentiate(itpp::Mat&lt;Num_T&gt; Matrix){</span></div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;  <span class="comment">//Calculates exp(H)</span></div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  <span class="keywordtype">int</span> n=E.length();</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  itpp::cmat Result(n,n);</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;  std::complex&lt;double&gt; A;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;n; i++){</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;n; j++){</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;      A=0.;</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="jquery_8js.html#ab26645c014aa005ecedef329ecf58c99">k</a>=0; <a class="code" href="jquery_8js.html#ab26645c014aa005ecedef329ecf58c99">k</a>&lt;n; <a class="code" href="jquery_8js.html#ab26645c014aa005ecedef329ecf58c99">k</a>++){</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        A+=U(i,<a class="code" href="jquery_8js.html#ab26645c014aa005ecedef329ecf58c99">k</a>)*E(<a class="code" href="jquery_8js.html#ab26645c014aa005ecedef329ecf58c99">k</a>)*std::conj(U(j,<a class="code" href="jquery_8js.html#ab26645c014aa005ecedef329ecf58c99">k</a>));</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;      }</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;      Result(i,j)=A;</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    }</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;  }</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;  <span class="keywordflow">return</span> Result;</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l00626"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a31e62577363ab9f7ee7759fb3df68149">  626</a></span>&#160;itpp::cmat <a class="code" href="namespaceitppextmath.html#a675965a2ef652e3bca87e74a0946b343">UDiagUdagger</a>(<span class="keyword">const</span> itpp::cmat&amp; U, <span class="keyword">const</span> itpp::vec&amp; E){ <span class="comment">// {{{</span></div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="keywordflow">return</span> <a class="code" href="namespaceitppextmath.html#a675965a2ef652e3bca87e74a0946b343">UDiagUdagger</a>(U, to_cvec(E));</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l00629"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a8d15e678f0eb7602b2a1d3cf0bb0da79">  629</a></span>&#160;itpp::cmat <a class="code" href="namespaceitppextmath.html#a8d15e678f0eb7602b2a1d3cf0bb0da79">InteractionPicture</a>(<span class="keyword">const</span> itpp::cmat&amp; H0, <span class="keyword">const</span> itpp::cmat&amp; As, <span class="keywordtype">double</span> t){ <span class="comment">// {{{</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;Warning, using a slow routine asdfasd&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;  <span class="comment">// Returns exp[i t H0] As exp[-i t H0]</span></div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  <span class="comment">// acording to wikipedia, this is the standard sign</span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;  <span class="comment">// http://en.wikipedia.org/wiki/Interaction_picture</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;  itpp::cmat U;</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;  std::complex&lt;double&gt; I(0.,1.);</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  U = <a class="code" href="namespaceitppextmath.html#af0b1e30122a83066769ccf797e2a8a57">exponentiate</a>(-I*t*H0);</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="comment">//   std::cout &lt;&lt; &quot;She was all dressed up in black&quot; &lt;&lt; std::endl;</span></div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;  itpp::cmat tmp;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;  <span class="keywordflow">return</span> itpp::hermitian_transpose(U)*As*U;</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="comment">//   return itpp::hermitian_transpose(U)*As*U;</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l00642"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#ab92a72254996fac534e34882c40fe3d9">  642</a></span>&#160;itpp::cmat <a class="code" href="namespaceitppextmath.html#a8d15e678f0eb7602b2a1d3cf0bb0da79">InteractionPicture</a>(<span class="keyword">const</span> itpp::cmat&amp; V0, <span class="keyword">const</span> itpp::cmat&amp; As){ <span class="comment">// {{{</span></div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;Warning, using a slow routinen 42384938274&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;  <span class="comment">// Returns V0^\dagger As V0</span></div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;  <span class="comment">// acording to wikipedia, this is the standard sign</span></div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;  <span class="comment">// http://en.wikipedia.org/wiki/Interaction_picture</span></div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;  <span class="keywordflow">return</span> itpp::hermitian_transpose(V0)*As*V0;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="comment">//   return itpp::hermitian_transpose(U)*As*U;</span></div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l00650"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a1cc0f2ca72e8dd850a466114e350ce18">  650</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; itpp::Mat&lt;Num_T&gt; <a class="code" href="namespaceitppextmath.html#a1cc0f2ca72e8dd850a466114e350ce18">Proyector</a>(<span class="keyword">const</span> itpp::Vec&lt;Num_T&gt;&amp; psi){ <span class="comment">// {{{</span></div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  <span class="keywordtype">int</span> n=psi.size();</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  itpp::Mat&lt;Num_T&gt; <a class="code" href="jquery_8js.html#a2335e57f79b6acfb6de59c235dc8a83e">p</a>(n,n);</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;n; i++){</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;n; j++){</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;      <a class="code" href="jquery_8js.html#a2335e57f79b6acfb6de59c235dc8a83e">p</a>(i,j) = psi(i)*conj(psi(j));</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    }</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;  }</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="jquery_8js.html#a2335e57f79b6acfb6de59c235dc8a83e">p</a>;</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l00660"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#adecbf33ed00c63a7a4bce35b76c741ee">  660</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; itpp::Mat&lt;Num_T&gt; <a class="code" href="namespaceitppextmath.html#adecbf33ed00c63a7a4bce35b76c741ee">DirectSum</a>(<span class="keyword">const</span> itpp::Array&lt;itpp::Mat&lt;Num_T&gt; &gt;&amp; Matrices){ <span class="comment">// {{{</span></div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  </div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;  itpp::Mat&lt;Num_T&gt; tmp=Matrices(0);</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=1; i&lt;Matrices.size(); i++){</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    tmp=<a class="code" href="namespaceitppextmath.html#adecbf33ed00c63a7a4bce35b76c741ee">DirectSum</a>(tmp, Matrices(i));</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  }</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l00668"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a76747895b47963f065a2ea3836713a8d">  668</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; itpp::Mat&lt;Num_T&gt; <a class="code" href="namespaceitppextmath.html#adecbf33ed00c63a7a4bce35b76c741ee">DirectSum</a>(<span class="keyword">const</span> itpp::Mat&lt;Num_T&gt;&amp; Matrix1, <span class="keyword">const</span> itpp::Mat&lt;Num_T&gt;&amp; Matrix2){ <span class="comment">// {{{</span></div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  itpp::Mat&lt;Num_T&gt; tmp(Matrix1.rows()+ Matrix2.rows(), Matrix1.cols()+ Matrix2.cols());</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;  tmp.zeros();</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;  tmp.set_submatrix(0,0, Matrix1);</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;  tmp.set_submatrix(Matrix1.rows(), Matrix1.cols(), Matrix2);</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l00675"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#ad1c9dbe11deb8cc15723cbf40e1aab42">  675</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; itpp::Vec&lt;Num_T&gt; <a class="code" href="namespaceitppextmath.html#ad1c9dbe11deb8cc15723cbf40e1aab42">get_column</a>(<span class="keyword">const</span> itpp::Array&lt;itpp::Vec&lt;Num_T&gt; &gt;&amp; A, <span class="keyword">const</span> <span class="keywordtype">int</span> element){ <span class="comment">// {{{</span></div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;  itpp::Vec&lt;Num_T &gt; tmp(A.size());</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i&lt; A.size(); i++){ tmp(i) = A(i)(element); }</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;} <span class="comment">//}}}</span></div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="comment">// Multiplication</span></div><div class="line"><a name="l00681"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#ac0b2e1a0c9dfa5af9118227349c7679b">  681</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; itpp::Mat&lt;Num_T&gt; <a class="code" href="namespaceitppextmath.html#ac0b2e1a0c9dfa5af9118227349c7679b">AtimesDiagB</a>(<span class="keyword">const</span> itpp::Mat&lt;Num_T&gt;&amp; A, <span class="keyword">const</span> itpp::Vec&lt;Num_T&gt;&amp; B){ <span class="comment">// {{{</span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  itpp::Mat&lt;Num_T&gt; tmp(A.cols(),A.rows());</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;tmp.cols(); i++){</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    tmp.set_col(i,B(i)*A.get_col(i));</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;  }</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="comment">// template &lt;class Num_T&gt; itpp::Vec&lt;Num_T&gt; DiagonalTimesVector(const itpp::Vec&lt;Num_T&gt;&amp; DiagMatrix, const itpp::Vec&lt;Num_T&gt;&amp; Psi){ // {{{</span></div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="comment">// //   itpp::Mat&lt;Num_T&gt; tmp(A.cols(),A.rows());</span></div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="comment">//   return;Psi = DiagMatrix* Psi;</span></div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="comment">//   return;</span></div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="comment">// } // }}}</span></div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="comment">// }}}</span></div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="comment">// Reporting {{{</span></div><div class="line"><a name="l00695"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a3455ade154f0c4bfb3d61b3a618ced9a">  695</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceitppextmath.html#a3455ade154f0c4bfb3d61b3a618ced9a">PrintCompactHermitian</a>(itpp::Mat&lt;std::complex&lt;double&gt; &gt;&amp; rho){</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <span class="keywordtype">int</span> dim=rho.cols();</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    std::cout &lt;&lt;<span class="stringliteral">&quot; &quot;</span>;</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i =0; i&lt; dim;i++){</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;        std::cout &lt;&lt;real(rho(i,i))&lt;&lt;<span class="stringliteral">&quot; &quot;</span>;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="comment">//      std::cout &lt;&lt; &quot;x&quot;&lt;&lt;rho(i,i)&lt;&lt;&quot; &quot;;</span></div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j =i+1; j&lt; dim;j++){</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;            std::cout &lt;&lt;real(rho(i,j))&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;imag(rho(i,j)) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        }</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    }</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;}</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="comment">// }}}</span></div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="comment">// Bit manipulation {{{</span></div><div class="line"><a name="l00708"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#ad56f8c2cf7d200e6a76b7dec6fd5d5af">  708</a></span>&#160;itpp::ivec <a class="code" href="namespaceitppextmath.html#ad56f8c2cf7d200e6a76b7dec6fd5d5af">IntegerDigits</a>(<span class="keywordtype">int</span> n,<span class="keywordtype">int</span> base=2, <span class="keywordtype">int</span> length=0){<span class="comment">// {{{</span></div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;  <span class="keywordtype">int</span> number=n;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  <span class="keywordtype">int</span> size=length;</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;  <span class="keywordflow">if</span> (length==0){</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    size = <a class="code" href="namespacecfpmath.html#a7fb0bc89f043d158b9c542650e2ac1ac">cfpmath::integer_part_log</a>(base,n);</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;  }</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;  itpp::ivec result(size);</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;  result=0;</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;  <span class="keywordtype">int</span> counter=0;</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;  <span class="keywordflow">while</span> (n!=0 &amp;&amp; counter&lt;size){</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    result(counter) = number%base;</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    number=(number - result(counter))/base;</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    counter ++;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;  }</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;  <span class="keywordflow">return</span> result;</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;}<span class="comment">// }}} Matrix=</span></div><div class="line"><a name="l00725"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a3d3e9977b9bdeb3ea61da531c0515d15">  725</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespaceitppextmath.html#a3d3e9977b9bdeb3ea61da531c0515d15">bvec_to_int</a>(itpp::bvec bool_array){<span class="comment">// {{{</span></div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;  <span class="keywordtype">int</span> tmp=0;</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;bool_array.size(); i++){</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    <span class="keywordflow">if</span> (bool_array(i)){</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;      tmp= tmp | (1&lt;&lt;i);</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    }</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;  }</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;}<span class="comment">// }}}</span></div><div class="line"><a name="l00734"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a9635792731019c1bae82eb75d85aec0c">  734</a></span>&#160;itpp::Vec&lt;bool&gt; <a class="code" href="namespaceitppextmath.html#a9635792731019c1bae82eb75d85aec0c">int_to_bool</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> n, <span class="keyword">const</span> <span class="keywordtype">int</span> total_number_bits){<span class="comment">// {{{</span></div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;  itpp::Vec&lt;bool&gt; tmp(total_number_bits);</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;total_number_bits; i++){ tmp(i)=<a class="code" href="namespacecfpmath.html#ad47bd5592779c8df68c618acfbed5ecc">cfpmath::test_bit</a>(n,i); }</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;}<span class="comment">// }}}</span></div><div class="line"><a name="l00739"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a752ccdb02d0a0220e2b2e9be72bdff78">  739</a></span>&#160;itpp::ivec <a class="code" href="namespaceitppextmath.html#a752ccdb02d0a0220e2b2e9be72bdff78">all_n_bit_numbers</a>(<span class="keywordtype">int</span> bits_on, <span class="keywordtype">int</span> total_number_bits){<span class="comment">// {{{</span></div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;  itpp::ivec tmp(0);</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="namespacecfpmath.html#abf5bd8dc5d8af42a850231816e60e95f">cfpmath::pow_2</a>(total_number_bits); i++){</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<span class="comment">//     std::cout &lt;&lt; i &lt;&lt;&quot; &quot;&lt;&lt;  cfpmath::BitCount(i)  &lt;&lt; &quot;\n&quot;;</span></div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacecfpmath.html#a6500e09a78acb96aa9644c42d791f7ac">cfpmath::BitCount</a>(i)==bits_on){</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;      tmp = itpp::concat(tmp,i);</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="comment">//       std::cout &lt;&lt; i &lt;&lt;&quot; &quot;&lt;&lt;  cfpmath::BitCount(i)  &lt;&lt; &quot; siiii\n&quot;;</span></div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    }</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;  }</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;}<span class="comment">// }}}</span></div><div class="line"><a name="l00750"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a26e979969612aaea7a704f4d90e4c4a6">  750</a></span>&#160;itpp::ivec <a class="code" href="namespaceitppextmath.html#a26e979969612aaea7a704f4d90e4c4a6">all_bit_rotations</a>(<span class="keywordtype">int</span> n, <span class="keywordtype">int</span> size_register){ <span class="comment">//{{{</span></div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;  itpp::ivec tmp(size_register);</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;  tmp(0)=n;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;  <span class="keywordtype">int</span> candidate;</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;  <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i =0 ; i&lt;size_register-1 ; i++){</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    candidate=<a class="code" href="namespacecfpmath.html#a6e40c403a01e32df807b66c8dd8c8e3f">cfpmath::rotate_bits</a>(tmp(i), size_register);</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    <span class="keywordflow">if</span>(candidate == n){</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;      tmp.set_size(i+1, <span class="keyword">true</span>);</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    }</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;<span class="comment">//     std::cout &lt;&lt; &quot;i=&quot;&lt;&lt; i &lt;&lt; std::endl;</span></div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    tmp(i+1)=candidate;</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;  }</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;<span class="comment">//   return ;</span></div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;<span class="comment">// }}}</span></div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="comment">// set manipulation {{{</span></div><div class="line"><a name="l00768"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a1db134bcc673ab99ee2bc0edc73cebbb">  768</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; itpp::Mat&lt;Num_T &gt; <a class="code" href="namespaceitppextmath.html#a1db134bcc673ab99ee2bc0edc73cebbb">ArrayToMatrix</a>(<span class="keyword">const</span> itpp::Array&lt;itpp::Vec&lt;Num_T&gt; &gt;&amp; A){<span class="comment">// {{{</span></div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;<span class="comment">//   itpp::Mat&lt;Num_T &gt; tmp;</span></div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;  itpp::Mat&lt;Num_T &gt; tmp(A.size(),A(0).size());</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;A.size(); i++){</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    tmp.set_row(i,A(i));</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;  }</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;  <span class="keywordflow">return</span> tmp; </div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;  </div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;}<span class="comment">// }}}</span></div><div class="line"><a name="l00777"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a3968eec2bb8d3671580eeccdb7075c59">  777</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; itpp::Mat&lt;Num_T &gt; <a class="code" href="namespaceitppextmath.html#a3968eec2bb8d3671580eeccdb7075c59">OuterSum</a>(<span class="keyword">const</span> itpp::Vec&lt;Num_T &gt;&amp; A, <span class="keyword">const</span> itpp::Vec&lt;Num_T &gt;&amp; B){<span class="comment">// {{{</span></div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;  itpp::Mat&lt;Num_T &gt; tmp(A.size(), B.size());</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iA=0; iA&lt;A.size(); iA++){</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iB=0; iB&lt;A.size(); iB++){</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;      tmp(iA, iB)=A(iA)+B(iB);</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    }</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;  }</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;  <span class="keywordflow">return</span> tmp; </div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;}<span class="comment">// }}}</span></div><div class="line"><a name="l00786"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a3a498f8d2a2d26403d30503bab3c7c28">  786</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; itpp::Array&lt;Num_T &gt; <a class="code" href="namespaceitppextmath.html#a3a498f8d2a2d26403d30503bab3c7c28">Outer</a>(<span class="keyword">const</span> itpp::Array&lt;Num_T &gt;&amp; A, <span class="keyword">const</span> itpp::Array&lt;Num_T &gt;&amp; B){<span class="comment">// {{{</span></div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;  itpp::Array&lt;Num_T &gt; tmp(0);</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;A.size(); i++){</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    tmp=itpp::concat(tmp, <a class="code" href="namespaceitppextmath.html#a66e07ac3e1e89b87e651dc4872d0edf3">Elementwiseconcat</a>(A(i),B));</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;  }</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;  <span class="keywordflow">return</span> tmp; </div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;  </div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;}<span class="comment">// }}}</span></div><div class="line"><a name="l00794"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a59c598f2d335ceca9a4479209da33016">  794</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; <span class="keywordtype">bool</span> <a class="code" href="namespaceitppextmath.html#a59c598f2d335ceca9a4479209da33016">unique_elements</a>(<span class="keyword">const</span> Num_T &amp; A){<span class="comment">// {{{</span></div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;  <span class="keywordflow">return</span> A.size() == <a class="code" href="namespaceitppextmath.html#a321e6541aead62bb6178f7474b9c5d37">Union</a>(A).size();</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;}<span class="comment">// }}}</span></div><div class="line"><a name="l00797"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a321e6541aead62bb6178f7474b9c5d37">  797</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; Num_T <a class="code" href="namespaceitppextmath.html#a321e6541aead62bb6178f7474b9c5d37">Union</a>(<span class="keyword">const</span> Num_T &amp; A){<span class="comment">// {{{</span></div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;  <span class="keywordflow">if</span> (A.size() == 0){</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    <span class="keywordflow">return</span> A;</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;  }</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;  Num_T tmp(1);</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;  tmp(0) = A(0);</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i&lt; A.size(); i++){</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespaceitppextmath.html#ac8dcabc8b02af619d6cde04eacbcf29c">Contains</a>(tmp, A(i))){ tmp = itpp::concat(tmp, A(i)); }</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;  }</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;}<span class="comment">// }}}</span></div><div class="line"><a name="l00808"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a7e954673bbd865324159b80bb3bc0179">  808</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; itpp::Array&lt;Num_T &gt; <a class="code" href="namespaceitppextmath.html#a321e6541aead62bb6178f7474b9c5d37">Union</a>(<span class="keyword">const</span> itpp::Array&lt;Num_T &gt;&amp; A, <span class="keyword">const</span> itpp::Array&lt;Num_T &gt;&amp; B){<span class="comment">// {{{</span></div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;  <span class="keywordflow">if</span> (A.size() == 0){</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespaceitppextmath.html#a321e6541aead62bb6178f7474b9c5d37">Union</a>(B);</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;  }</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  itpp::Array&lt;Num_T &gt; tmp;</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;  tmp.set_size(1); </div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;  tmp(0) = A(0);</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i&lt; A.size(); i++){</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespaceitppextmath.html#ac8dcabc8b02af619d6cde04eacbcf29c">Contains</a>(tmp, A(i))){ tmp = itpp::concat(tmp, A(i)); }</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;  }</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i&lt; B.size(); i++){</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespaceitppextmath.html#ac8dcabc8b02af619d6cde04eacbcf29c">Contains</a>(tmp, B(i))){ tmp = itpp::concat(tmp, B(i)); }</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;  }</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;}<span class="comment">// }}}</span></div><div class="line"><a name="l00823"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a5a3a9bbb71fed40c63b43fb948ec1336">  823</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; itpp::Array&lt;Num_T &gt; <a class="code" href="namespaceitppextmath.html#a5a3a9bbb71fed40c63b43fb948ec1336">del</a>(<span class="keyword">const</span> itpp::Array&lt;Num_T &gt;&amp; A, <span class="keyword">const</span> <span class="keywordtype">int</span> i){<span class="comment">// {{{</span></div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;  <span class="keywordtype">int</span> sA = A.size();</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;  <span class="keywordflow">if</span> (i==0){</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    <span class="keywordflow">if</span> (sA==1){</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;      itpp::Array&lt;Num_T &gt; tmp(0);</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;      <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;      <span class="keywordflow">return</span> A(1,sA-1);</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    }</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i==sA -1) {</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    <span class="keywordflow">return</span> A(0,i-1);</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    <span class="keywordflow">return</span> itpp::concat(A(0,i-1),A(i+1,sA-1));</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;  }</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;}<span class="comment">// }}}</span></div><div class="line"><a name="l00838"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#ac74a7376d1a12d1c4967b64b5fb9099e">  838</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; itpp::Array&lt;Num_T &gt; <a class="code" href="namespaceitppextmath.html#ac74a7376d1a12d1c4967b64b5fb9099e">minus</a>(<span class="keyword">const</span> itpp::Array&lt;Num_T &gt;&amp; A, <span class="keyword">const</span> Num_T &amp; B){<span class="comment">// {{{</span></div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;  itpp::Array&lt;Num_T &gt; A_Union=<a class="code" href="namespaceitppextmath.html#a321e6541aead62bb6178f7474b9c5d37">Union</a>(A);</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespaceitppextmath.html#ac8dcabc8b02af619d6cde04eacbcf29c">Contains</a>(A_Union,B)){ </div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    <span class="keywordflow">return</span> A_Union;</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    <span class="keywordtype">int</span> pi=<a class="code" href="namespaceitppextmath.html#a973576807093c6ff42014306311f888b">Position_FirstIntersection</a>(A_Union,B);</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespaceitppextmath.html#a5a3a9bbb71fed40c63b43fb948ec1336">del</a>(A_Union,pi);</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;  }</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;}<span class="comment">// }}}</span></div><div class="line"><a name="l00847"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#afceb26121758c39dbf759f8b465b15ff">  847</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; itpp::Array&lt;Num_T &gt; <a class="code" href="namespaceitppextmath.html#ac74a7376d1a12d1c4967b64b5fb9099e">minus</a>(<span class="keyword">const</span> itpp::Array&lt;Num_T &gt;&amp; A, <span class="keyword">const</span> itpp::Array&lt;Num_T &gt;&amp; B){<span class="comment">// {{{</span></div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;  itpp::Array&lt;Num_T &gt; A_union=<a class="code" href="namespaceitppextmath.html#a321e6541aead62bb6178f7474b9c5d37">Union</a>(A), tmp;</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i&lt; A_union.size(); i++){</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespaceitppextmath.html#ac8dcabc8b02af619d6cde04eacbcf29c">Contains</a>(B, A_union(i))){ tmp = itpp::concat(tmp, A_union(i)); }</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;  }</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;  <span class="keywordflow">return</span> tmp ;</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;}<span class="comment">// }}}</span></div><div class="line"><a name="l00854"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a39b5a8e62e81f612edf3092c1743caae">  854</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespaceitppextmath.html#a39b5a8e62e81f612edf3092c1743caae">EmptyIntersection</a>(<span class="keyword">const</span> itpp::Array&lt; itpp::ivec &gt;&amp; Array1, <span class="keyword">const</span> itpp::Array&lt; itpp::ivec &gt;&amp; Array2){<span class="comment">// {{{</span></div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;Array1.size(); i++){</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="namespaceitppextmath.html#ac8dcabc8b02af619d6cde04eacbcf29c">itppextmath::Contains</a>(Array2, Array1(i) )){</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    }</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;  } </div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;}<span class="comment">// }}}</span></div><div class="line"><a name="l00865"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a66f3fd22ef38f31e434d397ef89089a5">  865</a></span>&#160;itpp::Array&lt; itpp::ivec &gt; <a class="code" href="namespaceitppextmath.html#a66f3fd22ef38f31e434d397ef89089a5">Intersection</a>(<span class="keyword">const</span> itpp::Array&lt; itpp::ivec &gt;&amp; Array1, <span class="keyword">const</span> itpp::Array&lt; itpp::ivec &gt;&amp; Array2){<span class="comment">// {{{</span></div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;  itpp::Array&lt;itpp::ivec&gt; tmp; </div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;Array1.size(); i++){</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="namespaceitppextmath.html#ac8dcabc8b02af619d6cde04eacbcf29c">itppextmath::Contains</a>(Array2, Array1(i) )){</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;      tmp=itpp::concat(tmp,Array1(i));</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    }</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;  } </div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespaceitppextmath.html#a321e6541aead62bb6178f7474b9c5d37">Union</a>(tmp);</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;}<span class="comment">// }}}</span></div><div class="line"><a name="l00877"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#acebd855389ea589bcf60255c88f699b2">  877</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; itpp::Array&lt;Num_T &gt; <a class="code" href="namespaceitppextmath.html#acebd855389ea589bcf60255c88f699b2">RemoveItem</a>(<span class="keyword">const</span> itpp::Array&lt;Num_T &gt;&amp; v, <span class="keyword">const</span> <span class="keywordtype">int</span> index){<span class="comment">// {{{</span></div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;  <span class="keywordflow">if</span> (index &lt; 0 || index &gt; v.size()-1){</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    std::cerr &lt;&lt; <span class="stringliteral">&quot;Something wrong in RemoveItem\n&quot;</span>;</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    abort();</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;  }</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;  <span class="keywordflow">if</span> (v.size()==1){<span class="keywordflow">return</span> itpp::Array&lt;Num_T &gt;(0);}</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;  <span class="keywordflow">if</span> (index == 0){ <span class="keywordflow">return</span> v( 1, v.size()-1);}</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;  <span class="keywordflow">if</span> (index == v.size()-1){ <span class="keywordflow">return</span> v(0, v.size()-2);}</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;  <span class="keywordflow">return</span> itpp::concat(v(0, index -1), v(index + 1, v.size()-1));</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;}<span class="comment">// }}}</span></div><div class="line"><a name="l00887"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a2264e467acc7ee2644eb0289eb8c709e">  887</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; itpp::Array&lt;Num_T &gt; <a class="code" href="namespaceitppextmath.html#acebd855389ea589bcf60255c88f699b2">RemoveItem</a>(<span class="keyword">const</span> itpp::Array&lt;Num_T &gt;&amp; v, <span class="keyword">const</span> itpp::ivec&amp; indices){<span class="comment">// {{{</span></div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;  itpp::Array&lt;Num_T &gt; tmp = v;</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;  itpp::ivec indices_sorted = indices;</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;  <a class="code" href="namespaceitppextmath.html#a1497e509510ac3450b76342b601ea8f7">itpp::sort</a>(indices_sorted);</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i =indices.size()-1; i&gt;=0; i--){ tmp=<a class="code" href="namespaceitppextmath.html#acebd855389ea589bcf60255c88f699b2">RemoveItem</a>(tmp,indices(i)); }</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;}<span class="comment">// }}}</span></div><div class="line"><a name="l00894"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#aa9464d9a16932158d63be6a894c94c63">  894</a></span>&#160;itpp::Mat&lt;int&gt;  <a class="code" href="namespaceitppextmath.html#aa9464d9a16932158d63be6a894c94c63">BulkPositionUnion2PositionSets</a>(<span class="keyword">const</span> itpp::Mat&lt;int&gt;&amp; A, <span class="keyword">const</span> itpp::Mat&lt;int&gt;&amp; B){<span class="comment">// {{{</span></div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;  <span class="keywordflow">return</span> itpp::concat_vertical(A,B);</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;}<span class="comment">// }}}</span></div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;<span class="comment">// }}}</span></div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;<span class="comment">// Functional Element manipulation, on all elements {{{</span></div><div class="line"><a name="l00899"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a39da0a7fb06611a087d72ecd759423c5">  899</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; Num_T  <a class="code" href="namespaceitppextmath.html#a39da0a7fb06611a087d72ecd759423c5">Chop</a>(<span class="keyword">const</span> Num_T&amp; A, <span class="keywordtype">double</span> epsilon=1e-12){</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;  <span class="keywordflow">if</span> (abs(A)&lt;epsilon){</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    <span class="keywordflow">return</span> A;</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;  }</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;}</div><div class="line"><a name="l00906"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a00645b58e536763060582c6411c5b6b7">  906</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; itpp::Vec&lt;Num_T &gt; <a class="code" href="namespaceitppextmath.html#a39da0a7fb06611a087d72ecd759423c5">Chop</a>(<span class="keyword">const</span> itpp::Vec&lt;Num_T&gt;&amp; A, <span class="keywordtype">double</span> epsilon=1e-12){</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;  itpp::Vec&lt;Num_T &gt; tmp(A.size());</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;A.size(); i++){</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    tmp(i)=<a class="code" href="namespaceitppextmath.html#a39da0a7fb06611a087d72ecd759423c5">Chop</a>(A(i));</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;  }</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;}</div><div class="line"><a name="l00913"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a7ebafac54b56ab288d0aec64601c50e6">  913</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; itpp::Mat&lt;Num_T &gt; <a class="code" href="namespaceitppextmath.html#a39da0a7fb06611a087d72ecd759423c5">Chop</a>(<span class="keyword">const</span> itpp::Mat&lt;Num_T&gt;&amp; A, <span class="keywordtype">double</span> epsilon=1e-12){</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;  itpp::Mat&lt;Num_T &gt; tmp(A.rows(),A.cols());</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r=0; r&lt;A.rows(); r++){</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="jquery_8js.html#abce695e0af988ece0826d9ad59b8160d">c</a>=0; <a class="code" href="jquery_8js.html#abce695e0af988ece0826d9ad59b8160d">c</a>&lt;A.cols(); <a class="code" href="jquery_8js.html#abce695e0af988ece0826d9ad59b8160d">c</a>++){</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;      tmp(r,<a class="code" href="jquery_8js.html#abce695e0af988ece0826d9ad59b8160d">c</a>)=<a class="code" href="namespaceitppextmath.html#a39da0a7fb06611a087d72ecd759423c5">Chop</a>(A(r,<a class="code" href="jquery_8js.html#abce695e0af988ece0826d9ad59b8160d">c</a>),epsilon);</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    }</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;  }</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;}</div><div class="line"><a name="l00922"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a4988c4bb105945c54a1906c7f0726017">  922</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T, <span class="keyword">class</span> Cosa&gt; itpp::Array&lt;Num_T &gt; <a class="code" href="namespaceitppextmath.html#a4988c4bb105945c54a1906c7f0726017">ElementwiseAddInFirstElement</a>(<span class="keyword">const</span> Cosa joda, <span class="keyword">const</span> itpp::Array&lt;Num_T&gt;&amp; A){</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;  itpp::Array&lt;Num_T&gt; tmp(A.size());</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;A.size(); i++){</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    tmp(i)=itpp::concat(joda, A(i));</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;  }</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;}</div><div class="line"><a name="l00929"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#af040733b94e262246c8401442ad83240">  929</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; itpp::Array&lt;Num_T &gt; <a class="code" href="namespaceitppextmath.html#af040733b94e262246c8401442ad83240">ElementwiseRemoveFirstElement</a>(<span class="keyword">const</span> itpp::Array&lt;Num_T&gt;&amp; A){</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;  itpp::Array&lt;Num_T &gt; tmp(A.size());</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;A.size(); i++){</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    tmp(i)=A(i)(1,A(i).size()-1);</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;  }</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;}</div><div class="line"><a name="l00936"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a66e07ac3e1e89b87e651dc4872d0edf3">  936</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; itpp::Array&lt;Num_T &gt; <a class="code" href="namespaceitppextmath.html#a66e07ac3e1e89b87e651dc4872d0edf3">Elementwiseconcat</a>(<span class="keyword">const</span> Num_T&amp; A, <span class="keyword">const</span> itpp::Array&lt;Num_T &gt;&amp; B){</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;  itpp::Array&lt;Num_T &gt; tmp(B.size());</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;B.size(); i++){</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    tmp(i)=itpp::concat(A,B(i));</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;  }</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;}</div><div class="line"><a name="l00943"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#ae41f1804449573b7ae08ec0b322950a4">  943</a></span>&#160;itpp::ivec <a class="code" href="namespaceitppextmath.html#ae41f1804449573b7ae08ec0b322950a4">Modulize</a>(<span class="keyword">const</span> itpp::ivec&amp; intvec,<span class="keyword">const</span> itpp::ivec n){</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;  itpp::Vec&lt;int&gt; tmp(intvec.size());</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i =0;i&lt;intvec.size();i++){</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    tmp(i)=intvec(i)%n(i);</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    <span class="keywordflow">if</span> (tmp(i)&lt;0){</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;      tmp(i)=tmp(i)+n(i);</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    }</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;  }</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;}</div><div class="line"><a name="l00953"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a647a91675daa415f0b7460ba3b511be5">  953</a></span>&#160;itpp::ivec <a class="code" href="namespaceitppextmath.html#ae41f1804449573b7ae08ec0b322950a4">Modulize</a>(<span class="keyword">const</span> itpp::ivec&amp; intvec,<span class="keyword">const</span> <span class="keywordtype">int</span> n){</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;  itpp::Vec&lt;int&gt; tmp(intvec.size());</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i =0;i&lt;intvec.size();i++){</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    tmp(i)=intvec(i)%n;</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    <span class="keywordflow">if</span> (tmp(i)&lt;0){</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;      tmp(i)=tmp(i)+n;</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    }</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;  }</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;}</div><div class="line"><a name="l00963"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a789ca34e4addc590fecb864bac5594de">  963</a></span>&#160;itpp::Array&lt;itpp::ivec&gt; <a class="code" href="namespaceitppextmath.html#ae41f1804449573b7ae08ec0b322950a4">Modulize</a>(<span class="keyword">const</span> itpp::Array&lt;itpp::ivec&gt;&amp; intvec,<span class="keyword">const</span> itpp::ivec n){</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;  itpp::Array&lt;itpp::ivec&gt; tmp(intvec.size());</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i =0;i&lt;intvec.size();i++){</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    tmp(i)=<a class="code" href="namespaceitppextmath.html#ae41f1804449573b7ae08ec0b322950a4">Modulize</a>(intvec(i), n);</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;  }</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;}</div><div class="line"><a name="l00970"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#aac9c1b3baf71d8f4b0e5d279d6de0873">  970</a></span>&#160;itpp::Array&lt;itpp::ivec&gt; <a class="code" href="namespaceitppextmath.html#ae41f1804449573b7ae08ec0b322950a4">Modulize</a>(<span class="keyword">const</span> itpp::Array&lt;itpp::ivec&gt;&amp; intvec,<span class="keyword">const</span> <span class="keywordtype">int</span> n){</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;  itpp::Array&lt;itpp::ivec&gt; tmp(intvec.size());</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i =0;i&lt;intvec.size();i++){</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    tmp(i)=<a class="code" href="namespaceitppextmath.html#ae41f1804449573b7ae08ec0b322950a4">Modulize</a>(intvec(i), n);</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;  }</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;}</div><div class="line"><a name="l00977"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a49614e098e9398abc0552db974c94f70">  977</a></span>&#160;itpp::Mat&lt;int&gt; <a class="code" href="namespaceitppextmath.html#ae41f1804449573b7ae08ec0b322950a4">Modulize</a>(<span class="keyword">const</span> itpp::Mat&lt;int&gt;&amp; set_of_vectors,<span class="keyword">const</span> <span class="keywordtype">int</span> n){</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;  itpp::Mat&lt;int&gt; tmp(set_of_vectors.rows() ,set_of_vectors.cols() );</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; set_of_vectors.rows(); i++){</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    tmp.set_row(i,<a class="code" href="namespaceitppextmath.html#ae41f1804449573b7ae08ec0b322950a4">Modulize</a>(set_of_vectors.get_row(i),n) );</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;  }</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;}</div><div class="line"><a name="l00984"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#acbc392d9bfaea8f5490df9ceda31060d">  984</a></span>&#160;itpp::Array&lt;itpp::ivec&gt; <a class="code" href="namespaceitppextmath.html#acbc392d9bfaea8f5490df9ceda31060d">DeScale</a>(<span class="keyword">const</span> itpp::Array&lt;itpp::ivec&gt;&amp; set_of_vectors,<span class="keyword">const</span> <span class="keywordtype">int</span> scale_factor){</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;  itpp::Array&lt;itpp::ivec&gt; tmp(set_of_vectors.size());</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; set_of_vectors.size(); i++){</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    tmp(i)=set_of_vectors(i)/scale_factor;</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;  }</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;}</div><div class="line"><a name="l00991"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#abf0356d0d20e239a6e944507ed3324de">  991</a></span>&#160;itpp::Array&lt;itpp::ivec&gt; <a class="code" href="namespaceitppextmath.html#abf0356d0d20e239a6e944507ed3324de">Scale</a>(<span class="keyword">const</span> itpp::Array&lt;itpp::ivec&gt;&amp; set_of_vectors,<span class="keyword">const</span> <span class="keywordtype">int</span> scale_factor){</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;  itpp::Array&lt;itpp::ivec&gt; tmp(set_of_vectors.size());</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; set_of_vectors.size(); i++){</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    tmp(i)=scale_factor*set_of_vectors(i);</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;  }</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;}</div><div class="line"><a name="l00998"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#aedd48b707f175c2f42ccb42465412f3b">  998</a></span>&#160;itpp::Array&lt;itpp::ivec&gt; <a class="code" href="namespaceitppextmath.html#aedd48b707f175c2f42ccb42465412f3b">Displace</a>(<span class="keyword">const</span> itpp::Array&lt;itpp::ivec&gt;&amp; set_of_vectors,<span class="keyword">const</span> itpp::ivec displacement_vector){</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;  itpp::Array&lt;itpp::ivec&gt; tmp(set_of_vectors.size());</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; set_of_vectors.size(); i++){</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    tmp(i)=set_of_vectors(i)+displacement_vector;</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;  }</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;}</div><div class="line"><a name="l01005"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#ab46fdeb36ce5e7a7e4c226ca012d5822"> 1005</a></span>&#160;itpp::Mat&lt;int&gt; <a class="code" href="namespaceitppextmath.html#aedd48b707f175c2f42ccb42465412f3b">Displace</a>(<span class="keyword">const</span> itpp::Mat&lt;int&gt;&amp; set_of_vectors,<span class="keyword">const</span> itpp::Vec&lt;int&gt; displacement_vector){</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;  itpp::Mat&lt;int&gt; tmp(set_of_vectors.rows() ,set_of_vectors.cols() );</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; set_of_vectors.rows(); i++){</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;    tmp.set_row(i,set_of_vectors.get_row(i)+displacement_vector);</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;  }</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;}</div><div class="line"><a name="l01012"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#adf6341f5e389169d62c9e5b265e28e6c"> 1012</a></span>&#160;itpp::Array&lt;itpp::ivec&gt; <a class="code" href="namespaceitppextmath.html#adf6341f5e389169d62c9e5b265e28e6c">DisplaceScaleModulize</a>( <span class="keyword">const</span> itpp::Array&lt;itpp::ivec&gt;&amp; set_of_vectors,<span class="keyword">const</span> itpp::ivec displacement_vector, <span class="keyword">const</span> <span class="keywordtype">int</span> scale_factor, <span class="keyword">const</span> <span class="keywordtype">int</span> n){</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;  itpp::Array&lt;itpp::ivec&gt; tmp(set_of_vectors.size());</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; set_of_vectors.size(); i++){</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;    tmp(i)=set_of_vectors(i);</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    tmp(i)=scale_factor*tmp(i);</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    tmp(i)=tmp(i)+displacement_vector;</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    tmp(i)=<a class="code" href="namespaceitppextmath.html#ae41f1804449573b7ae08ec0b322950a4">Modulize</a>(tmp(i),n);</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;  }</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;}</div><div class="line"><a name="l01023"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#aec1bb7f0c7aac51a35cbe6c8b9845093"> 1023</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; itpp::Array&lt;Num_T*&gt; <a class="code" href="namespaceitppextmath.html#aec1bb7f0c7aac51a35cbe6c8b9845093">to_pointers_1</a>(itpp::Array&lt;Num_T&gt;&amp; v){</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;  itpp::Array&lt;Num_T*&gt; result(v.size());</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;v.size(); i++){</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    result(i)=&amp;(v(i));</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;  }</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;  <span class="keywordflow">return</span> result;</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;}</div><div class="line"><a name="l01030"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#ac1a654a660fc98e909a8fb1b4db7ccc6"> 1030</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; itpp::Array&lt;itpp::Array&lt;Num_T*&gt; &gt; <a class="code" href="namespaceitppextmath.html#ac1a654a660fc98e909a8fb1b4db7ccc6">to_pointers_2</a>(itpp::Array&lt;itpp::Array&lt;Num_T&gt; &gt;&amp; v){</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;  itpp::Array&lt;itpp::Array&lt;Num_T*&gt; &gt; result(v.size());</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;v.size(); i++){</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;    result(i).set_size(v(i).size());</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;v(i).size(); j++){</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;      result(i)(j)=&amp;(v(i)(j));</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    }</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;  }</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;  <span class="keywordflow">return</span> result;</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;}</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;<span class="comment">// }}}</span></div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;<span class="comment">// 2D grid specialized functions {{{</span></div><div class="line"><a name="l01042"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a7c4a435bcb8b2ecb25235a3ad973977d"> 1042</a></span>&#160;itpp::ivec <a class="code" href="namespaceitppextmath.html#a7c4a435bcb8b2ecb25235a3ad973977d">GetBlock</a>(<span class="keyword">const</span> itpp::Array&lt;itpp::ivec&gt;&amp; positions, <span class="keyword">const</span> <span class="keywordtype">int</span> length_cell, <span class="keyword">const</span> <span class="keywordtype">int</span> length_grid){</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;  <span class="keywordflow">if</span> (positions.size() == 1 &amp;&amp; positions(0)==itpp::vec_2(0,0)){</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;    <span class="comment">// std::cerr &lt;&lt; &quot;Poaca papa, positions.size()=&quot;&lt;&lt; positions.size() &lt;&lt; &quot;\n&quot;;</span></div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    <span class="keywordflow">return</span> itpp::vec_2(0,0);</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;  }</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;  <span class="keywordflow">if</span> (positions.size() != 4){</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;    std::cerr &lt;&lt; <span class="stringliteral">&quot;Something wrong in GetBlock sdlkjhflakshf, positions.size()=&quot;</span>&lt;&lt; positions.size() </div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;, length_cell=&quot;</span> &lt;&lt; length_cell&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;    abort();</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;  }</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;  itpp::ivec position_block(positions(0).size() ), las;</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;  <span class="keywordtype">int</span> cell_size;</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt; positions(0).size(); i++){</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    las =<a class="code" href="namespaceitppextmath.html#a321e6541aead62bb6178f7474b9c5d37">Union</a>(<a class="code" href="namespaceitppextmath.html#ad1c9dbe11deb8cc15723cbf40e1aab42">get_column</a>(positions,i));</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    <a class="code" href="namespaceitppextmath.html#a1497e509510ac3450b76342b601ea8f7">itpp::sort</a>(las);</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;<span class="comment">//     las =itppextmath::sort(Union(get_column(positions,i)));</span></div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    <span class="keywordflow">if</span> (las.size() != 2){</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;      std::cerr &lt;&lt; <span class="stringliteral">&quot;Something wrong in GetBlock o8e7dkjhf\n&quot;</span>;</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;      abort();</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    }</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;    <span class="keywordflow">if</span> ( las(0) == 0){</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;      <span class="keywordflow">if</span>( <a class="code" href="namespacecfpmath.html#a34b0482e902f9d69532a1272a63ded74">cfpmath::test_int_log</a>(length_cell, las(1))){</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;        position_block(i)=0;</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;        cell_size= las(1)-las(0);</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code" href="namespacecfpmath.html#a34b0482e902f9d69532a1272a63ded74">cfpmath::test_int_log</a>(length_cell, length_grid - las(1)) ) {</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;        cell_size = length_grid - las(1);</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;        position_block(i) = length_grid / cell_size -1;</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;      }</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;      cell_size = las(1) - las(0);</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;      position_block(i)=las(0)/cell_size;</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    }</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;  }</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;  <span class="keywordflow">return</span> position_block; </div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;}</div><div class="line"><a name="l01077"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#af068a446b43ca1b0f7fc6a4a068f6617"> 1077</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceitppextmath.html#af068a446b43ca1b0f7fc6a4a068f6617">get_base_position_and_delta</a>(<span class="keyword">const</span>  itpp::Array&lt;itpp::ivec &gt; Positions, <span class="keywordtype">int</span>&amp; delta, itpp::ivec&amp; base_position){</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;  <span class="keywordtype">int</span> candidate_delta;</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;  base_position=Positions(0);</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=1; i&lt; Positions.size(); i++){</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;    <span class="keywordflow">if</span> (Positions(i)(0) &lt; base_position(0)) base_position(0) = Positions(i)(0);</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    <span class="keywordflow">if</span> (Positions(i)(1) &lt; base_position(1)) base_position(1) = Positions(i)(1);</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;  }</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;  delta = -1;</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt; Positions.size() ; i++){</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;    candidate_delta= itpp::max(Positions(i)-base_position );    </div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;    <span class="keywordflow">if</span> (candidate_delta &gt; 0 &amp;&amp; delta &lt; 0) delta = candidate_delta;</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;    <span class="keywordflow">if</span> (candidate_delta &lt; delta)          delta = candidate_delta;</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;  }</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;  <span class="keywordflow">return</span>; </div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;}</div><div class="line"><a name="l01092"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#afb213f888c57016e4342d002570217b4"> 1092</a></span>&#160;itpp::Array&lt;itpp::ivec&gt; <a class="code" href="namespaceitppextmath.html#afb213f888c57016e4342d002570217b4">rotationaly_order_vector_renormalized_lattices_3</a>(<span class="keyword">const</span> itpp::Array&lt;itpp::ivec &gt;&amp; A, <span class="keyword">const</span> <span class="keywordtype">int</span> length_mera){</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;  <span class="comment">// This routine identifies the canonical order of a set of points</span></div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;  <span class="comment">// that me a valid set of points after a renormalization step in a </span></div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;  <span class="comment">// 3^n x 3^n or 2*3^n x 2*3^n lattice </span></div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;  <span class="keywordflow">if</span> (A.size() != 4){</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    std::cerr &lt;&lt; <span class="stringliteral">&quot;@rotationaly_order_vector_renormalized_lattices_3. Error, the size must be 4. Actual size: &quot;</span> </div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;      &lt;&lt; A.size() &lt;&lt; std::endl;</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    abort();</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;  }</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="test__spins_8cpp.html#a2ee8a150bb54ec98032ed8bbaa10addc">Delta</a>;</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;  itpp::ivec x = <a class="code" href="namespaceitppextmath.html#a321e6541aead62bb6178f7474b9c5d37">Union</a>(<a class="code" href="namespaceitppextmath.html#ad1c9dbe11deb8cc15723cbf40e1aab42">get_column</a>(A,0));<a class="code" href="namespaceitppextmath.html#a1497e509510ac3450b76342b601ea8f7">sort</a>(x);</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;  itpp::ivec y = <a class="code" href="namespaceitppextmath.html#a321e6541aead62bb6178f7474b9c5d37">Union</a>(<a class="code" href="namespaceitppextmath.html#ad1c9dbe11deb8cc15723cbf40e1aab42">get_column</a>(A,1));<a class="code" href="namespaceitppextmath.html#a1497e509510ac3450b76342b601ea8f7">sort</a>(y);</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;  itpp::ivec base(2);base=itpp::vec_2(x(0), y(0));</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;  Delta=x(1)-x(0);</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;  <span class="keywordflow">if</span> (x(0)==0 &amp;&amp; !<a class="code" href="namespacecfpmath.html#a34b0482e902f9d69532a1272a63ded74">cfpmath::test_int_log</a>(3, Delta)){</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;      Delta = <a class="code" href="namespacecfpmath.html#a5f21fc6d719ebe76110d5b941e3c9c6e">cfpmath::maximum_prime_power_divisor</a>(x(1),3);</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;      base(0)=x(1);</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;  }</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;  <span class="keywordflow">if</span> (y(0)==0 &amp;&amp; !<a class="code" href="namespacecfpmath.html#a34b0482e902f9d69532a1272a63ded74">cfpmath::test_int_log</a>(3, y(1)-y(0))){</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;      base(1)=y(1);</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;  }</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;  itpp::Array&lt;itpp::ivec&gt; DesiredPositions(4);</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;  DesiredPositions(0) = base;</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;  DesiredPositions(1) = base+itpp::vec_2(0,Delta);</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;  DesiredPositions(2) = base+itpp::vec_2(Delta,Delta);</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;  DesiredPositions(3) = base+itpp::vec_2(Delta,0) ;</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;  DesiredPositions = <a class="code" href="namespaceitppextmath.html#ae41f1804449573b7ae08ec0b322950a4">Modulize</a>(DesiredPositions, length_mera);</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespaceitppextmath.html#a84a859248955c9f3a8e4c4f969168d92">AreEqual_modulo_order</a>(DesiredPositions, A)){</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    std::cerr &lt;&lt; <span class="stringliteral">&quot;@rotationaly_order_vector_renormalized_lattices_3. Error, las posiciones no coinciden:&quot;</span></div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;DesiredPositions: &quot;</span> &lt;&lt; DesiredPositions &lt;&lt; std::endl</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;A: &quot;</span> &lt;&lt; A &lt;&lt; std::endl; </div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;  }</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;  <span class="keywordflow">return</span> DesiredPositions;</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;}</div><div class="line"><a name="l01128"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a59fff49eaa8848d0b918cb4b81f5e435"> 1128</a></span>&#160;itpp::Array&lt;itpp::ivec&gt; <a class="code" href="namespaceitppextmath.html#a59fff49eaa8848d0b918cb4b81f5e435">rotational_order</a>(<span class="keyword">const</span> itpp::Array&lt;itpp::ivec &gt;&amp; A){</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;  itpp::ivec pos_x = <a class="code" href="namespaceitppextmath.html#ad1c9dbe11deb8cc15723cbf40e1aab42">get_column</a>(A,0), pos_y = <a class="code" href="namespaceitppextmath.html#ad1c9dbe11deb8cc15723cbf40e1aab42">get_column</a>(A,1);</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;  itpp::ivec base = itpp::vec_2(itpp::min(pos_x), itpp::min(pos_y));</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="test__spins_8cpp.html#a2ee8a150bb54ec98032ed8bbaa10addc">Delta</a> =  itpp::max(pos_x) - itpp::min(pos_x);</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;  itpp::Array&lt;itpp::ivec&gt; DesiredPositions(4);</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;  DesiredPositions(0) = base;</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;  DesiredPositions(1) = base+itpp::vec_2(0,Delta);</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;  DesiredPositions(2) = base+itpp::vec_2(Delta,Delta);</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;  DesiredPositions(3) = base+itpp::vec_2(Delta,0) ;</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;  <span class="keywordflow">return</span> DesiredPositions;</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;} </div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;<span class="comment">// }}}</span></div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;<span class="comment">// Fermionic specialized functions {{{</span></div><div class="line"><a name="l01141"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#ac683572299a46ad974f32433f4942af6"> 1141</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceitppextmath.html#ac683572299a46ad974f32433f4942af6">UpDownMostIndexFermionicMatrix</a>(itpp::cmat&amp; MatrixEven, itpp::cmat&amp; MatrixOdd, <span class="keyword">const</span> std::string direction, <span class="keyword">const</span> std::string <a class="code" href="test__spins_8cpp.html#a081a3c90b5ddb319e1866471b948e0c5">position</a>){</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;  <span class="keywordflow">if</span> ( (position != <span class="stringliteral">&quot;most&quot;</span> &amp;&amp; position != <span class="stringliteral">&quot;least&quot;</span>) || </div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;      (direction != <span class="stringliteral">&quot;outgoing_to_incomming&quot;</span> &amp;&amp; direction != <span class="stringliteral">&quot;incomming_to_outgoing&quot;</span>)){</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    std::cerr &lt;&lt; <span class="stringliteral">&quot;Error in DownMostSignificantIndexFermionicMatrix, xuweor98\n&quot;</span></div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;direction:&quot;</span>&lt;&lt; direction &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;position:&quot;</span>&lt;&lt; position &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;( ):&quot;</span>&lt;&lt; (direction != <span class="stringliteral">&quot;outgoing_to_incomming&quot;</span> &amp;&amp; direction != <span class="stringliteral">&quot;incomming_to_outgoing&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;(position != most &amp;&amp; position != least):&quot;</span>&lt;&lt; (position != <span class="stringliteral">&quot;most&quot;</span> &amp;&amp; position != <span class="stringliteral">&quot;least&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;      ;</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;    abort();</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;  }</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;  <span class="keywordtype">int</span> d_in  = MatrixEven.cols(), d_out = MatrixEven.rows();</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;  <span class="keywordflow">if</span> (d_in != MatrixOdd.cols() || d_out != MatrixOdd.rows()){</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;    std::cerr &lt;&lt; <span class="stringliteral">&quot;Error in DownMostSignificantIndexFermionicMatrix, o2u234\n&quot;</span>;</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;    abort();</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;  }</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;  itpp::cmat new_even, new_odd;</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;  <span class="keywordflow">if</span> (direction == <span class="stringliteral">&quot;outgoing_to_incomming&quot;</span>){</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    new_even.set_size(d_out/2,2*d_in); </div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;    new_odd.set_size(d_out/2,2*d_in); </div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    <span class="keywordflow">if</span> (position==<span class="stringliteral">&quot;most&quot;</span>){</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;      new_even.set_submatrix(0,0, MatrixEven(0, d_out/2 -1, 0, d_in-1));</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;      new_even.set_submatrix(0,d_in, MatrixOdd(d_out/2, d_out -1, 0, d_in-1));</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;      new_odd.set_submatrix(0,0, MatrixOdd(0, d_out/2 -1, 0, d_in-1));</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;      new_odd.set_submatrix(0,d_in, MatrixEven(d_out/2, d_out -1, 0, d_in-1));</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;    } </div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;    <span class="keywordflow">if</span> (position==<span class="stringliteral">&quot;least&quot;</span>){</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;      <span class="keywordtype">bool</span> parity_i, parity_j;</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;      std::complex&lt;double&gt; matrix_element;</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; d_out; i++){</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j &lt; 2*d_in; j++){</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;          parity_i = <a class="code" href="namespacecfpmath.html#af3c32bd1720f4995f7b8bb27724ca9c1">cfpmath::parity_sum_digits_base_2</a>(i); </div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;          parity_j = <a class="code" href="namespacecfpmath.html#af3c32bd1720f4995f7b8bb27724ca9c1">cfpmath::parity_sum_digits_base_2</a>(j); </div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;          <span class="keywordflow">if</span> (parity_j == 0 ){ </div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;            matrix_element = MatrixEven(i,j/2);</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;          } <span class="keywordflow">else</span> { </div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;            matrix_element = MatrixOdd(i,j/2); </div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;          }</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;          <span class="keywordflow">if</span> (parity_i == 0 ){ </div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;            new_even(i/2,j) = matrix_element;</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;          } <span class="keywordflow">else</span> { </div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;            new_odd(i/2,j) = matrix_element; </div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;          }</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;        }</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;      }</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    }</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;  }</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;  <span class="keywordflow">if</span> (direction == <span class="stringliteral">&quot;incomming_to_outgoing&quot;</span>){</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;    new_even.set_size(d_out*2,d_in/2); </div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    new_odd.set_size(d_out*2,d_in/2); </div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    <span class="keywordflow">if</span> (position==<span class="stringliteral">&quot;most&quot;</span>){</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;      new_even.set_submatrix(0,0, MatrixEven(0, d_out -1, 0, d_in/2-1));</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;      new_even.set_submatrix(d_out, 0, MatrixOdd(0, d_out -1, d_in/2, d_in-1));</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;      new_odd.set_submatrix(0,0, MatrixOdd(0, d_out -1, 0, d_in/2 -1));</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;      new_odd.set_submatrix(d_out, 0, MatrixEven(0, d_out -1, d_in/2, d_in-1));</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;    } </div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;    <span class="keywordflow">if</span> (position==<span class="stringliteral">&quot;least&quot;</span>){</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;      <span class="keywordtype">bool</span> parity_i, parity_j;</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;      std::complex&lt;double&gt; matrix_element;</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; 2*d_out; i++){</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j &lt; d_in; j++){</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;          parity_i = <a class="code" href="namespacecfpmath.html#af3c32bd1720f4995f7b8bb27724ca9c1">cfpmath::parity_sum_digits_base_2</a>(i); </div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;          parity_j = <a class="code" href="namespacecfpmath.html#af3c32bd1720f4995f7b8bb27724ca9c1">cfpmath::parity_sum_digits_base_2</a>(j); </div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;          <span class="keywordflow">if</span> (parity_i == 0 ){ </div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;            matrix_element = MatrixEven(i/2,j);</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;          } <span class="keywordflow">else</span> { </div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;            matrix_element = MatrixOdd(i/2,j); </div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;          }</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;          <span class="keywordflow">if</span> (parity_j == 0 ){ </div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;            new_even(i,j/2) = matrix_element;</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;          } <span class="keywordflow">else</span> { </div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;            new_odd(i,j/2) = matrix_element; </div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;          }</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;        }</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;      }</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    }</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;  }</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;  MatrixEven = new_even;</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;  MatrixOdd = new_odd;</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;  <span class="keywordflow">return</span>;</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;}</div><div class="line"><a name="l01222"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#addd7ce29a6ae9b014f5fbf5c8318d574"> 1222</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceitppextmath.html#ac683572299a46ad974f32433f4942af6">UpDownMostIndexFermionicMatrix</a>(itpp::cmat&amp; MatrixEven, itpp::cmat&amp; MatrixOdd, <span class="keyword">const</span> <span class="keywordtype">int</span> places_most, <span class="keyword">const</span> <span class="keywordtype">int</span> places_least){</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;  <span class="keywordflow">if</span> (places_most&gt;0){</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt; places_most; i++){</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;      <a class="code" href="namespaceitppextmath.html#ac683572299a46ad974f32433f4942af6">UpDownMostIndexFermionicMatrix</a>(MatrixEven, MatrixOdd, <span class="stringliteral">&quot;incomming_to_outgoing&quot;</span>, <span class="stringliteral">&quot;most&quot;</span>);</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;    }</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;  }</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;  <span class="keywordflow">if</span> (places_most&lt;0){</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&gt; places_most; i--){</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;      <a class="code" href="namespaceitppextmath.html#ac683572299a46ad974f32433f4942af6">UpDownMostIndexFermionicMatrix</a>(MatrixEven, MatrixOdd, <span class="stringliteral">&quot;outgoing_to_incomming&quot;</span>, <span class="stringliteral">&quot;most&quot;</span>);</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;    }</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;  }</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;  <span class="keywordflow">if</span> (places_least&gt;0){</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt; places_least; i++){</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;      <a class="code" href="namespaceitppextmath.html#ac683572299a46ad974f32433f4942af6">UpDownMostIndexFermionicMatrix</a>(MatrixEven, MatrixOdd, <span class="stringliteral">&quot;outgoing_to_incomming&quot;</span>, <span class="stringliteral">&quot;least&quot;</span>);</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;    }</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;  }</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;  <span class="keywordflow">if</span> (places_least&lt;0){</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&gt; places_least; i--){</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;      <a class="code" href="namespaceitppextmath.html#ac683572299a46ad974f32433f4942af6">UpDownMostIndexFermionicMatrix</a>(MatrixEven, MatrixOdd, <span class="stringliteral">&quot;incomming_to_outgoing&quot;</span>, <span class="stringliteral">&quot;least&quot;</span>);</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;<span class="comment">//       std::cerr &lt;&lt; &quot;hello &quot; &lt;&lt; i &lt;&lt; &quot;\n&quot;;</span></div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    }</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;  }</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;  <span class="keywordflow">return</span>;</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;}</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;<span class="comment">// }}}</span></div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;<span class="comment">// Quantum Info, and advanced functions {{{</span></div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;<span class="comment">// Some important matrices of operations and states</span></div><div class="line"><a name="l01254"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#aba26eee000b8df67356695966d055999"> 1254</a></span>&#160;itpp::cmat <a class="code" href="namespaceitppextmath.html#aba26eee000b8df67356695966d055999">sigma</a>(itpp::ivec is){ <span class="comment">// {{{</span></div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="test__spins_8cpp.html#a27ffb1722fa87a1797329ba47b0d8221">qubits</a>=is.size();</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;  itpp::Array&lt;itpp::cmat&gt; sigmas(qubits);</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;  <span class="keywordflow">if</span> (qubits==0){</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;    <span class="keywordflow">return</span> itpp::mat_1x1( std::complex&lt;double&gt; (1,0));</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;  }</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="test__spins_8cpp.html#a27ffb1722fa87a1797329ba47b0d8221">qubits</a>; i++){</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;    sigmas(qubits-i-1)=<a class="code" href="namespaceitppextmath.html#aba26eee000b8df67356695966d055999">sigma</a>(is(i));</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;  }</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespaceitppextmath.html#ac8477886770d8df6d3dedba2eca68d43">TensorProduct</a>(sigmas);</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l01266"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#ac10aa3fedd069c619c366177e6bbbf8e"> 1266</a></span>&#160;itpp::cmat <a class="code" href="namespaceitppextmath.html#aba26eee000b8df67356695966d055999">sigma</a>(<span class="keywordtype">int</span> i){ <span class="comment">// {{{</span></div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;  std::complex&lt;double&gt; imaginary(0,1), c0(0.,0.);</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;  <span class="keywordflow">switch</span> (i) {</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;    <span class="keywordflow">case</span> 0:</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;      <span class="keywordflow">return</span> itpp::to_cmat(itpp::mat_2x2(1, 0, 0, 1));</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;    <span class="keywordflow">case</span> 1:</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;      <span class="keywordflow">return</span> itpp::to_cmat(itpp::mat_2x2(0, 1, 1, 0));</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;    <span class="keywordflow">case</span> 2:</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;      <span class="keywordflow">return</span> itpp::mat_2x2(c0, -imaginary, imaginary, c0);</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;    <span class="keywordflow">case</span> 3:</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;      <span class="keywordflow">return</span> itpp::to_cmat(itpp::mat_2x2(1, 0, 0, -1));</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;Sigma not found. i=&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>; </div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;      abort(); </div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;  }</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l01282"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#aa4040144288798b5891d1495aa65f8dc"> 1282</a></span>&#160;itpp::cmat <a class="code" href="namespaceitppextmath.html#aba26eee000b8df67356695966d055999">sigma</a>(itpp::vec <a class="code" href="jquery_8js.html#aa4026ad5544b958e54ce5e106fa1c805">b</a>){ <span class="comment">// {{{</span></div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;  <span class="keywordflow">if</span> (b.size()==3){</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="jquery_8js.html#aa4026ad5544b958e54ce5e106fa1c805">b</a>(0)*<a class="code" href="namespaceitppextmath.html#aba26eee000b8df67356695966d055999">sigma</a>(1)+<a class="code" href="jquery_8js.html#aa4026ad5544b958e54ce5e106fa1c805">b</a>(1)*<a class="code" href="namespaceitppextmath.html#aba26eee000b8df67356695966d055999">sigma</a>(2)+ <a class="code" href="jquery_8js.html#aa4026ad5544b958e54ce5e106fa1c805">b</a>(2)*<a class="code" href="namespaceitppextmath.html#aba26eee000b8df67356695966d055999">sigma</a>(3);</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Sigma not found 89p790as7dfu.\n&quot;</span>;</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;    abort(); </div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;  }</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l01290"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a65cbdc9e633dc2d275814b68d5035cca"> 1290</a></span>&#160;itpp::cmat <a class="code" href="namespaceitppextmath.html#aba26eee000b8df67356695966d055999">sigma</a>(itpp::vec <a class="code" href="jquery_8js.html#aa4026ad5544b958e54ce5e106fa1c805">b</a>, <span class="keywordtype">int</span> <a class="code" href="test__spins_8cpp.html#a081a3c90b5ddb319e1866471b948e0c5">position</a>, <span class="keywordtype">int</span> total){ <span class="comment">// {{{</span></div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;  itpp::cmat tmp = <a class="code" href="namespaceitppextmath.html#aba26eee000b8df67356695966d055999">sigma</a>(b);</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;  <span class="keywordflow">if</span> (position==total-1){</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;    tmp=<a class="code" href="namespaceitppextmath.html#ac8477886770d8df6d3dedba2eca68d43">TensorProduct</a>(tmp,itpp::eye_c(<a class="code" href="namespacecfpmath.html#abf5bd8dc5d8af42a850231816e60e95f">cfpmath::pow_2</a>(total-1)));</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (position==0){</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    tmp=<a class="code" href="namespaceitppextmath.html#ac8477886770d8df6d3dedba2eca68d43">TensorProduct</a>(itpp::eye_c(<a class="code" href="namespacecfpmath.html#abf5bd8dc5d8af42a850231816e60e95f">cfpmath::pow_2</a>(total-1)),tmp);</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (0&lt;position &amp;&amp; position&lt;total-1){</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;    tmp=<a class="code" href="namespaceitppextmath.html#ac8477886770d8df6d3dedba2eca68d43">TensorProduct</a>(tmp,itpp::eye_c(<a class="code" href="namespacecfpmath.html#abf5bd8dc5d8af42a850231816e60e95f">cfpmath::pow_2</a>(position)));</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;    tmp=<a class="code" href="namespaceitppextmath.html#ac8477886770d8df6d3dedba2eca68d43">TensorProduct</a>(itpp::eye_c(<a class="code" href="namespacecfpmath.html#abf5bd8dc5d8af42a850231816e60e95f">cfpmath::pow_2</a>(total-position-1)),tmp);</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Sigma not found asdfa \n&quot;</span>;</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    abort(); </div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;  }</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l01305"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a4fec23b0332add59f23332792a8e6ca1"> 1305</a></span>&#160;itpp::mat <a class="code" href="namespaceitppextmath.html#a4fec23b0332add59f23332792a8e6ca1">hadamard_matrix</a>(){<span class="comment">// {{{</span></div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;  itpp::mat tmp(2,2);</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;  tmp=1;</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;  tmp(1,1)=-1;</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;  tmp=tmp/sqrt(2.);</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;} <span class="comment">//}}}</span></div><div class="line"><a name="l01312"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a0f92f4a79dc98a783d42226b051aad08"> 1312</a></span>&#160;itpp::mat <a class="code" href="namespaceitppextmath.html#a0f92f4a79dc98a783d42226b051aad08">swap_matrix</a>(){<span class="comment">// {{{</span></div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;  itpp::mat tmp(4,4);</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;  tmp=0.;</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;  tmp(0,0)=1;</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;  tmp(1,2)=1;</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;  tmp(2,1)=1;</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;  tmp(3,3)=1;</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;} <span class="comment">//}}}</span></div><div class="line"><a name="l01321"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a537927cb6f22e90041be4a26b3cda367"> 1321</a></span>&#160;itpp::mat <a class="code" href="namespaceitppextmath.html#a537927cb6f22e90041be4a26b3cda367">cnot_matrix</a>(){<span class="comment">// {{{</span></div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;  itpp::mat tmp(4,4);</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;  tmp=0.;</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;  tmp(0,0)=1;</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;  tmp(1,1)=1;</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;  tmp(2,3)=1;</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;  tmp(3,2)=1;</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;} <span class="comment">//}}}</span></div><div class="line"><a name="l01330"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#afeada4c0dcee4b2edd2c650d18113b17"> 1330</a></span>&#160;itpp::cmat <a class="code" href="namespaceitppextmath.html#afeada4c0dcee4b2edd2c650d18113b17">control_u_matrix</a>(itpp::cmat&amp; u){<span class="comment">// {{{</span></div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;  itpp::cmat tmp(4,4);</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;  tmp=0.;</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;  tmp(0,0)=1;</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;  tmp(1,1)=1;</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;  tmp.set_submatrix(2,2,u);</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;} <span class="comment">//}}}</span></div><div class="line"><a name="l01338"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#ad194f701fd62db23d80d8a6d489f84b8"> 1338</a></span>&#160;itpp::ivec <a class="code" href="namespaceitppextmath.html#ad194f701fd62db23d80d8a6d489f84b8">diagonal_sigma_z</a>(<span class="keywordtype">int</span> encoded_positions, <span class="keywordtype">int</span> <a class="code" href="test__spins_8cpp.html#a27ffb1722fa87a1797329ba47b0d8221">qubits</a>){ <span class="comment">// {{{</span></div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;  itpp::ivec tmp(<a class="code" href="namespacecfpmath.html#abf5bd8dc5d8af42a850231816e60e95f">cfpmath::pow_2</a>(qubits));</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;  tmp=1;</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;<span class="comment">//   std::cout &lt;&lt; &quot;Encoded positions = &quot; &lt;&lt; encoded_positions &lt;&lt; std::endl; </span></div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="namespacecfpmath.html#abf5bd8dc5d8af42a850231816e60e95f">cfpmath::pow_2</a>(qubits); i++){</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;<span class="comment">//     std::cout &lt;&lt; &quot;i=&quot;&lt;&lt;i&lt;&lt;&quot;, i&amp;encoded_positions = &quot; &lt;&lt; (i&amp;encoded_positions) &lt;&lt; std::endl;</span></div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacecfpmath.html#af3c32bd1720f4995f7b8bb27724ca9c1">cfpmath::parity_sum_digits_base_2</a>(i&amp;encoded_positions)){</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;      tmp(i)=-1;</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;    }</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;  }</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l01350"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a88c313cb5025a2404533d608382e56f4"> 1350</a></span>&#160;itpp::Mat&lt;std::complex&lt;double&gt; &gt; <a class="code" href="namespaceitppextmath.html#a88c313cb5025a2404533d608382e56f4">Werner</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> alpha){<span class="comment">// {{{</span></div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;    itpp::Mat&lt;std::complex&lt;double&gt;  &gt; tmp(4,4);</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;    tmp=0.;</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;    tmp(0,0)=tmp(3,3)=(2-alpha)/4;</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;    tmp(1,1)=tmp(2,2)=alpha/4;</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;    tmp(0,3)=tmp(3,0)=(1-alpha)/2;</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;    <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;}<span class="comment">// }}}</span></div><div class="line"><a name="l01358"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a849bb716d90d591917ae25e9fe8455c7"> 1358</a></span>&#160;itpp::cvec <a class="code" href="namespaceitppextmath.html#a849bb716d90d591917ae25e9fe8455c7">RandomState</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dim){ <span class="comment">// {{{</span></div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;  itpp::cvec tmp=itpp::randn_c(dim);</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;  <span class="keywordflow">return</span> tmp/norm(tmp);</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l01362"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#acbbd6e6954fd3077db382d3b4900c13b"> 1362</a></span>&#160;itpp::cvec <a class="code" href="namespaceitppextmath.html#acbbd6e6954fd3077db382d3b4900c13b">BasisState</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dim, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> basis_number){ <span class="comment">// {{{</span></div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;  itpp::cvec tmp(dim);</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;  tmp.zeros();</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;  tmp(basis_number)=1;</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l01368"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#ada22580533a133f0a29eb9b23c5d0ba0"> 1368</a></span>&#160;itpp::vec <a class="code" href="namespaceitppextmath.html#ada22580533a133f0a29eb9b23c5d0ba0">BellState</a>(<span class="keywordtype">int</span> dim=4){<span class="comment">// {{{</span></div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;  itpp::vec tmp(dim);</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;  tmp.zeros();</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;  tmp(0)=1;</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;  tmp(dim-1)=1;</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;  <span class="keywordflow">return</span> tmp/sqrt(2.);</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;}<span class="comment">// }}}</span></div><div class="line"><a name="l01375"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#ae225202b58c132e34b3c319e989ab259"> 1375</a></span>&#160;itpp::cvec <a class="code" href="namespaceitppextmath.html#ae225202b58c132e34b3c319e989ab259">BlochToQubit</a>(<span class="keywordtype">double</span> theta, <span class="keywordtype">double</span> phi){<span class="comment">// {{{</span></div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;  itpp::cvec tmp(2);</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;  std::complex&lt;double&gt; I(0,1);</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;  tmp.zeros();</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;  tmp(0)=cos(theta/2);</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;  tmp(1)=sin(theta/2)*exp(I*phi);</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;}<span class="comment">// }}}</span></div><div class="line"><a name="l01383"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a89e4857106e23b961519bc15662cf277"> 1383</a></span>&#160;itpp::vec <a class="code" href="namespaceitppextmath.html#ada22580533a133f0a29eb9b23c5d0ba0">BellState</a>(<span class="keywordtype">double</span> theta){<span class="comment">// {{{</span></div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;  <span class="keywordtype">int</span> dim=4;</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;  itpp::vec tmp(dim);</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;  tmp.zeros();</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;  tmp(0)=cos(theta);</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;  tmp(dim-1)=sin(theta);</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;}<span class="comment">// }}}</span></div><div class="line"><a name="l01391"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a222aa8c457a93a8667f89eae38c08c0b"> 1391</a></span>&#160;itpp::cmat <a class="code" href="namespaceitppextmath.html#a222aa8c457a93a8667f89eae38c08c0b">exp_minus_i_b_sigma</a>(itpp::vec <a class="code" href="jquery_8js.html#aa4026ad5544b958e54ce5e106fa1c805">b</a>){<span class="comment">// {{{</span></div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;  <span class="comment">// From sakurai eq (3.2.44) we have that</span></div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;  <span class="comment">// exp(- i \sigma \cdot n \phi/2) =</span></div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;  <span class="comment">//  cos(\phi/2) \openone -  i sin(\phi/2) \sigma \cdot n</span></div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;  <span class="comment">// exp(- i \sigma \cdot n \theta) =</span></div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;  <span class="comment">//  cos(\theta) \openone -  i sin(\theta) \sigma \cdot n</span></div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;  <span class="keywordtype">double</span> theta=itpp::norm(b);</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;<span class="comment">//   std::cout &lt;&lt; theta &lt;&lt; std::endl;</span></div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;  std::complex&lt;double&gt; I(0,1);</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;  itpp::vec n=b/theta;</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;  <span class="keywordflow">return</span> cos(theta)*<a class="code" href="namespaceitppextmath.html#aba26eee000b8df67356695966d055999">sigma</a>(0)-I*sin(theta)*<a class="code" href="namespaceitppextmath.html#aba26eee000b8df67356695966d055999">sigma</a>(n);</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;}<span class="comment">// }}}</span></div><div class="line"><a name="l01404"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#ae46953c9ecd4f5f972446309e11da2cf"> 1404</a></span>&#160;itpp::cmat <a class="code" href="namespaceitppextmath.html#ae46953c9ecd4f5f972446309e11da2cf">magnetic</a>(itpp::vec <a class="code" href="jquery_8js.html#aa4026ad5544b958e54ce5e106fa1c805">b</a>, <span class="keywordtype">int</span> total){<span class="comment">// {{{</span></div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;  itpp::cmat tmp(<a class="code" href="namespacecfpmath.html#abf5bd8dc5d8af42a850231816e60e95f">cfpmath::pow_2</a>(total),<a class="code" href="namespacecfpmath.html#abf5bd8dc5d8af42a850231816e60e95f">cfpmath::pow_2</a>(total));</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;  tmp=0.;</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;total; i++){</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;    tmp=tmp+<a class="code" href="namespaceitppextmath.html#aba26eee000b8df67356695966d055999">sigma</a>(b, i, total);</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;  }</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;}<span class="comment">// }}}</span></div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;<span class="comment">// Apply operations</span></div><div class="line"><a name="l01413"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a24486dd52ae4cac2c72fdc01755ffa97"> 1413</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; <span class="keywordtype">void</span> <a class="code" href="namespaceitppextmath.html#a24486dd52ae4cac2c72fdc01755ffa97">apply_sigma_x</a>(itpp::Vec&lt;Num_T&gt;&amp; state, <span class="keywordtype">int</span> target_bit){<span class="comment">// {{{</span></div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;  <span class="keywordtype">int</span> pos_1, pos_2;</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;  Num_T x;</div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;state.size()/2; i++){</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;    pos_1 = <a class="code" href="namespacecfpmath.html#a0e87a9ace78d12b29b6219ec271fa11a">cfpmath::merge_two_numbers</a>(0, i, <a class="code" href="namespacecfpmath.html#abf5bd8dc5d8af42a850231816e60e95f">cfpmath::pow_2</a>(target_bit));</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;    pos_2 = <a class="code" href="namespacecfpmath.html#a688f1d2b481a55142e9951be28b3275d">cfpmath::set_bit</a>(pos_1,target_bit);</div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;<span class="comment">//     std::cout &lt;&lt; &quot;i=&quot;&lt;&lt; i &lt;&lt; &quot;, pos_1=&quot;&lt;&lt; pos_1 &lt;&lt; &quot;, pos_2=&quot;&lt;&lt; pos_2 &lt;&lt; &quot;, target_bit=&quot; &lt;&lt; target_bit &lt;&lt; &quot;\n&quot;;</span></div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;    x=state(pos_1);</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;    state(pos_1)=state(pos_2);</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;    state(pos_2)=x;</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;<span class="comment">//     std::cout &lt;&lt; &quot;state(pos_1)=&quot;&lt;&lt; state(pos_1) &lt;&lt; &quot;, state(pos_2)=&quot;&lt;&lt; state(pos_2)  &lt;&lt; &quot;\n&quot;;</span></div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;  }</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;<span class="comment">//    std::cout &lt;&lt; &quot;state&quot; &lt;&lt; state &lt;&lt; &quot;\n&quot;;</span></div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;<span class="keywordflow">return</span>;</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;}<span class="comment">// }}}</span></div><div class="line"><a name="l01429"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a2c0da80b7f18e53b39bff77d391a4ad4"> 1429</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; <span class="keywordtype">void</span> <a class="code" href="namespaceitppextmath.html#a2c0da80b7f18e53b39bff77d391a4ad4">apply_sigma_y</a>(itpp::Vec&lt;Num_T&gt;&amp; state, <span class="keywordtype">int</span> target_bit){<span class="comment">// {{{</span></div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;  <span class="keywordtype">int</span> pos_1, pos_2;</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;  std::complex&lt;double&gt; <a class="code" href="test__spins_8cpp.html#abf188b893e95a7f7bf6b71cd2ea0ef18">Im</a>(0.,1.);</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;  Num_T x;</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;state.size()/2; i++){</div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;    pos_1 = <a class="code" href="namespacecfpmath.html#a0e87a9ace78d12b29b6219ec271fa11a">cfpmath::merge_two_numbers</a>(0, i, <a class="code" href="namespacecfpmath.html#abf5bd8dc5d8af42a850231816e60e95f">cfpmath::pow_2</a>(target_bit));</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;    pos_2 = <a class="code" href="namespacecfpmath.html#a688f1d2b481a55142e9951be28b3275d">cfpmath::set_bit</a>(pos_1,target_bit);</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;<span class="comment">//     std::cout &lt;&lt; &quot;i=&quot;&lt;&lt; i &lt;&lt; &quot;, pos_1=&quot;&lt;&lt; pos_1 &lt;&lt; &quot;, pos_2=&quot;&lt;&lt; pos_2 &lt;&lt; &quot;\n&quot;;</span></div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;    x=state(pos_1);</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;    state(pos_1)=-Im*state(pos_2);</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;    state(pos_2)=Im*x;</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;<span class="comment">//     std::cout &lt;&lt; &quot;state(pos_1)=&quot;&lt;&lt; state(pos_1) &lt;&lt; &quot;, state(pos_2)=&quot;&lt;&lt; state(pos_2)  &lt;&lt; &quot;\n&quot;;</span></div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;  }</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;<span class="comment">//   std::cout &lt;&lt; &quot;state&quot; &lt;&lt; state &lt;&lt; &quot;\n&quot;;</span></div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;}<span class="comment">// }}}</span></div><div class="line"><a name="l01444"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#aaca75ffe2ba18dd924046cd125412b2a"> 1444</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; <span class="keywordtype">void</span> <a class="code" href="namespaceitppextmath.html#aaca75ffe2ba18dd924046cd125412b2a">apply_sigma_z</a>(itpp::Vec&lt;Num_T&gt;&amp; state, <span class="keywordtype">int</span> target_bit){<span class="comment">// {{{</span></div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;  <span class="keywordtype">int</span> pos;</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;  Num_T x;</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;state.size()/2; i++){</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;    pos = <a class="code" href="namespacecfpmath.html#a0e87a9ace78d12b29b6219ec271fa11a">cfpmath::merge_two_numbers</a>(1, i, <a class="code" href="namespacecfpmath.html#abf5bd8dc5d8af42a850231816e60e95f">cfpmath::pow_2</a>(target_bit));</div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;<span class="comment">//     pos = cfpmath::set_bit(target_bit,target_bit);</span></div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;    state(pos)=-state(pos);</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;  }</div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;<span class="comment">//   std::cout &lt;&lt; &quot;state&quot; &lt;&lt; state &lt;&lt; &quot;\n&quot;;</span></div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;}<span class="comment">// }}}</span></div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;<span class="comment">// void apply_sigma(itpp::cvec state, itpp::vec b, int PositionQubit){ // {{{</span></div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;<span class="comment">// </span></div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;<span class="comment">//  abort();</span></div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;<span class="comment">// } // }}}</span></div><div class="line"><a name="l01458"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a0bfea3f1b78541f6331a6b20cd7a83fd"> 1458</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceitppextmath.html#a0bfea3f1b78541f6331a6b20cd7a83fd">apply_sigma</a>(itpp::cvec&amp; state, <span class="keywordtype">int</span> Pauli_i, <span class="keywordtype">int</span> PositionQubit){ <span class="comment">// {{{</span></div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;<span class="comment">//   std::cout &lt;&lt; &quot;Por entrar en el lio PositionQubit=&quot; &lt;&lt; PositionQubit &lt;&lt; &quot;, Pauli_i=&quot; &lt;&lt; Pauli_i &lt;&lt;  std::endl;</span></div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;  <span class="keywordflow">if</span> (Pauli_i==1){</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;    <a class="code" href="namespaceitppextmath.html#a24486dd52ae4cac2c72fdc01755ffa97">apply_sigma_x</a>(state, PositionQubit);</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Pauli_i==2) {</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;    <a class="code" href="namespaceitppextmath.html#a2c0da80b7f18e53b39bff77d391a4ad4">apply_sigma_y</a>(state, PositionQubit);</div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Pauli_i==3) {</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;    <a class="code" href="namespaceitppextmath.html#aaca75ffe2ba18dd924046cd125412b2a">apply_sigma_z</a>(state, PositionQubit);</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;  } </div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;  <span class="keywordflow">return</span>;</div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l01470"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#ac08a530c4601ec09e5f166ad73976691"> 1470</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceitppextmath.html#ac08a530c4601ec09e5f166ad73976691">apply_sum_sigma_x</a>(itpp::cvec&amp; state){ <span class="comment">// {{{</span></div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;  <span class="comment">// Applies the operator \sum_i \sigma_x^i to state</span></div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;  itpp:: cvec state_orig=state, new_state=itpp::zeros_c(state.size());</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="test__spins_8cpp.html#a27ffb1722fa87a1797329ba47b0d8221">qubits</a>=<a class="code" href="namespacecfpmath.html#ae2adca2461cce2b4efede98619da8be4">cfpmath::log_base_2</a>(state.size());</div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="test__spins_8cpp.html#a27ffb1722fa87a1797329ba47b0d8221">qubits</a>;i++){</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;    <a class="code" href="namespaceitppextmath.html#a24486dd52ae4cac2c72fdc01755ffa97">apply_sigma_x</a>(state_orig,i);</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;    new_state=new_state+state_orig;</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;    state_orig=state;</div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;  }</div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;  state=new_state;</div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;  <span class="keywordflow">return</span>;</div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l01482"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a6a5a690ed8231c740e7c2fc5fe73501c"> 1482</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceitppextmath.html#a6a5a690ed8231c740e7c2fc5fe73501c">apply_gate</a>(itpp::cvec&amp; state, <span class="keywordtype">int</span> nwhich, itpp::cmat gate){<span class="comment">// {{{</span></div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;  <span class="comment">// This gate has to be applied with care. Notice for example that</span></div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;  <span class="comment">// with nwhich=3=11, the gate XY and YX are different. We are assuming</span></div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;  <span class="comment">// that the user has taken care of ordering the incoming gate </span></div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;  <span class="comment">// carefully. For example, if you want to apply H in qubit 0 and</span></div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;  <span class="comment">// Y gate in qubit 2, you sould set </span></div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;  <span class="comment">// nwhich = 1 0 1 = 5</span></div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;  <span class="comment">// and then set gate = YH</span></div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;  <span class="comment">// since HY will give you an incorrect result. Moreover, if you want </span></div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;  <span class="comment">// to apply a controled gate, it is not good to put</span></div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;  <span class="comment">// 1 (oplus) U</span></div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;  <span class="comment">// if the control qubit is ?????? I dont know, but there is a correct</span></div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;  <span class="comment">// and an incorrect way of putting it. !! see the testing routine</span></div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;  <span class="comment">// to set it up-. </span></div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;  <span class="keywordtype">int</span> qs=<a class="code" href="namespacecfpmath.html#a6500e09a78acb96aa9644c42d791f7ac">cfpmath::BitCount</a>(nwhich);</div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;  <span class="keywordtype">int</span> qs2=<a class="code" href="namespacecfpmath.html#abf5bd8dc5d8af42a850231816e60e95f">cfpmath::pow_2</a>(qs);</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;  <span class="keywordflow">if</span> ( (gate.rows() != qs2) || (gate.rows() != qs2)){</div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;    std::cerr &lt;&lt; <span class="stringliteral">&quot;Error apply_gate&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;    std::cerr &lt;&lt; <span class="stringliteral">&quot;gate.rows()=&quot;</span> &lt;&lt; gate.rows() &lt;&lt; std::endl;</div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;    std::cerr &lt;&lt; <span class="stringliteral">&quot;qs2=&quot;</span> &lt;&lt; qs2 &lt;&lt; std::endl;</div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;    std::cerr &lt;&lt; <span class="stringliteral">&quot;nwhich=&quot;</span> &lt;&lt; nwhich &lt;&lt; std::endl;</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;    abort();</div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;  }</div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;  itpp::cvec moco;</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;  itpp::ivec pos(qs2);</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;state.size()/qs2; i++){</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;qs2; j++){</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;      pos(j)=<a class="code" href="namespacecfpmath.html#a0e87a9ace78d12b29b6219ec271fa11a">cfpmath::merge_two_numbers</a>(j,i,nwhich);</div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;    }</div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;<span class="comment">//     std::cout &lt;&lt; &quot;pos=&quot; &lt;&lt; pos &lt;&lt; std::endl;</span></div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;    moco=gate*state(pos);</div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;<span class="comment">//     std::cout &lt;&lt; &quot;moco=&quot; &lt;&lt; moco &lt;&lt; std::endl;</span></div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;qs2; j++){</div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;      state(pos(j))=moco(j);</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;    }</div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;<span class="comment">//     std::cout &lt;&lt; &quot;state(pos)=&quot; &lt;&lt; state(pos) &lt;&lt; std::endl;</span></div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;    </div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;  }</div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;<span class="comment">//   std::cout &lt;&lt; &quot;gate&quot; &lt;&lt; gate &lt;&lt; std::endl;</span></div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;<span class="comment">//   std::cout &lt;&lt; &quot;este deberia estar rotado&quot; &lt;&lt; state &lt;&lt; std::endl;</span></div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;  <span class="keywordflow">return</span>;</div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;}<span class="comment">// }}}</span></div><div class="line"><a name="l01526"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a94b34321024c44b50935d589848766ce"> 1526</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceitppextmath.html#a94b34321024c44b50935d589848766ce">apply_hadamard</a>(itpp::cvec&amp; state, <span class="keywordtype">int</span> <a class="code" href="test__spins_8cpp.html#a081a3c90b5ddb319e1866471b948e0c5">position</a>){<span class="comment">// {{{</span></div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;  itpp::ivec pos(2);</div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;  itpp::cvec moco;</div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;  itpp::mat h=<a class="code" href="namespaceitppextmath.html#a4fec23b0332add59f23332792a8e6ca1">hadamard_matrix</a>();</div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;state.size()/2; i++){</div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;    pos(0)=<a class="code" href="namespacecfpmath.html#a0e87a9ace78d12b29b6219ec271fa11a">cfpmath::merge_two_numbers</a>(0,i,<a class="code" href="namespacecfpmath.html#abf5bd8dc5d8af42a850231816e60e95f">cfpmath::pow_2</a>(position));</div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;    pos(1)=<a class="code" href="namespacecfpmath.html#a0e87a9ace78d12b29b6219ec271fa11a">cfpmath::merge_two_numbers</a>(1,i,<a class="code" href="namespacecfpmath.html#abf5bd8dc5d8af42a850231816e60e95f">cfpmath::pow_2</a>(position));</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;    moco= h*state(pos);</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;    state(pos(0))= moco(0);</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;    state(pos(1))= moco(1);</div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;  }</div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;  <span class="keywordflow">return</span>;</div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l01539"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a1b13aed0cbfe9879b304f139ee2c5565"> 1539</a></span>&#160;itpp::cmat <a class="code" href="namespaceitppextmath.html#a1b13aed0cbfe9879b304f139ee2c5565">multiply_by_sigma_leftmost_qubit</a>(<span class="keyword">const</span> itpp::cmat&amp; A, <span class="keywordtype">int</span> sigma_label){ <span class="comment">// {{{</span></div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;<span class="keywordflow">if</span> (sigma_label==0){</div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;  <span class="keywordflow">return</span> A;</div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;}</div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;<span class="keywordtype">int</span> n=A.cols();</div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;itpp::cmat B(n,n);</div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;<span class="keywordflow">if</span> (sigma_label==1) {</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;  B.set_submatrix(0  ,0,A.get_rows(n/2,n-1  ));</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;  B.set_submatrix(n/2,0,A.get_rows(0,  n/2-1));</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;  <span class="keywordflow">return</span> B;</div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;} <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sigma_label==2) {</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;  std::complex&lt;double&gt; I(0.,1.);</div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;  B.set_submatrix(0  ,0,-I*A.get_rows(n/2,n-1  ));</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;  B.set_submatrix(n/2,0, I*A.get_rows(0,  n/2-1));</div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;</div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;<span class="comment">//   std::cout &lt;&lt; &quot;En la rutina A=&quot; &lt;&lt; A.get_rows(n/2,n-1) &lt;&lt; std::endl;</span></div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;<span class="comment">//   std::cout &lt;&lt; &quot;En la rutina B=&quot; &lt;&lt; B(0,n/2-1,0,n-1) &lt;&lt; std::endl;</span></div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;  <span class="keywordflow">return</span> B;</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;} <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sigma_label==3) {</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;  B.set_submatrix(0  ,0, A.get_rows(0,n/2-1));</div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;  B.set_submatrix(n/2,0,-A.get_rows(n/2,n-1));</div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;<span class="comment">//   B(n/2,n-1,0,n-1)=-A.get_rows(n/2,n-1); </span></div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;<span class="comment">//   B(0,n/2-1,0,n-1)=A.get_rows(0,n/2-1);</span></div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;  <span class="keywordflow">return</span> B;</div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;} <span class="keywordflow">else</span> {</div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;  std::cerr &lt;&lt; <span class="stringliteral">&quot;sigma_label=&quot;</span> &lt;&lt; sigma_label&lt;&lt;<span class="stringliteral">&quot;, not valid. aborting&quot;</span>&lt;&lt;std::endl;</div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;  abort();</div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;}</div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;</div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;</div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l01571"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#adb060a4f969a3438e286f17a29f642b6"> 1571</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceitppextmath.html#adb060a4f969a3438e286f17a29f642b6">apply_inverse_Rk</a>(itpp::cvec&amp; state, <span class="keywordtype">int</span> <a class="code" href="jquery_8js.html#ab26645c014aa005ecedef329ecf58c99">k</a>, <span class="keywordtype">int</span> position1, <span class="keywordtype">int</span> <a class="code" href="test__spins_8cpp.html#ad38665656d61d491d26c78ce5393a4f2">position2</a>){<span class="comment">// {{{</span></div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;  std::complex&lt;double&gt; phi=exp(-std::complex&lt;double&gt;(0,1)*2.*itpp::pi/<span class="keywordtype">double</span>(<a class="code" href="namespacecfpmath.html#abf5bd8dc5d8af42a850231816e60e95f">cfpmath::pow_2</a>(k)));</div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;  <span class="keywordtype">int</span> mask = <a class="code" href="namespacecfpmath.html#abf5bd8dc5d8af42a850231816e60e95f">cfpmath::pow_2</a>(position1) + <a class="code" href="namespacecfpmath.html#abf5bd8dc5d8af42a850231816e60e95f">cfpmath::pow_2</a>(position2);</div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;  <span class="keywordtype">int</span> n;</div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;state.size()/4; j++){</div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;    n=<a class="code" href="namespacecfpmath.html#a0e87a9ace78d12b29b6219ec271fa11a">cfpmath::merge_two_numbers</a>(3, j, mask); </div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;    state(n)=phi*state(n);</div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;  }</div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;  <span class="keywordflow">return</span>;</div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l01581"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a11134fb2561fe6ea29284218fbf365f9"> 1581</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceitppextmath.html#a11134fb2561fe6ea29284218fbf365f9">apply_swap</a>(itpp::cvec&amp; state, <span class="keywordtype">int</span> position1, <span class="keywordtype">int</span> <a class="code" href="test__spins_8cpp.html#ad38665656d61d491d26c78ce5393a4f2">position2</a>){<span class="comment">// {{{</span></div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;  <span class="keywordtype">int</span> mask = <a class="code" href="namespacecfpmath.html#abf5bd8dc5d8af42a850231816e60e95f">cfpmath::pow_2</a>(position1) + <a class="code" href="namespacecfpmath.html#abf5bd8dc5d8af42a850231816e60e95f">cfpmath::pow_2</a>(position2);</div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;  <span class="keywordtype">int</span> n1, n2;</div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;state.size()/4; j++){</div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;    n1=<a class="code" href="namespacecfpmath.html#a0e87a9ace78d12b29b6219ec271fa11a">cfpmath::merge_two_numbers</a>(2, j, mask); </div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;    n2=<a class="code" href="namespacecfpmath.html#a0e87a9ace78d12b29b6219ec271fa11a">cfpmath::merge_two_numbers</a>(1, j, mask); </div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;    <a class="code" href="namespaceitppextmath.html#a193eafa6d18269893f0419db5a089359">swap</a>(state, n1, n2);</div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;  }</div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;  <span class="keywordflow">return</span>;</div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l01591"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a76daabedbbc57e8fd0d48b52163657be"> 1591</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceitppextmath.html#a76daabedbbc57e8fd0d48b52163657be">apply_cnot</a>(itpp::cvec&amp; state, <span class="keywordtype">int</span> control, <span class="keywordtype">int</span> target){<span class="comment">// {{{</span></div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;  <span class="keywordtype">int</span> mask = <a class="code" href="namespacecfpmath.html#abf5bd8dc5d8af42a850231816e60e95f">cfpmath::pow_2</a>(control) + <a class="code" href="namespacecfpmath.html#abf5bd8dc5d8af42a850231816e60e95f">cfpmath::pow_2</a>(target);</div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;  <span class="keywordtype">int</span> n1, n2;</div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;state.size()/4; j++){</div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;    <span class="keywordflow">if</span>(control &lt; target){</div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;      n1=<a class="code" href="namespacecfpmath.html#a0e87a9ace78d12b29b6219ec271fa11a">cfpmath::merge_two_numbers</a>(1, j, mask); </div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;      n2=<a class="code" href="namespacecfpmath.html#a0e87a9ace78d12b29b6219ec271fa11a">cfpmath::merge_two_numbers</a>(3, j, mask); </div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (control &gt; target) {</div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;      n1=<a class="code" href="namespacecfpmath.html#a0e87a9ace78d12b29b6219ec271fa11a">cfpmath::merge_two_numbers</a>(2, j, mask); </div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;      n2=<a class="code" href="namespacecfpmath.html#a0e87a9ace78d12b29b6219ec271fa11a">cfpmath::merge_two_numbers</a>(3, j, mask); </div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;    }</div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;    <a class="code" href="namespaceitppextmath.html#a193eafa6d18269893f0419db5a089359">swap</a>(state, n1, n2);</div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;  }</div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;  <span class="keywordflow">return</span>;</div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l01606"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a151166d23f2c832ce7df23d15f12dd4f"> 1606</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceitppextmath.html#a151166d23f2c832ce7df23d15f12dd4f">apply_control_u</a>(itpp::cvec&amp; state, <span class="keywordtype">int</span> control, <span class="keywordtype">int</span> target, itpp::cmat&amp; u){<span class="comment">// {{{</span></div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;  <span class="keywordtype">int</span> mask = <a class="code" href="namespacecfpmath.html#abf5bd8dc5d8af42a850231816e60e95f">cfpmath::pow_2</a>(control) + <a class="code" href="namespacecfpmath.html#abf5bd8dc5d8af42a850231816e60e95f">cfpmath::pow_2</a>(target);</div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;  itpp::cvec moco;</div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;<span class="comment">//   int n1, n2;</span></div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;  itpp::ivec pos(2);</div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;state.size()/4; j++){</div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;    <span class="keywordflow">if</span>(control &lt; target){</div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;      pos(0)=<a class="code" href="namespacecfpmath.html#a0e87a9ace78d12b29b6219ec271fa11a">cfpmath::merge_two_numbers</a>(1, j, mask); </div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;      pos(1)=<a class="code" href="namespacecfpmath.html#a0e87a9ace78d12b29b6219ec271fa11a">cfpmath::merge_two_numbers</a>(3, j, mask); </div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (control &gt; target) {</div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;      pos(0)=<a class="code" href="namespacecfpmath.html#a0e87a9ace78d12b29b6219ec271fa11a">cfpmath::merge_two_numbers</a>(2, j, mask); </div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;      pos(1)=<a class="code" href="namespacecfpmath.html#a0e87a9ace78d12b29b6219ec271fa11a">cfpmath::merge_two_numbers</a>(3, j, mask); </div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;    }</div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;    moco=u*state(pos);</div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;2; j++){</div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;      state(pos(j))=moco(j);</div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;    }</div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;  }</div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;  <span class="keywordflow">return</span>;</div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;<span class="comment">// Quantum information functions on states</span></div><div class="line"><a name="l01627"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a91eeb311735ee693e643e3f1189206a1"> 1627</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="namespaceitppextmath.html#a91eeb311735ee693e643e3f1189206a1">InverseParticipationRatio</a>(<span class="keyword">const</span> itpp::cvec&amp; psi){ <span class="comment">// {{{</span></div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;  <span class="keywordtype">double</span> tmp=0.;</div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;psi.size();i++){</div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;    tmp+=std::pow(abs(psi(i)),4);</div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;  }</div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l01635"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a4e3f5074fa29e7a5999d492feeaa846f"> 1635</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="namespaceitppextmath.html#a4e3f5074fa29e7a5999d492feeaa846f">Concurrence</a>(<span class="keyword">const</span> itpp::Mat&lt;std::complex&lt;double&gt;  &gt; rho){ <span class="comment">// {{{</span></div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;    itpp::Mat&lt;std::complex&lt;double&gt; &gt; rho_tilde(4,4);</div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="test__spins_8cpp.html#a3900d1f52906b420113c1d1d8310ea84">i1</a>=0;<a class="code" href="test__spins_8cpp.html#a3900d1f52906b420113c1d1d8310ea84">i1</a>&lt;4;<a class="code" href="test__spins_8cpp.html#a3900d1f52906b420113c1d1d8310ea84">i1</a>++){</div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="test__spins_8cpp.html#a09269322a87977965885dfb82976ef64">i2</a>=0;<a class="code" href="test__spins_8cpp.html#a09269322a87977965885dfb82976ef64">i2</a>&lt;4;<a class="code" href="test__spins_8cpp.html#a09269322a87977965885dfb82976ef64">i2</a>++){</div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;            rho_tilde(<a class="code" href="test__spins_8cpp.html#a3900d1f52906b420113c1d1d8310ea84">i1</a>,<a class="code" href="test__spins_8cpp.html#a09269322a87977965885dfb82976ef64">i2</a>)=conj(rho(3-<a class="code" href="test__spins_8cpp.html#a3900d1f52906b420113c1d1d8310ea84">i1</a>,3-<a class="code" href="test__spins_8cpp.html#a09269322a87977965885dfb82976ef64">i2</a>));</div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;            <span class="keywordflow">if</span>( ((<a class="code" href="namespacecfpmath.html#a6500e09a78acb96aa9644c42d791f7ac">cfpmath::BitCount</a>(<a class="code" href="test__spins_8cpp.html#a3900d1f52906b420113c1d1d8310ea84">i1</a>)+<a class="code" href="namespacecfpmath.html#a6500e09a78acb96aa9644c42d791f7ac">cfpmath::BitCount</a>(<a class="code" href="test__spins_8cpp.html#a09269322a87977965885dfb82976ef64">i2</a>) )%2) == 1){</div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;                rho_tilde(<a class="code" href="test__spins_8cpp.html#a3900d1f52906b420113c1d1d8310ea84">i1</a>,<a class="code" href="test__spins_8cpp.html#a09269322a87977965885dfb82976ef64">i2</a>)=-rho_tilde(<a class="code" href="test__spins_8cpp.html#a3900d1f52906b420113c1d1d8310ea84">i1</a>,<a class="code" href="test__spins_8cpp.html#a09269322a87977965885dfb82976ef64">i2</a>);</div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;            }</div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;        }</div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;    }</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;    rho_tilde=rho*rho_tilde;</div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;    itpp::Vec&lt;double&gt; eigenvalues=real(eig(rho_tilde));</div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;    <span class="keywordflow">if</span> (max(eigenvalues)&lt;0){</div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;        <span class="keywordflow">return</span> 0.;</div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;    }</div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;    <span class="keywordflow">else</span>{</div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;        <span class="keywordflow">return</span> 2*sqrt(max(eigenvalues))-sum(sqrt(abs(eigenvalues)));</div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;    }</div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l01654"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a56519dfcf9ee1818eda9cae11ff0bf32"> 1654</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="namespaceitppextmath.html#a56519dfcf9ee1818eda9cae11ff0bf32">ConcurrenceFromPure</a>(<span class="keyword">const</span> itpp::cvec psi){ <span class="comment">// {{{</span></div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;    <span class="keywordflow">return</span> 2*abs(psi(1)*psi(2)-psi(0)*psi(3));</div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l01657"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#aef230d2cc84f05a6bad47a5c91d95f2d"> 1657</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="namespaceitppextmath.html#aef230d2cc84f05a6bad47a5c91d95f2d">vonNeumann</a>(<span class="keyword">const</span> itpp::vec&amp; lambda){<span class="comment">// {{{</span></div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;    <span class="keywordtype">double</span> tmp=0;</div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;lambda.size(); i++){tmp+=<a class="code" href="namespacecfpmath.html#a584a520f6747d61595c84f3921773ef1">cfpmath::h_function</a>(lambda(i));}</div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;<span class="comment">//  return tmp/log(lambda.size());</span></div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;    <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;}<span class="comment">// }}}</span></div><div class="line"><a name="l01663"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a17666457fcb36ce0c6ac9a264e4d2982"> 1663</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="namespaceitppextmath.html#aef230d2cc84f05a6bad47a5c91d95f2d">vonNeumann</a>(<span class="keyword">const</span> itpp::cmat rho){<span class="comment">// {{{</span></div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;  itpp::Vec&lt;double&gt; eigenvalues=real(eig(rho));</div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespaceitppextmath.html#aef230d2cc84f05a6bad47a5c91d95f2d">vonNeumann</a>(eigenvalues);</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l01667"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#ad3aeb711d30cdab97d60fa479ad75a5b"> 1667</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="namespaceitppextmath.html#ad3aeb711d30cdab97d60fa479ad75a5b">Purity</a>(<span class="keyword">const</span> itpp::Mat&lt;std::complex&lt;double&gt; &gt;&amp; rho){<span class="comment">// {{{</span></div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;    <span class="keywordtype">double</span> P=0;</div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i =0; i&lt; rho.rows(); i++){</div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;        P += abs(itpp::dot (rho.get_col(i),rho.get_row(i)));</div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;    }</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;    <span class="keywordflow">return</span> P;</div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;}<span class="comment">// }}}</span></div><div class="line"><a name="l01674"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a1959ff4d3294776fad466a2147763a6c"> 1674</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="namespaceitppextmath.html#ad3aeb711d30cdab97d60fa479ad75a5b">Purity</a>(<span class="keyword">const</span> itpp::vec&amp; eigenvalues){<span class="comment">// {{{</span></div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;        <span class="keywordflow">return</span> itpp::dot(eigenvalues,eigenvalues);</div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;}<span class="comment">// }}}</span></div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;<span class="comment">// Others</span></div><div class="line"><a name="l01678"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a9a765f05511d21dbd85405855b733c0b"> 1678</a></span>&#160;itpp::mat <a class="code" href="namespaceitppextmath.html#a9a765f05511d21dbd85405855b733c0b">LambdaMatrixQubitRight</a>(itpp::cmat U){ <span class="comment">// {{{ Quantum channel for a single qubit, slow</span></div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;  itpp::mat Lambda(3,3);</div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;  <span class="keywordtype">int</span> n=U.cols();</div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;<span class="comment">//   U = exponentiate(-I*t*H);</span></div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=1; j&lt;=3; j++){</div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="jquery_8js.html#ab26645c014aa005ecedef329ecf58c99">k</a>=1; <a class="code" href="jquery_8js.html#ab26645c014aa005ecedef329ecf58c99">k</a>&lt;=3; <a class="code" href="jquery_8js.html#ab26645c014aa005ecedef329ecf58c99">k</a>++){</div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;      Lambda(j-1,<a class="code" href="jquery_8js.html#ab26645c014aa005ecedef329ecf58c99">k</a>-1)=real(itpp::trace(</div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;            itpp::kron(itpp::eye_c(n/2), <a class="code" href="namespaceitppextmath.html#aba26eee000b8df67356695966d055999">sigma</a>(j))*U*itpp::kron(itpp::eye_c(n/2), <a class="code" href="namespaceitppextmath.html#aba26eee000b8df67356695966d055999">sigma</a>(<a class="code" href="jquery_8js.html#ab26645c014aa005ecedef329ecf58c99">k</a>))*itpp::hermitian_transpose(U)</div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;            ))/n;</div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;    }</div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;  }</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;<span class="comment">//   cout &lt;&lt; Lambda(0,0) &lt;&lt; endl;</span></div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;  <span class="keywordflow">return</span> Lambda; </div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;} <span class="comment">//}}}</span></div><div class="line"><a name="l01692"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a2957cbd7ea32e1ddf2991b255efeba46"> 1692</a></span>&#160;itpp::mat <a class="code" href="namespaceitppextmath.html#a2957cbd7ea32e1ddf2991b255efeba46">LambdaMatrixQubitLeft</a>(itpp::cmat U){ <span class="comment">// {{{ Quantum channel for a single qubit, slow</span></div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;  itpp::mat Lambda(3,3);</div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;  <span class="keywordtype">int</span> n=U.cols();</div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;<span class="comment">//   U = exponentiate(-I*t*H);</span></div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=1; j&lt;=3; j++){</div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="jquery_8js.html#ab26645c014aa005ecedef329ecf58c99">k</a>=1; <a class="code" href="jquery_8js.html#ab26645c014aa005ecedef329ecf58c99">k</a>&lt;=3; <a class="code" href="jquery_8js.html#ab26645c014aa005ecedef329ecf58c99">k</a>++){</div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;      Lambda(j-1,<a class="code" href="jquery_8js.html#ab26645c014aa005ecedef329ecf58c99">k</a>-1)=real(itpp::trace(</div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;            itpp::kron(<a class="code" href="namespaceitppextmath.html#aba26eee000b8df67356695966d055999">sigma</a>(j),itpp::eye_c(n/2))*U*itpp::kron(<a class="code" href="namespaceitppextmath.html#aba26eee000b8df67356695966d055999">sigma</a>(<a class="code" href="jquery_8js.html#ab26645c014aa005ecedef329ecf58c99">k</a>),itpp::eye_c(n/2))*itpp::hermitian_transpose(U)</div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;            ))/n;</div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;    }</div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;  }</div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;<span class="comment">//   cout &lt;&lt; Lambda(0,0) &lt;&lt; endl;</span></div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;  <span class="keywordflow">return</span> Lambda; </div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;} <span class="comment">//}}}</span></div><div class="line"><a name="l01706"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a3a70679d48264228dd0dd01a2ee50eb5"> 1706</a></span>&#160;itpp::mat <a class="code" href="namespaceitppextmath.html#a2957cbd7ea32e1ddf2991b255efeba46">LambdaMatrixQubitLeft</a>(itpp::cmat H, <span class="keywordtype">double</span> t){ <span class="comment">// {{{ Quantum channel for a single qubit, slow</span></div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;  itpp::cmat W, U;</div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;  std::complex&lt;double&gt; I(0.,1.);</div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;  U = <a class="code" href="namespaceitppextmath.html#af0b1e30122a83066769ccf797e2a8a57">exponentiate</a>(-I*t*H);</div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespaceitppextmath.html#a2957cbd7ea32e1ddf2991b255efeba46">LambdaMatrixQubitLeft</a>(U);</div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;} <span class="comment">//}}}</span></div><div class="line"><a name="l01712"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a426cfd0589a99f4332cac07ce8422e48"> 1712</a></span>&#160;itpp::mat <a class="code" href="namespaceitppextmath.html#a2957cbd7ea32e1ddf2991b255efeba46">LambdaMatrixQubitLeft</a>(itpp::cmat W, itpp::vec E, <span class="keywordtype">double</span> t){ <span class="comment">// {{{Quantum channel for a single qubit, eigenphases &amp; Eigenenergies</span></div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;  std::complex&lt;double&gt; I(0.,1.);</div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;  itpp::cmat U_dagger=<a class="code" href="namespaceitppextmath.html#a675965a2ef652e3bca87e74a0946b343">UDiagUdagger</a>(W, exp(-I*t*E));</div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;  itpp::cmat U=hermitian_transpose(U_dagger);</div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;<span class="comment">//   std::cout &lt;&lt; U &lt;&lt; std::endl;</span></div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;  itpp::Array&lt;itpp::cmat&gt; sigmaU(3), sigmaUdagger(3);</div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=1; j&lt;=3; j++){</div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;    sigmaU(j-1)      =<a class="code" href="namespaceitppextmath.html#a1b13aed0cbfe9879b304f139ee2c5565">multiply_by_sigma_leftmost_qubit</a>(U,j);</div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;    sigmaUdagger(j-1)=<a class="code" href="namespaceitppextmath.html#a1b13aed0cbfe9879b304f139ee2c5565">multiply_by_sigma_leftmost_qubit</a>(U_dagger,j);</div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;  }</div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;  itpp::mat Lambda(3,3);</div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;  <span class="keywordtype">int</span> n=E.length();</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=1; j&lt;=3; j++){</div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="jquery_8js.html#ab26645c014aa005ecedef329ecf58c99">k</a>=1; <a class="code" href="jquery_8js.html#ab26645c014aa005ecedef329ecf58c99">k</a>&lt;=3; <a class="code" href="jquery_8js.html#ab26645c014aa005ecedef329ecf58c99">k</a>++){</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;      Lambda(j-1,<a class="code" href="jquery_8js.html#ab26645c014aa005ecedef329ecf58c99">k</a>-1)=real(<a class="code" href="namespaceitppextmath.html#ad369a86d5a4ee2ad4f4006be7ae95596">trAB</a>(sigmaU(j-1),sigmaUdagger(<a class="code" href="jquery_8js.html#ab26645c014aa005ecedef329ecf58c99">k</a>-1)))/n;</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;    }</div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;  }</div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;<span class="comment">//   cout &lt;&lt; Lambda(0,0) &lt;&lt; endl;</span></div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;  <span class="keywordflow">return</span> Lambda; </div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;} <span class="comment">//}}}</span></div><div class="line"><a name="l01732"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#ae0acdad1591e836b69c3db7335b4880b"> 1732</a></span>&#160;itpp::Array&lt;itpp::cvec&gt; <a class="code" href="namespaceitppextmath.html#ae0acdad1591e836b69c3db7335b4880b">PrepareInitialStatesForSingleQubitTomography</a>(){ <span class="comment">//{{{</span></div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;</div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;    itpp::Array&lt;itpp::cvec&gt; InitialStates(4);</div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;    InitialStates(0)=itpp::to_cvec(itpp::vec_2(1.,0.)); <span class="comment">//|0&gt;</span></div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;    InitialStates(1)=itpp::to_cvec(itpp::vec_2(0,1)); <span class="comment">//|1&gt;</span></div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;    InitialStates(2)=itpp::to_cvec(itpp::vec_2(1,1))/sqrt(2); <span class="comment">// |x+&gt;=(|0&gt;+|1&gt;)/sqrt(2) </span></div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;    InitialStates(3)=itpp::vec_2(std::complex&lt;double&gt;(1.,0.),std::complex&lt;double&gt;(0.,1.))/sqrt(2); <span class="comment">// |y+&gt;=(|0&gt;+i|1&gt;)/sqrt(2)</span></div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;    <span class="keywordflow">return</span> InitialStates; </div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l01741"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a32239cc4ac99e886a2d64c42a8fe481c"> 1741</a></span>&#160;itpp::mat <a class="code" href="namespaceitppextmath.html#a32239cc4ac99e886a2d64c42a8fe481c">TomographySingleQubit</a>(itpp::Array&lt;itpp::cmat&gt;&amp; rhos_f){ <span class="comment">// {{{</span></div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;  <span class="comment">// The idea is to get lambda. We must first get the vector form</span></div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;  <span class="comment">// of each guy.</span></div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;  itpp::Array&lt;itpp::cvec&gt; rhos_vectors(4);</div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;4; i++){</div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;    rhos_vectors(i)=<a class="code" href="namespaceitppextmath.html#a6b144c204bc6ad381195bcd1b43c9eba">OperatorToVectorPauliBasis</a>(rhos_f(i));</div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;  }</div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;  itpp::mat Lambda(4,4);</div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;  Lambda=0.;</div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;  Lambda(0,0)=1;</div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;  Lambda.set_col(0, real(rhos_vectors(0)+rhos_vectors(1))/2); <span class="comment">// Lambda_i0 = (r^f_1 + r^f_2)/2</span></div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;  Lambda.set_col(3, real(rhos_vectors(0)-rhos_vectors(1))/2); <span class="comment">// Lambda_i3 = (r^f_1 - r^f_2)/2</span></div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;  Lambda.set_col(1, real(rhos_vectors(2))-Lambda.get_col(0));  <span class="comment">// Lambda_i1 = (r^f_1 - r^f_2)/2</span></div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;  Lambda.set_col(2, real(rhos_vectors(3))-Lambda.get_col(0));  <span class="comment">// Lambda_i2 = (r^f_1 - r^f_2)/2</span></div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;</div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;  <span class="keywordflow">return</span> Lambda;</div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;</div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l01759"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a6b144c204bc6ad381195bcd1b43c9eba"> 1759</a></span>&#160;itpp::cvec <a class="code" href="namespaceitppextmath.html#a6b144c204bc6ad381195bcd1b43c9eba">OperatorToVectorPauliBasis</a>(itpp::cmat rho){ <span class="comment">// {{{</span></div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;  itpp::cvec r(4);</div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;4; i++){</div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;    r(i)=itpp::trace(<a class="code" href="namespaceitppextmath.html#aba26eee000b8df67356695966d055999">sigma</a>(i)*rho);</div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;  }</div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;  <span class="keywordflow">return</span> r;</div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;<span class="comment">// }}}</span></div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;<span class="comment">// Quantum Evolution {{{</span></div><div class="line"><a name="l01768"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a237ae1a42d8b29d71d473e6de252d9ea"> 1768</a></span>&#160;itpp::cvec <a class="code" href="namespaceitppextmath.html#a237ae1a42d8b29d71d473e6de252d9ea">GetState</a>(itpp::cmat&amp; U, itpp::vec&amp; eigenvalues, itpp::cvec&amp; psi_0, <span class="keywordtype">double</span> t){ <span class="comment">// {{{</span></div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;  itpp::cmat U_dagger = itpp::hermitian_transpose(U);</div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;  itpp::cvec psi_0_prime = U_dagger*psi_0;</div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;  itpp::cvec psi_t_prime = itpp::elem_mult(exp(-eigenvalues * t * std::complex&lt;double&gt;(0.,1.)),psi_0_prime);</div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;  itpp::cvec psi_t = U* psi_t_prime;</div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;</div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;  <span class="comment">//   cout &lt;&lt; &quot;In GetState, test_unitarity(U)=&quot; &lt;&lt;  test_unitarity(U) &lt;&lt; endl;</span></div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;  <span class="comment">//   cout &lt;&lt; &quot;In GetState, test_unitarity(U_dagger)=&quot; &lt;&lt;  test_unitarity(U_dagger) &lt;&lt; endl;</span></div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;  <span class="comment">//   cout &lt;&lt; &quot;In GetState, norm(psi_0)=&quot; &lt;&lt;  norm(psi_0) &lt;&lt; endl;</span></div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;  <span class="comment">//   cout &lt;&lt; &quot;In GetState, norm(psi_0_prime)=&quot; &lt;&lt;  norm(psi_0_prime) &lt;&lt; endl;</span></div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;  <span class="comment">//   cout &lt;&lt; &quot;In GetState, norm(psi_t)=&quot; &lt;&lt;  norm(psi_t) &lt;&lt; endl;</span></div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;  <span class="comment">//   abort(); </span></div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;  <span class="keywordflow">return</span> psi_t;</div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;</div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l01783"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#ab725876e76acc973ccbde0ca3c4c3809"> 1783</a></span>&#160;itpp::cmat <a class="code" href="namespaceitppextmath.html#a237ae1a42d8b29d71d473e6de252d9ea">GetState</a>(itpp::cmat&amp; U, itpp::vec&amp; eigenvalues, itpp::cvec&amp; psi_0, <span class="keywordtype">double</span> t, <span class="keywordtype">int</span> dimension_central_system){ <span class="comment">// {{{</span></div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;  <span class="keywordtype">int</span> d=eigenvalues.size();</div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;  <span class="keywordflow">if</span> ( U.cols()!= d || U.rows()!= d || psi_0.size() != d){</div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;    std::cerr &lt;&lt; <span class="stringliteral">&quot;Error en GetState (for mixed)\n&quot;</span> </div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;U.cols()=&quot;</span> &lt;&lt; U.cols() &lt;&lt; <span class="stringliteral">&quot;, U.rows()=&quot;</span> &lt;&lt; U.rows() </div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;, eigenvalues.size()=&quot;</span>&lt;&lt; eigenvalues.size() &lt;&lt; <span class="stringliteral">&quot;, psi_0.size()=&quot;</span> &lt;&lt; psi_0.size() </div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;      &lt;&lt; std::endl;</div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;    abort();</div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;  }</div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;</div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;  itpp::cvec tmp=<a class="code" href="namespaceitppextmath.html#a237ae1a42d8b29d71d473e6de252d9ea">GetState</a>(U, eigenvalues, psi_0,t);</div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;  itpp::cmat tmp_r = <a class="code" href="namespaceitppextmath.html#a5eba978dfe35f1f0bde18022126e5872">partial_trace</a>(tmp, dimension_central_system);</div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespaceitppextmath.html#a5eba978dfe35f1f0bde18022126e5872">partial_trace</a>(<a class="code" href="namespaceitppextmath.html#a237ae1a42d8b29d71d473e6de252d9ea">GetState</a>(U, eigenvalues, psi_0,t), dimension_central_system);</div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;<span class="comment">//  }}}</span></div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;<span class="comment">// Testing {{{</span></div><div class="line"><a name="l01799"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a16056fce786f8680434907f52f86c4d5"> 1799</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt;  <span class="keywordtype">double</span> <a class="code" href="namespaceitppextmath.html#a16056fce786f8680434907f52f86c4d5">test_symmetry</a>(<span class="keyword">const</span> itpp::Mat&lt;Num_T &gt; H){ <span class="comment">// {{{</span></div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160; <span class="keywordflow">return</span> itpp::norm(H-H.transpose() );</div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l01802"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a38e9b44c58de6e5fdd72095f905f9fc7"> 1802</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt;  <span class="keywordtype">bool</span> <a class="code" href="namespaceitppextmath.html#a38e9b44c58de6e5fdd72095f905f9fc7">sorted</a>(<span class="keyword">const</span> itpp::Vec&lt;Num_T &gt; v){ <span class="comment">// {{{ Test if it is sorted, from smallest to greatest</span></div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;  <span class="keywordtype">int</span> n=v.size();</div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;  <span class="keywordflow">if</span> (n==0){<span class="keywordflow">return</span> <span class="keyword">true</span>;}</div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=1; i&lt;n; i++){</div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;    <span class="keywordflow">if</span>(v(i)&lt;v(i-1)) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;  }</div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l01810"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#abcdaea5c0bfa66e3ce8801ff8ef1c2b0"> 1810</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceitppextmath.html#abcdaea5c0bfa66e3ce8801ff8ef1c2b0">test_GetState_pure</a>(){ <span class="comment">// {{{</span></div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;<span class="comment">//   So the idea is to have a Hamiltonian, its eigenvectors and eigenvalues, </span></div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;<span class="comment">//   time and check if the evolution is good. </span></div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;In test_GetState&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;  <span class="keywordtype">int</span> dim=50;</div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;  <span class="keywordtype">double</span> t=itpp::randu();</div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;<span class="comment">//   t=1.;</span></div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;<span class="comment">//   t=itpp::pi/2;</span></div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;  std::complex&lt;double&gt; I(0,1);</div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;  itpp::cmat H, eigenvectors, eih;</div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;  itpp::cvec psi_0, psi_slow, psi_fast;</div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;  itpp::vec lambda;</div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;</div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;  H=itpp::randn_c(dim,dim); H=H+H.hermitian_transpose();</div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;<span class="comment">//   H(0,0)=0.; H(1,1)=0.; H(0,1)=0.+1.*I; H(1,0)=std::conj(H(0,1));</span></div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;<span class="comment">//   H(0,1)=2.;</span></div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;<span class="comment">//   H(1,0)=2.;</span></div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;  psi_0=itpp::randn_c(dim); psi_0=psi_0/norm(psi_0);</div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;<span class="comment">//   psi_0=0.; psi_0(0)=1.;</span></div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;  eih=<a class="code" href="namespaceitppextmath.html#af0b1e30122a83066769ccf797e2a8a57">exponentiate</a>(-I*t*H);</div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;<span class="comment">//   std::cout &lt;&lt; &quot;H=&quot; &lt;&lt; H &lt;&lt; std::endl &lt;&lt; &quot;eih=&quot; &lt;&lt; eih &lt;&lt; std::endl;</span></div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;  psi_slow = <a class="code" href="namespaceitppextmath.html#af0b1e30122a83066769ccf797e2a8a57">exponentiate</a>(-I*t*H)*psi_0;</div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;  eig_sym(H,lambda, eigenvectors);</div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;  psi_fast = <a class="code" href="namespaceitppextmath.html#a237ae1a42d8b29d71d473e6de252d9ea">GetState</a>(eigenvectors, lambda, psi_0, t);</div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;1-Producto interior=&quot;</span> </div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;    &lt;&lt; 1.-itpp::dot(conj(psi_fast), psi_fast) &lt;&lt; std::endl;</div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;<span class="comment">//   std::cout &lt;&lt; psi_slow &lt;&lt; std::endl&lt;&lt; psi_fast &lt;&lt; std::endl;</span></div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;</div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;  abort();</div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;  <span class="keywordflow">return</span>;</div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;<span class="comment">//  return itpp::norm(H-H.transpose() );</span></div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l01842"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#ac364f5f204bb63b79ff6e7072c5e4233"> 1842</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceitppextmath.html#ac364f5f204bb63b79ff6e7072c5e4233">test_GetState_mixed</a>(){ <span class="comment">// {{{</span></div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;<span class="comment">//   So the idea is to have a Hamiltonian, its eigenvectors and eigenvalues, </span></div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;<span class="comment">//   time and check if the evolution is good. </span></div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;<span class="comment">//   std::cout &lt;&lt; &quot;In test_GetState_mixed&quot; &lt;&lt; std::endl;</span></div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;  <span class="keywordtype">int</span> dim_a=5, dim_b=2;</div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;  <span class="keywordtype">int</span> dim=dim_a*dim_b;</div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;  <span class="keywordtype">double</span> t=itpp::randu();</div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;<span class="comment">//   t=itpp::pi/2;</span></div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;  std::complex&lt;double&gt; I(0,1);</div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;  itpp::cmat H, eigenvectors, eih, rho_fast;</div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;  itpp::cvec psi_0, psi_slow, psi_fast;</div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;  itpp::vec lambda;</div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;</div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;  H=itpp::randn_c(dim,dim); H=H+H.hermitian_transpose();</div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;<span class="comment">//   H(0,0)=0.; H(1,1)=0.; H(0,1)=0.+1.*I; H(1,0)=std::conj(H(0,1));</span></div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;<span class="comment">//   H(0,1)=2.;</span></div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;<span class="comment">//   H(1,0)=2.;</span></div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;  psi_0=itpp::randn_c(dim); psi_0=psi_0/norm(psi_0);</div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;<span class="comment">//   psi_0=0.; psi_0(0)=1.;</span></div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;<span class="comment">//   eih=exponentiate(-I*t*H);</span></div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;<span class="comment">//   std::cout &lt;&lt; &quot;H=&quot; &lt;&lt; H &lt;&lt; std::endl &lt;&lt; &quot;eih=&quot; &lt;&lt; eih &lt;&lt; std::endl;</span></div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;<span class="comment">//   psi_slow = exponentiate(-I*t*H)*psi_0;</span></div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;  eig_sym(H,lambda, eigenvectors);</div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;<span class="comment">//   psi_fast = GetState(eigenvectors, lambda, psi_0, t);</span></div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;  rho_fast = <a class="code" href="namespaceitppextmath.html#a237ae1a42d8b29d71d473e6de252d9ea">GetState</a>(eigenvectors, lambda, psi_0, t, dim_a);</div><div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;<span class="comment">//   std::cout &lt;&lt; &quot;tr rho=&quot; &lt;&lt; itpp::trace(rho_fast) &lt;&lt; std::endl;</span></div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;<span class="comment">//   std::cout &lt;&lt; psi_slow &lt;&lt; std::endl&lt;&lt; psi_fast &lt;&lt; std::endl;</span></div><div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;</div><div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;<span class="comment">//   abort();</span></div><div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;  <span class="keywordflow">return</span>;</div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;<span class="comment">//  return itpp::norm(H-H.transpose() );</span></div><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l01874"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a3e4e11cf0eb431f4a70cbe83efb8ec2e"> 1874</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="namespaceitppextmath.html#a3e4e11cf0eb431f4a70cbe83efb8ec2e">test_reality</a>(<span class="keyword">const</span> itpp::cmat&amp; H){ <span class="comment">// {{{</span></div><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160; <span class="keywordflow">return</span> itpp::norm(itpp::imag(H)); </div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l01877"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#adb8774c97d655de71f3bf73fd3fc4103"> 1877</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="namespaceitppextmath.html#adb8774c97d655de71f3bf73fd3fc4103">test_real_symmetric</a>(<span class="keyword">const</span> itpp::cmat H){ <span class="comment">// {{{</span></div><div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160; <span class="keywordflow">return</span> <a class="code" href="namespaceitppextmath.html#a16056fce786f8680434907f52f86c4d5">test_symmetry</a>(H) + <a class="code" href="namespaceitppextmath.html#a3e4e11cf0eb431f4a70cbe83efb8ec2e">test_reality</a>(H);</div><div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l01880"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#aaf02e6e0f0ccfe846b7dcc1641be4df3"> 1880</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="namespaceitppextmath.html#aaf02e6e0f0ccfe846b7dcc1641be4df3">test_unit_matrix</a>(<span class="keyword">const</span> itpp::cmat U){ <span class="comment">// {{{</span></div><div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;  <span class="keywordflow">if</span> (U.cols() != U.rows()){</div><div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;La matriz no es cuadrada\n&quot;</span>;</div><div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;    abort();</div><div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;  }</div><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160; <span class="keywordflow">return</span> itpp::norm(U - itpp::eye_c(U.rows() )); </div><div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l01888"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#aec6e270e26d591a2e1133ca16d4ac80f"> 1888</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="namespaceitppextmath.html#aec6e270e26d591a2e1133ca16d4ac80f">test_unitarity</a>(<span class="keyword">const</span> itpp::cmat U){ <span class="comment">// {{{</span></div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;  <span class="keywordflow">if</span> (U.cols() != U.rows()){</div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;La matriz no es cuadrada\n&quot;</span>;</div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;    abort();</div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;  }</div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160; <span class="keywordflow">return</span> itpp::norm(U*U.hermitian_transpose() - itpp::eye_c(U.rows() ))</div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;          + itpp::norm(U.hermitian_transpose()*U - itpp::eye_c(U.rows() )); </div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l01897"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#aea2c2fe8d93ac3b804a1543344bfad33"> 1897</a></span>&#160;<span class="keywordtype">void</span>  <a class="code" href="namespaceitppextmath.html#aea2c2fe8d93ac3b804a1543344bfad33">test_multiply_by_sigma_leftmost_qubit</a>(){ <span class="comment">// {{{</span></div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;  <span class="keywordtype">int</span> q=4;</div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;  <span class="keywordtype">int</span> n=<a class="code" href="namespacecfpmath.html#abf5bd8dc5d8af42a850231816e60e95f">cfpmath::pow_2</a>(q);</div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;<span class="comment">//   n=30;</span></div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;  itpp::cmat test_matrix;</div><div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;  itpp::Array&lt;itpp::cmat&gt; test_matrix_results(4);</div><div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;  itpp::Array&lt;itpp::cmat&gt; test_matrix_results_long(4);</div><div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;  itpp::randn_c (n, n, test_matrix);</div><div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;  <span class="keywordtype">double</span> error=0.;</div><div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i =0; i&lt;4; i++){</div><div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;    test_matrix_results(i)=<a class="code" href="namespaceitppextmath.html#a1b13aed0cbfe9879b304f139ee2c5565">multiply_by_sigma_leftmost_qubit</a>(test_matrix,i);</div><div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;  }</div><div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;  test_matrix_results_long(0)=test_matrix;</div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;  test_matrix_results_long(1)=<a class="code" href="namespaceitppextmath.html#aba26eee000b8df67356695966d055999">sigma</a>(itpp::vec(<span class="stringliteral">&quot;1 0 0&quot;</span>),q-1,q)*test_matrix;</div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;  test_matrix_results_long(2)=<a class="code" href="namespaceitppextmath.html#aba26eee000b8df67356695966d055999">sigma</a>(itpp::vec(<span class="stringliteral">&quot;0 1 0&quot;</span>),q-1,q)*test_matrix;</div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;  test_matrix_results_long(3)=<a class="code" href="namespaceitppextmath.html#aba26eee000b8df67356695966d055999">sigma</a>(itpp::vec(<span class="stringliteral">&quot;0 0 1&quot;</span>),q-1,q)*test_matrix;</div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;<span class="comment">//   std::cout &lt;&lt; &quot;test_matrix_results_long:&quot; &lt;&lt; std::endl &lt;&lt; test_matrix_results_long(2) &lt;&lt; std::endl;</span></div><div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;<span class="comment">//   std::cout &lt;&lt; &quot;test_matrix_results:&quot; &lt;&lt; std::endl &lt;&lt; test_matrix_results(2) &lt;&lt; std::endl;</span></div><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;<span class="comment">//   std::cout &lt;&lt; &quot;Carga y control 10&quot; &lt;&lt; std::endl;</span></div><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i =0; i&lt;4; i++){</div><div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;<span class="comment">//     std::cout &lt;&lt; &quot;Carga y control i=&quot; &lt;&lt; i &lt;&lt; &quot;, error acumulado=&quot; &lt;&lt; error &lt;&lt;  std::endl;</span></div><div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;<span class="comment">//     std::cout &lt;&lt; test_matrix_results(i) &lt;&lt; std::endl;</span></div><div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;    error+=norm(test_matrix_results(i)-test_matrix_results_long(i));</div><div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;  }</div><div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;Error in multiply_by_sigma_leftmost_qubit: &quot;</span> &lt;&lt; error&lt;&lt; std::endl;</div><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;  <span class="keywordflow">return</span>;</div><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l01924"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a6e10ce87347da5fabd873a19305265e3"> 1924</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceitppextmath.html#a6e10ce87347da5fabd873a19305265e3">test_UDiagUdagger</a>(){ <span class="comment">// {{{</span></div><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;  <span class="keywordtype">int</span> n=5;</div><div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;  itpp::cmat U; itpp::randn_c(n, n, U);</div><div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;  itpp::cvec e; itpp::randn_c(n, e);</div><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;  itpp::cmat W1 = <a class="code" href="namespaceitppextmath.html#a675965a2ef652e3bca87e74a0946b343">UDiagUdagger</a>(U, e);</div><div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;  itpp::cmat W2 = U*diag(e)*hermitian_transpose(U);</div><div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;error en uno y otro metodo=&quot;</span> &lt;&lt; norm(W1-W2) &lt;&lt; std::endl;</div><div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;  <span class="keywordflow">return</span>;</div><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l01933"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a12cc69b2d32ae7f1b52df931f8423da4"> 1933</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceitppextmath.html#a12cc69b2d32ae7f1b52df931f8423da4">test_trAB</a>(){ <span class="comment">// {{{</span></div><div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;  std::complex&lt;double&gt; r1, r2;</div><div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;  <span class="keywordtype">int</span> n1=15, n2=8;</div><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;  itpp::cmat A, B; itpp::randn_c(n1, n2, A);itpp::randn_c(n2, n1, B);</div><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;</div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;<span class="comment">//   B=1;  </span></div><div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;<span class="comment">//   A=3;  </span></div><div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;  r1 = <a class="code" href="namespaceitppextmath.html#ad369a86d5a4ee2ad4f4006be7ae95596">trAB</a>(A, B);</div><div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;  r2 = itpp::trace(A*B);</div><div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;<span class="comment">//   std::cout &lt;&lt; &quot;Test result A*B &quot; &lt;&lt; A*B &lt;&lt; std::endl;</span></div><div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;<span class="comment">//   std::cout &lt;&lt; &quot;Test result &quot; &lt;&lt; r1 &lt;&lt; &quot;, &quot; &lt;&lt;  r2 &lt;&lt; std::endl;</span></div><div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;Test result &quot;</span> &lt;&lt; abs(r1-r2) &lt;&lt; std::endl;</div><div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;<span class="comment">//  }}}</span></div><div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;<span class="comment">// Not yet ordered {{{</span></div><div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;</div><div class="line"><a name="l01949"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a98fa71ea9c89981016ed20498aade3a8"> 1949</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; itpp::Mat&lt;Num_T &gt; <a class="code" href="namespaceitppextmath.html#a98fa71ea9c89981016ed20498aade3a8">Array_to_Matrix</a>(<span class="keyword">const</span> itpp::Array&lt;itpp::Vec&lt;Num_T &gt; &gt;&amp; v){ <span class="comment">// {{{</span></div><div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;<span class="comment">//   std::cout &lt;&lt; &quot;Lo que entra:&quot; &lt;&lt; v &lt;&lt; std::endl;</span></div><div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;  <span class="keywordtype">int</span> n = v.length();</div><div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;  itpp::Mat&lt;Num_T &gt; tmp(n, v(0).size());</div><div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;n; i++){ </div><div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;    tmp.set_row(i,v(i));</div><div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;  }</div><div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;} <span class="comment">//}}}</span></div><div class="line"><a name="l01958"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#afe7ec9cbea296802fdc91317bc679452"> 1958</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; itpp::Array&lt;itpp::Vec&lt;Num_T&gt; &gt; <a class="code" href="namespaceitppextmath.html#afe7ec9cbea296802fdc91317bc679452">Matrix_to_Array</a>(<span class="keyword">const</span> itpp::Mat&lt;Num_T &gt;&amp; v){ <span class="comment">// {{{</span></div><div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;  <span class="keywordtype">int</span> n = v.rows();</div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;  itpp::Array&lt;itpp::Vec&lt;Num_T&gt; &gt; tmp(n);</div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;n; i++){ </div><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;    tmp(i) = v.get_row(i);</div><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;  }</div><div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;} <span class="comment">//}}}</span></div><div class="line"><a name="l01966"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a6f77ba21eefa0948681d3ca8e9166a6e"> 1966</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; itpp::Vec&lt;Num_T &gt; <a class="code" href="namespaceitppextmath.html#a6f77ba21eefa0948681d3ca8e9166a6e">my_mod</a>(<span class="keyword">const</span> itpp::Vec&lt;Num_T &gt;&amp; v){ <span class="comment">// {{{</span></div><div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;itpp::Vec&lt;Num_T &gt; tmp(v.size());</div><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;v.size(); i++){ </div><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;    tmp(i) = <a class="code" href="namespacecfpmath.html#a6cba567d2bb25f561d3c649d578bc0cf">cfpmath::my_mod</a>(v(i));</div><div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;  }</div><div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;} <span class="comment">//}}}</span></div><div class="line"><a name="l01973"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#aeb33513667ad7af93834093a3fd46c86"> 1973</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; itpp::Array&lt;Num_T &gt; <a class="code" href="namespaceitppextmath.html#a6f77ba21eefa0948681d3ca8e9166a6e">my_mod</a>(<span class="keyword">const</span> itpp::Array&lt;Num_T &gt;&amp; v){ <span class="comment">// {{{</span></div><div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;itpp::Array&lt;Num_T &gt; tmp(v.size());</div><div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;v.size(); i++){ </div><div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;    tmp(i) = <a class="code" href="namespacecfpmath.html#a6cba567d2bb25f561d3c649d578bc0cf">cfpmath::my_mod</a>(v(i));</div><div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;  }</div><div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;} <span class="comment">//}}}</span></div><div class="line"><a name="l01980"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#ae3604664b2498af7926093b3bc96b142"> 1980</a></span>&#160;itpp::cvec <a class="code" href="namespaceitppextmath.html#ae3604664b2498af7926093b3bc96b142">read_state</a>(<span class="keywordtype">int</span> d){ <span class="comment">// {{{</span></div><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;  itpp::cvec psi(d);</div><div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;  <span class="keywordtype">double</span> x,y;</div><div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;d; j++){</div><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;    std::cin &gt;&gt; x  &gt;&gt; y ;</div><div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;    psi(j)=x+std::complex&lt;double&gt;(0,1)*y;</div><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;  }</div><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;  <span class="keywordflow">return</span> psi;</div><div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l01989"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a3c5e7754b2bf3687684855e161145ac7"> 1989</a></span>&#160;itpp::Vec&lt;std::string&gt; <a class="code" href="namespaceitppextmath.html#a3c5e7754b2bf3687684855e161145ac7">split_string</a>(std::string sentence){<span class="comment">// {{{</span></div><div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;  <span class="comment">// http://stackoverflow.com/questions/236129/c-how-to-split-a-string</span></div><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;  std::string word;</div><div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;  std::istringstream iss(sentence);</div><div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;  <span class="keywordtype">int</span> number_words=0;</div><div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;  <span class="keywordflow">while</span>( iss &gt;&gt; word ){number_words++;}</div><div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;  itpp::Vec&lt;std::string&gt; splitted(number_words);</div><div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;  number_words=0;</div><div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;  std::istringstream iss2(sentence);</div><div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;<span class="comment">//   iss(sentence); </span></div><div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;  <span class="keywordflow">while</span>( iss2 &gt;&gt; word ){splitted(number_words)=word; number_words++;}</div><div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;  <span class="keywordflow">return</span> splitted; </div><div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;}<span class="comment">// }}}</span></div><div class="line"><a name="l02002"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#ab9a2a0e51d9c4b6ed4a66f8003ca2a7c"> 2002</a></span>&#160;itpp::Mat&lt;std::complex&lt;double&gt; &gt; <a class="code" href="namespaceitppextmath.html#ab9a2a0e51d9c4b6ed4a66f8003ca2a7c">Hermitian_From_Compact</a>(<span class="keyword">const</span> itpp::vec&amp; compact_rho){<span class="comment">// {{{</span></div><div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;    <span class="keywordtype">int</span> dim=<a class="code" href="namespacecfpmath.html#aea8886520bdf0d732569e0b9873bc69f">cfpmath::isqrt</a>(compact_rho.size()), counter=0;</div><div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;    itpp::Mat&lt;std::complex&lt;double&gt;  &gt; tmp(dim,dim);</div><div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;dim;i++){</div><div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;        tmp(i,i)=compact_rho(counter); counter++;</div><div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=i+1;j&lt;dim;j++){</div><div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;<span class="comment">//          tmp(i,j)=compact_rho(counter)+compact_rho(counter+1);</span></div><div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;            tmp(i,j)=std::complex&lt;double&gt;(compact_rho(counter),compact_rho(counter+1));</div><div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;            tmp(j,i)=conj(tmp(i,j));counter+=2;</div><div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;        }</div><div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;    }</div><div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;    <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;}<span class="comment">// }}}</span></div><div class="line"><a name="l02015"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#a6c557215e9887ded17c2155bbf4762b5"> 2015</a></span>&#160;itpp::Array&lt; itpp::ivec &gt; <a class="code" href="namespaceitppextmath.html#a6c557215e9887ded17c2155bbf4762b5">LinSpace</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> i_i, <span class="keyword">const</span> <span class="keywordtype">int</span> i_f, <span class="keyword">const</span> <span class="keywordtype">int</span> step=1){<span class="comment">// {{{</span></div><div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;  <span class="keywordtype">int</span> index=0;</div><div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;  itpp::Array&lt; itpp::ivec &gt; tmp((i_f-i_i)/step + 1);</div><div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=i_i; i&lt;= i_f; i+=step){</div><div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;<span class="comment">//     std::cerr &lt;&lt; &quot;Creating the index &quot; &lt;&lt; index &lt;&lt; &quot;  with value &quot; &lt;&lt; i &lt;&lt; &quot;\n&quot;;</span></div><div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;    tmp(index)=itpp::vec_1(i);</div><div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;    index++;</div><div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;  }</div><div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;<span class="comment">//   std::cerr &lt;&lt; tmp  &lt;&lt; &quot; es este\n&quot;;</span></div><div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;}<span class="comment">// }}}</span></div><div class="line"><a name="l02026"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#ab20cb428322021acd9e79ea1c861809e"> 2026</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Num_T&gt; itpp::ivec <a class="code" href="namespaceitppextmath.html#ab20cb428322021acd9e79ea1c861809e">waist</a>(<span class="keyword">const</span> itpp::Array&lt;Num_T &gt;&amp; A){<span class="comment">// {{{</span></div><div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;  itpp::ivec tmp(A.size());</div><div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i&lt; A.size(); i++){</div><div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;    tmp(i) = A(i).size();</div><div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;  }</div><div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;  <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;}<span class="comment">// }}}</span></div><div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;<span class="comment">// }}}</span></div><div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;<span class="comment">// Pretty printing {{{</span></div><div class="line"><a name="l02035"></a><span class="lineno"><a class="line" href="namespaceitppextmath.html#ac78908c186d54e62779e44c71bbbc027"> 2035</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceitppextmath.html#ac78908c186d54e62779e44c71bbbc027">pretty_printing_1</a>(itpp::cvec&amp; <a class="code" href="jquery_8js.html#abce695e0af988ece0826d9ad59b8160d">c</a>){</div><div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;</div><div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;c.size(); i++){</div><div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;    std::cout &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="jquery_8js.html#abce695e0af988ece0826d9ad59b8160d">c</a>(i) &lt;&lt; std::endl;</div><div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;  }</div><div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;  <span class="keywordflow">return</span>;</div><div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;}</div><div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;<span class="comment">// }}}</span></div><div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;} <span class="comment">// }}}</span></div><div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;<span class="preprocessor">#endif // ITPP_EXT_MATH_VARIOUS</span></div><div class="ttc" id="namespaceitppextmath_html_a39da0a7fb06611a087d72ecd759423c5"><div class="ttname"><a href="namespaceitppextmath.html#a39da0a7fb06611a087d72ecd759423c5">itppextmath::Chop</a></div><div class="ttdeci">Num_T Chop(const Num_T &amp;A, double epsilon=1e-12)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00899">itpp_ext_math.cpp:899</a></div></div>
<div class="ttc" id="namespacecfpmath_html_af3c32bd1720f4995f7b8bb27724ca9c1"><div class="ttname"><a href="namespacecfpmath.html#af3c32bd1720f4995f7b8bb27724ca9c1">cfpmath::parity_sum_digits_base_2</a></div><div class="ttdeci">bool parity_sum_digits_base_2(const int number_in)</div><div class="ttdef"><b>Definition:</b> <a href="cfp__math_8cpp_source.html#l00037">cfp_math.cpp:37</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_ac74a7376d1a12d1c4967b64b5fb9099e"><div class="ttname"><a href="namespaceitppextmath.html#ac74a7376d1a12d1c4967b64b5fb9099e">itppextmath::minus</a></div><div class="ttdeci">itpp::Array&lt; Num_T &gt; minus(const itpp::Array&lt; Num_T &gt; &amp;A, const Num_T &amp;B)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00838">itpp_ext_math.cpp:838</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_ac78908c186d54e62779e44c71bbbc027"><div class="ttname"><a href="namespaceitppextmath.html#ac78908c186d54e62779e44c71bbbc027">itppextmath::pretty_printing_1</a></div><div class="ttdeci">void pretty_printing_1(itpp::cvec &amp;c)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l02035">itpp_ext_math.cpp:2035</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a24486dd52ae4cac2c72fdc01755ffa97"><div class="ttname"><a href="namespaceitppextmath.html#a24486dd52ae4cac2c72fdc01755ffa97">itppextmath::apply_sigma_x</a></div><div class="ttdeci">void apply_sigma_x(itpp::Vec&lt; Num_T &gt; &amp;state, int target_bit)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01413">itpp_ext_math.cpp:1413</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_aa1d2251fb9d9d3d08c5e9e12d62313ce"><div class="ttname"><a href="namespaceitppextmath.html#aa1d2251fb9d9d3d08c5e9e12d62313ce">itppextmath::ReorderLastTwoSubsystems</a></div><div class="ttdeci">itpp::cvec ReorderLastTwoSubsystems(itpp::cvec &amp;psi, int n_middle, int n_last)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00146">itpp_ext_math.cpp:146</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a5eba978dfe35f1f0bde18022126e5872"><div class="ttname"><a href="namespaceitppextmath.html#a5eba978dfe35f1f0bde18022126e5872">itppextmath::partial_trace</a></div><div class="ttdeci">itpp::cmat partial_trace(const itpp::cvec &amp;state, int dim_leave)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00293">itpp_ext_math.cpp:293</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_aa85670a604e77be318577a0c8dfd7ef1"><div class="ttname"><a href="namespaceitppextmath.html#aa85670a604e77be318577a0c8dfd7ef1">itppextmath::TensorPow</a></div><div class="ttdeci">itpp::cvec TensorPow(const itpp::cvec state, int qub)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00482">itpp_ext_math.cpp:482</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_aea2c2fe8d93ac3b804a1543344bfad33"><div class="ttname"><a href="namespaceitppextmath.html#aea2c2fe8d93ac3b804a1543344bfad33">itppextmath::test_multiply_by_sigma_leftmost_qubit</a></div><div class="ttdeci">void test_multiply_by_sigma_leftmost_qubit()</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01897">itpp_ext_math.cpp:1897</a></div></div>
<div class="ttc" id="namespacecfpmath_html_a6e40c403a01e32df807b66c8dd8c8e3f"><div class="ttname"><a href="namespacecfpmath.html#a6e40c403a01e32df807b66c8dd8c8e3f">cfpmath::rotate_bits</a></div><div class="ttdeci">int rotate_bits(int number_in, int size_register)</div><div class="ttdef"><b>Definition:</b> <a href="cfp__math_8cpp_source.html#l00221">cfp_math.cpp:221</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_adb8774c97d655de71f3bf73fd3fc4103"><div class="ttname"><a href="namespaceitppextmath.html#adb8774c97d655de71f3bf73fd3fc4103">itppextmath::test_real_symmetric</a></div><div class="ttdeci">double test_real_symmetric(const itpp::cmat H)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01877">itpp_ext_math.cpp:1877</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a193eafa6d18269893f0419db5a089359"><div class="ttname"><a href="namespaceitppextmath.html#a193eafa6d18269893f0419db5a089359">itppextmath::swap</a></div><div class="ttdeci">void swap(itpp::Vec&lt; Num_T &gt; &amp;v, int &amp;p1, int &amp;p2)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00244">itpp_ext_math.cpp:244</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_aec1bb7f0c7aac51a35cbe6c8b9845093"><div class="ttname"><a href="namespaceitppextmath.html#aec1bb7f0c7aac51a35cbe6c8b9845093">itppextmath::to_pointers_1</a></div><div class="ttdeci">itpp::Array&lt; Num_T * &gt; to_pointers_1(itpp::Array&lt; Num_T &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01023">itpp_ext_math.cpp:1023</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_acebd855389ea589bcf60255c88f699b2"><div class="ttname"><a href="namespaceitppextmath.html#acebd855389ea589bcf60255c88f699b2">itppextmath::RemoveItem</a></div><div class="ttdeci">itpp::Array&lt; Num_T &gt; RemoveItem(const itpp::Array&lt; Num_T &gt; &amp;v, const int index)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00877">itpp_ext_math.cpp:877</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_aaf02e6e0f0ccfe846b7dcc1641be4df3"><div class="ttname"><a href="namespaceitppextmath.html#aaf02e6e0f0ccfe846b7dcc1641be4df3">itppextmath::test_unit_matrix</a></div><div class="ttdeci">double test_unit_matrix(const itpp::cmat U)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01880">itpp_ext_math.cpp:1880</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a84a859248955c9f3a8e4c4f969168d92"><div class="ttname"><a href="namespaceitppextmath.html#a84a859248955c9f3a8e4c4f969168d92">itppextmath::AreEqual_modulo_order</a></div><div class="ttdeci">bool AreEqual_modulo_order(const itpp::Array&lt; Num_T &gt; &amp;a1, const itpp::Array&lt; Num_T &gt; &amp;a2)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00081">itpp_ext_math.cpp:81</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a16056fce786f8680434907f52f86c4d5"><div class="ttname"><a href="namespaceitppextmath.html#a16056fce786f8680434907f52f86c4d5">itppextmath::test_symmetry</a></div><div class="ttdeci">double test_symmetry(const itpp::Mat&lt; Num_T &gt; H)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01799">itpp_ext_math.cpp:1799</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_adb060a4f969a3438e286f17a29f642b6"><div class="ttname"><a href="namespaceitppextmath.html#adb060a4f969a3438e286f17a29f642b6">itppextmath::apply_inverse_Rk</a></div><div class="ttdeci">void apply_inverse_Rk(itpp::cvec &amp;state, int k, int position1, int position2)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01571">itpp_ext_math.cpp:1571</a></div></div>
<div class="ttc" id="jquery_8js_html_a2335e57f79b6acfb6de59c235dc8a83e"><div class="ttname"><a href="jquery_8js.html#a2335e57f79b6acfb6de59c235dc8a83e">p</a></div><div class="ttdeci">function p(by, bw, bv)</div><div class="ttdef"><b>Definition:</b> <a href="jquery_8js_source.html#l00023">jquery.js:23</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a4e3f5074fa29e7a5999d492feeaa846f"><div class="ttname"><a href="namespaceitppextmath.html#a4e3f5074fa29e7a5999d492feeaa846f">itppextmath::Concurrence</a></div><div class="ttdeci">double Concurrence(const itpp::Mat&lt; std::complex&lt; double &gt; &gt; rho)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01635">itpp_ext_math.cpp:1635</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a5c149ffb1a8f97dae2cb8ec5969a8d2f"><div class="ttname"><a href="namespaceitppextmath.html#a5c149ffb1a8f97dae2cb8ec5969a8d2f">itppextmath::AreAllEqual</a></div><div class="ttdeci">bool AreAllEqual(const itpp::Vec&lt; Num_T &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00066">itpp_ext_math.cpp:66</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_afeada4c0dcee4b2edd2c650d18113b17"><div class="ttname"><a href="namespaceitppextmath.html#afeada4c0dcee4b2edd2c650d18113b17">itppextmath::control_u_matrix</a></div><div class="ttdeci">itpp::cmat control_u_matrix(itpp::cmat &amp;u)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01330">itpp_ext_math.cpp:1330</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a15f176e454b10ef725db0f43e171496f"><div class="ttname"><a href="namespaceitppextmath.html#a15f176e454b10ef725db0f43e171496f">itppextmath::postpend_tensor_identity</a></div><div class="ttdeci">itpp::Mat&lt; Num_T &gt; postpend_tensor_identity(const itpp::Mat&lt; Num_T &gt; &amp;Matrix, const int dim_identity)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00378">itpp_ext_math.cpp:378</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a07082ab034f2a60722bdc871d3fe7f4c"><div class="ttname"><a href="namespaceitppextmath.html#a07082ab034f2a60722bdc871d3fe7f4c">itppextmath::prepend_tensor_identity</a></div><div class="ttdeci">itpp::Mat&lt; Num_T &gt; prepend_tensor_identity(const itpp::Mat&lt; Num_T &gt; &amp;Matrix, const int dim_identity)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00427">itpp_ext_math.cpp:427</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a537927cb6f22e90041be4a26b3cda367"><div class="ttname"><a href="namespaceitppextmath.html#a537927cb6f22e90041be4a26b3cda367">itppextmath::cnot_matrix</a></div><div class="ttdeci">itpp::mat cnot_matrix()</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01321">itpp_ext_math.cpp:1321</a></div></div>
<div class="ttc" id="test__spins_8cpp_html_a09269322a87977965885dfb82976ef64"><div class="ttname"><a href="test__spins_8cpp.html#a09269322a87977965885dfb82976ef64">i2</a></div><div class="ttdeci">TCLAP::ValueArg&lt; int &gt; i2(&quot;&quot;,&quot;i2&quot;,&quot;Integer parameter&quot;, false, 4,&quot;int&quot;, cmd)</div></div>
<div class="ttc" id="namespaceitppextmath_html"><div class="ttname"><a href="namespaceitppextmath.html">itppextmath</a></div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00010">itpp_ext_math.cpp:10</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a12cc69b2d32ae7f1b52df931f8423da4"><div class="ttname"><a href="namespaceitppextmath.html#a12cc69b2d32ae7f1b52df931f8423da4">itppextmath::test_trAB</a></div><div class="ttdeci">void test_trAB()</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01933">itpp_ext_math.cpp:1933</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_abda0475e2e66d17a104aadf815755166"><div class="ttname"><a href="namespaceitppextmath.html#abda0475e2e66d17a104aadf815755166">itppextmath::locateLargestAbs</a></div><div class="ttdeci">int locateLargestAbs(const itpp::Vec&lt; Num_T &gt; &amp;e)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00030">itpp_ext_math.cpp:30</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_acbbd6e6954fd3077db382d3b4900c13b"><div class="ttname"><a href="namespaceitppextmath.html#acbbd6e6954fd3077db382d3b4900c13b">itppextmath::BasisState</a></div><div class="ttdeci">itpp::cvec BasisState(unsigned int dim, unsigned int basis_number)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01362">itpp_ext_math.cpp:1362</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a94b34321024c44b50935d589848766ce"><div class="ttname"><a href="namespaceitppextmath.html#a94b34321024c44b50935d589848766ce">itppextmath::apply_hadamard</a></div><div class="ttdeci">void apply_hadamard(itpp::cvec &amp;state, int position)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01526">itpp_ext_math.cpp:1526</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_ad369a86d5a4ee2ad4f4006be7ae95596"><div class="ttname"><a href="namespaceitppextmath.html#ad369a86d5a4ee2ad4f4006be7ae95596">itppextmath::trAB</a></div><div class="ttdeci">std::complex&lt; double &gt; trAB(const itpp::cmat &amp;A, const itpp::cmat &amp;B)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00359">itpp_ext_math.cpp:359</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_ab9a2a0e51d9c4b6ed4a66f8003ca2a7c"><div class="ttname"><a href="namespaceitppextmath.html#ab9a2a0e51d9c4b6ed4a66f8003ca2a7c">itppextmath::Hermitian_From_Compact</a></div><div class="ttdeci">itpp::Mat&lt; std::complex&lt; double &gt; &gt; Hermitian_From_Compact(const itpp::vec &amp;compact_rho)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l02002">itpp_ext_math.cpp:2002</a></div></div>
<div class="ttc" id="namespacecfpmath_html_af25df9cc11a1a7a76dfa8262e44c1702"><div class="ttname"><a href="namespacecfpmath.html#af25df9cc11a1a7a76dfa8262e44c1702">cfpmath::extract_digits</a></div><div class="ttdeci">void extract_digits(int n, int &amp;n1, int &amp;n2, int which)</div><div class="ttdef"><b>Definition:</b> <a href="cfp__math_8cpp_source.html#l00121">cfp_math.cpp:121</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a65eb87e2d7ca0696c0f5cdb1fb13499d"><div class="ttname"><a href="namespaceitppextmath.html#a65eb87e2d7ca0696c0f5cdb1fb13499d">itppextmath::total_elements_depth_2</a></div><div class="ttdeci">int total_elements_depth_2(const itpp::Array&lt; Num_T &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00089">itpp_ext_math.cpp:89</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_af068a446b43ca1b0f7fc6a4a068f6617"><div class="ttname"><a href="namespaceitppextmath.html#af068a446b43ca1b0f7fc6a4a068f6617">itppextmath::get_base_position_and_delta</a></div><div class="ttdeci">void get_base_position_and_delta(const itpp::Array&lt; itpp::ivec &gt; Positions, int &amp;delta, itpp::ivec &amp;base_position)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01077">itpp_ext_math.cpp:1077</a></div></div>
<div class="ttc" id="namespacecfpmath_html_ad47bd5592779c8df68c618acfbed5ecc"><div class="ttname"><a href="namespacecfpmath.html#ad47bd5592779c8df68c618acfbed5ecc">cfpmath::test_bit</a></div><div class="ttdeci">bool test_bit(const int a, const int bit)</div><div class="ttdef"><b>Definition:</b> <a href="cfp__math_8cpp_source.html#l00071">cfp_math.cpp:71</a></div></div>
<div class="ttc" id="namespacecfpmath_html_a584a520f6747d61595c84f3921773ef1"><div class="ttname"><a href="namespacecfpmath.html#a584a520f6747d61595c84f3921773ef1">cfpmath::h_function</a></div><div class="ttdeci">double h_function(double x)</div><div class="ttdef"><b>Definition:</b> <a href="cfp__math_8cpp_source.html#l00023">cfp_math.cpp:23</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_ad56f8c2cf7d200e6a76b7dec6fd5d5af"><div class="ttname"><a href="namespaceitppextmath.html#ad56f8c2cf7d200e6a76b7dec6fd5d5af">itppextmath::IntegerDigits</a></div><div class="ttdeci">itpp::ivec IntegerDigits(int n, int base=2, int length=0)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00708">itpp_ext_math.cpp:708</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a237ae1a42d8b29d71d473e6de252d9ea"><div class="ttname"><a href="namespaceitppextmath.html#a237ae1a42d8b29d71d473e6de252d9ea">itppextmath::GetState</a></div><div class="ttdeci">itpp::cvec GetState(itpp::cmat &amp;U, itpp::vec &amp;eigenvalues, itpp::cvec &amp;psi_0, double t)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01768">itpp_ext_math.cpp:1768</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a4988c4bb105945c54a1906c7f0726017"><div class="ttname"><a href="namespaceitppextmath.html#a4988c4bb105945c54a1906c7f0726017">itppextmath::ElementwiseAddInFirstElement</a></div><div class="ttdeci">itpp::Array&lt; Num_T &gt; ElementwiseAddInFirstElement(const Cosa joda, const itpp::Array&lt; Num_T &gt; &amp;A)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00922">itpp_ext_math.cpp:922</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_ae3604664b2498af7926093b3bc96b142"><div class="ttname"><a href="namespaceitppextmath.html#ae3604664b2498af7926093b3bc96b142">itppextmath::read_state</a></div><div class="ttdeci">itpp::cvec read_state(int d)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01980">itpp_ext_math.cpp:1980</a></div></div>
<div class="ttc" id="jquery_8js_html_abce695e0af988ece0826d9ad59b8160d"><div class="ttname"><a href="jquery_8js.html#abce695e0af988ece0826d9ad59b8160d">c</a></div><div class="ttdeci">var c</div><div class="ttdef"><b>Definition:</b> <a href="jquery_8js_source.html#l00023">jquery.js:23</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_ab20cb428322021acd9e79ea1c861809e"><div class="ttname"><a href="namespaceitppextmath.html#ab20cb428322021acd9e79ea1c861809e">itppextmath::waist</a></div><div class="ttdeci">itpp::ivec waist(const itpp::Array&lt; Num_T &gt; &amp;A)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l02026">itpp_ext_math.cpp:2026</a></div></div>
<div class="ttc" id="namespacecfpmath_html_a6cba567d2bb25f561d3c649d578bc0cf"><div class="ttname"><a href="namespacecfpmath.html#a6cba567d2bb25f561d3c649d578bc0cf">cfpmath::my_mod</a></div><div class="ttdeci">double my_mod(double x, double y)</div><div class="ttdef"><b>Definition:</b> <a href="cfp__math_8cpp_source.html#l00454">cfp_math.cpp:454</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_aaa330146cd7fa196506d393531bb8e3a"><div class="ttname"><a href="namespaceitppextmath.html#aaa330146cd7fa196506d393531bb8e3a">itppextmath::sum_positive_derivatives</a></div><div class="ttdeci">double sum_positive_derivatives(const itpp::vec &amp;f)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00019">itpp_ext_math.cpp:19</a></div></div>
<div class="ttc" id="namespacecfpmath_html_a5f21fc6d719ebe76110d5b941e3c9c6e"><div class="ttname"><a href="namespacecfpmath.html#a5f21fc6d719ebe76110d5b941e3c9c6e">cfpmath::maximum_prime_power_divisor</a></div><div class="ttdeci">int maximum_prime_power_divisor(const int number, const int base)</div><div class="ttdef"><b>Definition:</b> <a href="cfp__math_8cpp_source.html#l00351">cfp_math.cpp:351</a></div></div>
<div class="ttc" id="test__spins_8cpp_html_a3900d1f52906b420113c1d1d8310ea84"><div class="ttname"><a href="test__spins_8cpp.html#a3900d1f52906b420113c1d1d8310ea84">i1</a></div><div class="ttdeci">TCLAP::ValueArg&lt; int &gt; i1(&quot;&quot;,&quot;i1&quot;,&quot;Integer parameter&quot;, false, 4,&quot;int&quot;, cmd)</div></div>
<div class="ttc" id="namespaceitppextmath_html_a321e6541aead62bb6178f7474b9c5d37"><div class="ttname"><a href="namespaceitppextmath.html#a321e6541aead62bb6178f7474b9c5d37">itppextmath::Union</a></div><div class="ttdeci">Num_T Union(const Num_T &amp;A)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00797">itpp_ext_math.cpp:797</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_ac8477886770d8df6d3dedba2eca68d43"><div class="ttname"><a href="namespaceitppextmath.html#ac8477886770d8df6d3dedba2eca68d43">itppextmath::TensorProduct</a></div><div class="ttdeci">itpp::Mat&lt; Num_T &gt; TensorProduct(const itpp::Mat&lt; Num_T &gt; &amp;Matrix1, const itpp::Mat&lt; Num_T &gt; &amp;Matrix2, const itpp::Mat&lt; Num_T &gt; &amp;Matrix3)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00436">itpp_ext_math.cpp:436</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a3c5e7754b2bf3687684855e161145ac7"><div class="ttname"><a href="namespaceitppextmath.html#a3c5e7754b2bf3687684855e161145ac7">itppextmath::split_string</a></div><div class="ttdeci">itpp::Vec&lt; std::string &gt; split_string(std::string sentence)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01989">itpp_ext_math.cpp:1989</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a6e10ce87347da5fabd873a19305265e3"><div class="ttname"><a href="namespaceitppextmath.html#a6e10ce87347da5fabd873a19305265e3">itppextmath::test_UDiagUdagger</a></div><div class="ttdeci">void test_UDiagUdagger()</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01924">itpp_ext_math.cpp:1924</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_abedfdae89806f348cd9f1001f858473c"><div class="ttname"><a href="namespaceitppextmath.html#abedfdae89806f348cd9f1001f858473c">itppextmath::exponentiate_nonsym</a></div><div class="ttdeci">itpp::cmat exponentiate_nonsym(const itpp::cmat &amp;Matrix)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00549">itpp_ext_math.cpp:549</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_ac364f5f204bb63b79ff6e7072c5e4233"><div class="ttname"><a href="namespaceitppextmath.html#ac364f5f204bb63b79ff6e7072c5e4233">itppextmath::test_GetState_mixed</a></div><div class="ttdeci">void test_GetState_mixed()</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01842">itpp_ext_math.cpp:1842</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a1b13aed0cbfe9879b304f139ee2c5565"><div class="ttname"><a href="namespaceitppextmath.html#a1b13aed0cbfe9879b304f139ee2c5565">itppextmath::multiply_by_sigma_leftmost_qubit</a></div><div class="ttdeci">itpp::cmat multiply_by_sigma_leftmost_qubit(const itpp::cmat &amp;A, int sigma_label)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01539">itpp_ext_math.cpp:1539</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a1497e509510ac3450b76342b601ea8f7"><div class="ttname"><a href="namespaceitppextmath.html#a1497e509510ac3450b76342b601ea8f7">itppextmath::sort</a></div><div class="ttdeci">itpp::Array&lt; itpp::ivec &gt; sort(const itpp::Array&lt; itpp::ivec &gt; &amp;input)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00201">itpp_ext_math.cpp:201</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a88c313cb5025a2404533d608382e56f4"><div class="ttname"><a href="namespaceitppextmath.html#a88c313cb5025a2404533d608382e56f4">itppextmath::Werner</a></div><div class="ttdeci">itpp::Mat&lt; std::complex&lt; double &gt; &gt; Werner(const double alpha)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01350">itpp_ext_math.cpp:1350</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_aaca75ffe2ba18dd924046cd125412b2a"><div class="ttname"><a href="namespaceitppextmath.html#aaca75ffe2ba18dd924046cd125412b2a">itppextmath::apply_sigma_z</a></div><div class="ttdeci">void apply_sigma_z(itpp::Vec&lt; Num_T &gt; &amp;state, int target_bit)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01444">itpp_ext_math.cpp:1444</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_ad3aeb711d30cdab97d60fa479ad75a5b"><div class="ttname"><a href="namespaceitppextmath.html#ad3aeb711d30cdab97d60fa479ad75a5b">itppextmath::Purity</a></div><div class="ttdeci">double Purity(const itpp::Mat&lt; std::complex&lt; double &gt; &gt; &amp;rho)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01667">itpp_ext_math.cpp:1667</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a8d15e678f0eb7602b2a1d3cf0bb0da79"><div class="ttname"><a href="namespaceitppextmath.html#a8d15e678f0eb7602b2a1d3cf0bb0da79">itppextmath::InteractionPicture</a></div><div class="ttdeci">itpp::cmat InteractionPicture(const itpp::cmat &amp;H0, const itpp::cmat &amp;As, double t)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00629">itpp_ext_math.cpp:629</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a2957cbd7ea32e1ddf2991b255efeba46"><div class="ttname"><a href="namespaceitppextmath.html#a2957cbd7ea32e1ddf2991b255efeba46">itppextmath::LambdaMatrixQubitLeft</a></div><div class="ttdeci">itpp::mat LambdaMatrixQubitLeft(itpp::cmat U)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01692">itpp_ext_math.cpp:1692</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a3968eec2bb8d3671580eeccdb7075c59"><div class="ttname"><a href="namespaceitppextmath.html#a3968eec2bb8d3671580eeccdb7075c59">itppextmath::OuterSum</a></div><div class="ttdeci">itpp::Mat&lt; Num_T &gt; OuterSum(const itpp::Vec&lt; Num_T &gt; &amp;A, const itpp::Vec&lt; Num_T &gt; &amp;B)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00777">itpp_ext_math.cpp:777</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_ad1c9dbe11deb8cc15723cbf40e1aab42"><div class="ttname"><a href="namespaceitppextmath.html#ad1c9dbe11deb8cc15723cbf40e1aab42">itppextmath::get_column</a></div><div class="ttdeci">itpp::Vec&lt; Num_T &gt; get_column(const itpp::Array&lt; itpp::Vec&lt; Num_T &gt; &gt; &amp;A, const int element)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00675">itpp_ext_math.cpp:675</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_ad194f701fd62db23d80d8a6d489f84b8"><div class="ttname"><a href="namespaceitppextmath.html#ad194f701fd62db23d80d8a6d489f84b8">itppextmath::diagonal_sigma_z</a></div><div class="ttdeci">itpp::ivec diagonal_sigma_z(int encoded_positions, int qubits)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01338">itpp_ext_math.cpp:1338</a></div></div>
<div class="ttc" id="namespacecfpmath_html_aa9552f51ffa8ef05e0724fe8a18f4456"><div class="ttname"><a href="namespacecfpmath.html#aa9552f51ffa8ef05e0724fe8a18f4456">cfpmath::insert_bit</a></div><div class="ttdeci">int insert_bit(const int n, const int bit_position, const int bit)</div><div class="ttdef"><b>Definition:</b> <a href="cfp__math_8cpp_source.html#l00079">cfp_math.cpp:79</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a752ccdb02d0a0220e2b2e9be72bdff78"><div class="ttname"><a href="namespaceitppextmath.html#a752ccdb02d0a0220e2b2e9be72bdff78">itppextmath::all_n_bit_numbers</a></div><div class="ttdeci">itpp::ivec all_n_bit_numbers(int bits_on, int total_number_bits)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00739">itpp_ext_math.cpp:739</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a849bb716d90d591917ae25e9fe8455c7"><div class="ttname"><a href="namespaceitppextmath.html#a849bb716d90d591917ae25e9fe8455c7">itppextmath::RandomState</a></div><div class="ttdeci">itpp::cvec RandomState(unsigned int dim)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01358">itpp_ext_math.cpp:1358</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_ad3aafab077621b362f7f10ee2324663c"><div class="ttname"><a href="namespaceitppextmath.html#ad3aafab077621b362f7f10ee2324663c">itppextmath::Replace</a></div><div class="ttdeci">itpp::Array&lt; Num_T &gt; Replace(const itpp::Array&lt; Num_T &gt; v, Num_T old, Num_T nuevo)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00191">itpp_ext_math.cpp:191</a></div></div>
<div class="ttc" id="test__spins_8cpp_html_a27ffb1722fa87a1797329ba47b0d8221"><div class="ttname"><a href="test__spins_8cpp.html#a27ffb1722fa87a1797329ba47b0d8221">qubits</a></div><div class="ttdeci">TCLAP::ValueArg&lt; int &gt; qubits(&quot;q&quot;,&quot;qubits&quot;,&quot;Number of qubits&quot;, false, 4,&quot;int&quot;, cmd)</div></div>
<div class="ttc" id="namespaceitppextmath_html_a91eeb311735ee693e643e3f1189206a1"><div class="ttname"><a href="namespaceitppextmath.html#a91eeb311735ee693e643e3f1189206a1">itppextmath::InverseParticipationRatio</a></div><div class="ttdeci">double InverseParticipationRatio(const itpp::cvec &amp;psi)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01627">itpp_ext_math.cpp:1627</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a64687f56dda82cdd5ed267dde0af8122"><div class="ttname"><a href="namespaceitppextmath.html#a64687f56dda82cdd5ed267dde0af8122">itppextmath::vector_greater_than</a></div><div class="ttdeci">bool vector_greater_than(const itpp::ivec &amp;v, const itpp::ivec &amp;w)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00174">itpp_ext_math.cpp:174</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_acc807c2273283a3fe0b404851943f874"><div class="ttname"><a href="namespaceitppextmath.html#acc807c2273283a3fe0b404851943f874">itppextmath::applyUDiagUdagger</a></div><div class="ttdeci">void applyUDiagUdagger(const itpp::cmat &amp;U, const itpp::cvec &amp;E, itpp::cvec &amp;psi)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00600">itpp_ext_math.cpp:600</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a66f3fd22ef38f31e434d397ef89089a5"><div class="ttname"><a href="namespaceitppextmath.html#a66f3fd22ef38f31e434d397ef89089a5">itppextmath::Intersection</a></div><div class="ttdeci">itpp::Array&lt; itpp::ivec &gt; Intersection(const itpp::Array&lt; itpp::ivec &gt; &amp;Array1, const itpp::Array&lt; itpp::ivec &gt; &amp;Array2)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00865">itpp_ext_math.cpp:865</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_abaa0ae2d646957edc4e61a2737d013f5"><div class="ttname"><a href="namespaceitppextmath.html#abaa0ae2d646957edc4e61a2737d013f5">itppextmath::AreEqual</a></div><div class="ttdeci">bool AreEqual(const itpp::Array&lt; Num_T &gt; &amp;a1, const itpp::Array&lt; Num_T &gt; &amp;a2)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00058">itpp_ext_math.cpp:58</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_afaf99d19367b6887a3d6ad79622eee98"><div class="ttname"><a href="namespaceitppextmath.html#afaf99d19367b6887a3d6ad79622eee98">itppextmath::exponentiate_real_symmetric</a></div><div class="ttdeci">itpp::mat exponentiate_real_symmetric(const itpp::mat &amp;Matrix)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00499">itpp_ext_math.cpp:499</a></div></div>
<div class="ttc" id="namespacecfpmath_html_ae2adca2461cce2b4efede98619da8be4"><div class="ttname"><a href="namespacecfpmath.html#ae2adca2461cce2b4efede98619da8be4">cfpmath::log_base_2</a></div><div class="ttdeci">int log_base_2(const int n)</div><div class="ttdef"><b>Definition:</b> <a href="cfp__math_8cpp_source.html#l00184">cfp_math.cpp:184</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a69d7429d0bccffb25ef684db99b439bb"><div class="ttname"><a href="namespaceitppextmath.html#a69d7429d0bccffb25ef684db99b439bb">itppextmath::proportionality_constant</a></div><div class="ttdeci">Num_T proportionality_constant(const itpp::Vec&lt; Num_T &gt; &amp;a1, const itpp::Vec&lt; Num_T &gt; &amp;a2)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00116">itpp_ext_math.cpp:116</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a7c4a435bcb8b2ecb25235a3ad973977d"><div class="ttname"><a href="namespaceitppextmath.html#a7c4a435bcb8b2ecb25235a3ad973977d">itppextmath::GetBlock</a></div><div class="ttdeci">itpp::ivec GetBlock(const itpp::Array&lt; itpp::ivec &gt; &amp;positions, const int length_cell, const int length_grid)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01042">itpp_ext_math.cpp:1042</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_ac1a654a660fc98e909a8fb1b4db7ccc6"><div class="ttname"><a href="namespaceitppextmath.html#ac1a654a660fc98e909a8fb1b4db7ccc6">itppextmath::to_pointers_2</a></div><div class="ttdeci">itpp::Array&lt; itpp::Array&lt; Num_T * &gt; &gt; to_pointers_2(itpp::Array&lt; itpp::Array&lt; Num_T &gt; &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01030">itpp_ext_math.cpp:1030</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_af0b1e30122a83066769ccf797e2a8a57"><div class="ttname"><a href="namespaceitppextmath.html#af0b1e30122a83066769ccf797e2a8a57">itppextmath::exponentiate</a></div><div class="ttdeci">itpp::cmat exponentiate(const itpp::cmat &amp;Matrix)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00514">itpp_ext_math.cpp:514</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a151166d23f2c832ce7df23d15f12dd4f"><div class="ttname"><a href="namespaceitppextmath.html#a151166d23f2c832ce7df23d15f12dd4f">itppextmath::apply_control_u</a></div><div class="ttdeci">void apply_control_u(itpp::cvec &amp;state, int control, int target, itpp::cmat &amp;u)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01606">itpp_ext_math.cpp:1606</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a972d9558ac547657f651ac0eddeb85f1"><div class="ttname"><a href="namespaceitppextmath.html#a972d9558ac547657f651ac0eddeb85f1">itppextmath::ReorderTwoSubsystems</a></div><div class="ttdeci">void ReorderTwoSubsystems(itpp::cvec &amp;psi, int n_last)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00169">itpp_ext_math.cpp:169</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a9b56cdfb45116723442c1434a4975279"><div class="ttname"><a href="namespaceitppextmath.html#a9b56cdfb45116723442c1434a4975279">itppextmath::rotation_matrix</a></div><div class="ttdeci">itpp::mat rotation_matrix(double theta)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00011">itpp_ext_math.cpp:11</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_aaef6ee82ad47629961429a15f68a7e20"><div class="ttname"><a href="namespaceitppextmath.html#aaef6ee82ad47629961429a15f68a7e20">itppextmath::proportionality_test</a></div><div class="ttdeci">double proportionality_test(const itpp::Vec&lt; Num_T &gt; &amp;a1, const itpp::Vec&lt; Num_T &gt; &amp;a2, Num_T proportionality_constant)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00127">itpp_ext_math.cpp:127</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a70ccdba26ac2984b3a1acc5dea2835ff"><div class="ttname"><a href="namespaceitppextmath.html#a70ccdba26ac2984b3a1acc5dea2835ff">itppextmath::compare</a></div><div class="ttdeci">double compare(const itpp::cmat &amp;A, const itpp::cmat &amp;B)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00039">itpp_ext_math.cpp:39</a></div></div>
<div class="ttc" id="namespacecfpmath_html_aea8886520bdf0d732569e0b9873bc69f"><div class="ttname"><a href="namespacecfpmath.html#aea8886520bdf0d732569e0b9873bc69f">cfpmath::isqrt</a></div><div class="ttdeci">long isqrt(long x)</div><div class="ttdef"><b>Definition:</b> <a href="cfp__math_8cpp_source.html#l00419">cfp_math.cpp:419</a></div></div>
<div class="ttc" id="namespacecfpmath_html_a0e87a9ace78d12b29b6219ec271fa11a"><div class="ttname"><a href="namespacecfpmath.html#a0e87a9ace78d12b29b6219ec271fa11a">cfpmath::merge_two_numbers</a></div><div class="ttdeci">int merge_two_numbers(const int a, const int b, const int mask)</div><div class="ttdef"><b>Definition:</b> <a href="cfp__math_8cpp_source.html#l00091">cfp_math.cpp:91</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a0f92f4a79dc98a783d42226b051aad08"><div class="ttname"><a href="namespaceitppextmath.html#a0f92f4a79dc98a783d42226b051aad08">itppextmath::swap_matrix</a></div><div class="ttdeci">itpp::mat swap_matrix()</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01312">itpp_ext_math.cpp:1312</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_aa9464d9a16932158d63be6a894c94c63"><div class="ttname"><a href="namespaceitppextmath.html#aa9464d9a16932158d63be6a894c94c63">itppextmath::BulkPositionUnion2PositionSets</a></div><div class="ttdeci">itpp::Mat&lt; int &gt; BulkPositionUnion2PositionSets(const itpp::Mat&lt; int &gt; &amp;A, const itpp::Mat&lt; int &gt; &amp;B)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00894">itpp_ext_math.cpp:894</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a38e9b44c58de6e5fdd72095f905f9fc7"><div class="ttname"><a href="namespaceitppextmath.html#a38e9b44c58de6e5fdd72095f905f9fc7">itppextmath::sorted</a></div><div class="ttdeci">bool sorted(const itpp::Vec&lt; Num_T &gt; v)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01802">itpp_ext_math.cpp:1802</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_ae0acdad1591e836b69c3db7335b4880b"><div class="ttname"><a href="namespaceitppextmath.html#ae0acdad1591e836b69c3db7335b4880b">itppextmath::PrepareInitialStatesForSingleQubitTomography</a></div><div class="ttdeci">itpp::Array&lt; itpp::cvec &gt; PrepareInitialStatesForSingleQubitTomography()</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01732">itpp_ext_math.cpp:1732</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a6f77ba21eefa0948681d3ca8e9166a6e"><div class="ttname"><a href="namespaceitppextmath.html#a6f77ba21eefa0948681d3ca8e9166a6e">itppextmath::my_mod</a></div><div class="ttdeci">itpp::Vec&lt; Num_T &gt; my_mod(const itpp::Vec&lt; Num_T &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01966">itpp_ext_math.cpp:1966</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a9a765f05511d21dbd85405855b733c0b"><div class="ttname"><a href="namespaceitppextmath.html#a9a765f05511d21dbd85405855b733c0b">itppextmath::LambdaMatrixQubitRight</a></div><div class="ttdeci">itpp::mat LambdaMatrixQubitRight(itpp::cmat U)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01678">itpp_ext_math.cpp:1678</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_ae41f1804449573b7ae08ec0b322950a4"><div class="ttname"><a href="namespaceitppextmath.html#ae41f1804449573b7ae08ec0b322950a4">itppextmath::Modulize</a></div><div class="ttdeci">itpp::ivec Modulize(const itpp::ivec &amp;intvec, const itpp::ivec n)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00943">itpp_ext_math.cpp:943</a></div></div>
<div class="ttc" id="namespacecfpmath_html_a34b0482e902f9d69532a1272a63ded74"><div class="ttname"><a href="namespacecfpmath.html#a34b0482e902f9d69532a1272a63ded74">cfpmath::test_int_log</a></div><div class="ttdeci">bool test_int_log(const int base, const int n)</div><div class="ttdef"><b>Definition:</b> <a href="cfp__math_8cpp_source.html#l00379">cfp_math.cpp:379</a></div></div>
<div class="ttc" id="test__spins_8cpp_html_ad38665656d61d491d26c78ce5393a4f2"><div class="ttname"><a href="test__spins_8cpp.html#ad38665656d61d491d26c78ce5393a4f2">position2</a></div><div class="ttdeci">TCLAP::ValueArg&lt; int &gt; position2(&quot;&quot;,&quot;position2&quot;,&quot;The position of something&quot;, false, 3,&quot;int&quot;, cmd)</div></div>
<div class="ttc" id="namespacecfpmath_html_a7fb0bc89f043d158b9c542650e2ac1ac"><div class="ttname"><a href="namespacecfpmath.html#a7fb0bc89f043d158b9c542650e2ac1ac">cfpmath::integer_part_log</a></div><div class="ttdeci">int integer_part_log(const int base, const int n)</div><div class="ttdef"><b>Definition:</b> <a href="cfp__math_8cpp_source.html#l00398">cfp_math.cpp:398</a></div></div>
<div class="ttc" id="itpp__ext__math_8h_html"><div class="ttname"><a href="itpp__ext__math_8h.html">itpp_ext_math.h</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_ae46953c9ecd4f5f972446309e11da2cf"><div class="ttname"><a href="namespaceitppextmath.html#ae46953c9ecd4f5f972446309e11da2cf">itppextmath::magnetic</a></div><div class="ttdeci">itpp::cmat magnetic(itpp::vec b, int total)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01404">itpp_ext_math.cpp:1404</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a6b144c204bc6ad381195bcd1b43c9eba"><div class="ttname"><a href="namespaceitppextmath.html#a6b144c204bc6ad381195bcd1b43c9eba">itppextmath::OperatorToVectorPauliBasis</a></div><div class="ttdeci">itpp::cvec OperatorToVectorPauliBasis(itpp::cmat rho)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01759">itpp_ext_math.cpp:1759</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a3e4e11cf0eb431f4a70cbe83efb8ec2e"><div class="ttname"><a href="namespaceitppextmath.html#a3e4e11cf0eb431f4a70cbe83efb8ec2e">itppextmath::test_reality</a></div><div class="ttdeci">double test_reality(const itpp::cmat &amp;H)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01874">itpp_ext_math.cpp:1874</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_afb213f888c57016e4342d002570217b4"><div class="ttname"><a href="namespaceitppextmath.html#afb213f888c57016e4342d002570217b4">itppextmath::rotationaly_order_vector_renormalized_lattices_3</a></div><div class="ttdeci">itpp::Array&lt; itpp::ivec &gt; rotationaly_order_vector_renormalized_lattices_3(const itpp::Array&lt; itpp::ivec &gt; &amp;A, const int length_mera)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01092">itpp_ext_math.cpp:1092</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a5a3a9bbb71fed40c63b43fb948ec1336"><div class="ttname"><a href="namespaceitppextmath.html#a5a3a9bbb71fed40c63b43fb948ec1336">itppextmath::del</a></div><div class="ttdeci">itpp::Array&lt; Num_T &gt; del(const itpp::Array&lt; Num_T &gt; &amp;A, const int i)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00823">itpp_ext_math.cpp:823</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a5f9b38a799e52559d90d12d3672cb004"><div class="ttname"><a href="namespaceitppextmath.html#a5f9b38a799e52559d90d12d3672cb004">itppextmath::extend_qubit_operator</a></div><div class="ttdeci">itpp::Mat&lt; Num_T &gt; extend_qubit_operator(const itpp::Mat&lt; Num_T &gt; &amp;Matrix, const int encoded_nontrivial_positions, const int total_number_of_qubits)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00393">itpp_ext_math.cpp:393</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_afe7ec9cbea296802fdc91317bc679452"><div class="ttname"><a href="namespaceitppextmath.html#afe7ec9cbea296802fdc91317bc679452">itppextmath::Matrix_to_Array</a></div><div class="ttdeci">itpp::Array&lt; itpp::Vec&lt; Num_T &gt; &gt; Matrix_to_Array(const itpp::Mat&lt; Num_T &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01958">itpp_ext_math.cpp:1958</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_afe49034f5f5fe3d1283091d37e8cdd7d"><div class="ttname"><a href="namespaceitppextmath.html#afe49034f5f5fe3d1283091d37e8cdd7d">itppextmath::single_qubit_operator_tensor_identity</a></div><div class="ttdeci">itpp::Mat&lt; Num_T &gt; single_qubit_operator_tensor_identity(const itpp::Mat&lt; Num_T &gt; &amp;Matrix, const int position_operator, const int total_number_of_qubits)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00412">itpp_ext_math.cpp:412</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a98fa71ea9c89981016ed20498aade3a8"><div class="ttname"><a href="namespaceitppextmath.html#a98fa71ea9c89981016ed20498aade3a8">itppextmath::Array_to_Matrix</a></div><div class="ttdeci">itpp::Mat&lt; Num_T &gt; Array_to_Matrix(const itpp::Array&lt; itpp::Vec&lt; Num_T &gt; &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01949">itpp_ext_math.cpp:1949</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a5c762614546e227cccac5f98cb574743"><div class="ttname"><a href="namespaceitppextmath.html#a5c762614546e227cccac5f98cb574743">itppextmath::CircularRotateLeft</a></div><div class="ttdeci">itpp::Array&lt; Num_T &gt; CircularRotateLeft(const itpp::Array&lt; Num_T &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00269">itpp_ext_math.cpp:269</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_acbc392d9bfaea8f5490df9ceda31060d"><div class="ttname"><a href="namespaceitppextmath.html#acbc392d9bfaea8f5490df9ceda31060d">itppextmath::DeScale</a></div><div class="ttdeci">itpp::Array&lt; itpp::ivec &gt; DeScale(const itpp::Array&lt; itpp::ivec &gt; &amp;set_of_vectors, const int scale_factor)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00984">itpp_ext_math.cpp:984</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_ab436d38c7f426bf653854ff7d919faa4"><div class="ttname"><a href="namespaceitppextmath.html#ab436d38c7f426bf653854ff7d919faa4">itppextmath::Shuffle</a></div><div class="ttdeci">itpp::Array&lt; Num_T &gt; Shuffle(const itpp::Array&lt; Num_T &gt; &amp;vct)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00238">itpp_ext_math.cpp:238</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a3bcd230a7582a2c56fd9e77cbd39d7bc"><div class="ttname"><a href="namespaceitppextmath.html#a3bcd230a7582a2c56fd9e77cbd39d7bc">itppextmath::Last</a></div><div class="ttdeci">Num_T Last(const itpp::Array&lt; Num_T &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00096">itpp_ext_math.cpp:96</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_aba26eee000b8df67356695966d055999"><div class="ttname"><a href="namespaceitppextmath.html#aba26eee000b8df67356695966d055999">itppextmath::sigma</a></div><div class="ttdeci">itpp::cmat sigma(itpp::ivec is)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01254">itpp_ext_math.cpp:1254</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_ada22580533a133f0a29eb9b23c5d0ba0"><div class="ttname"><a href="namespaceitppextmath.html#ada22580533a133f0a29eb9b23c5d0ba0">itppextmath::BellState</a></div><div class="ttdeci">itpp::vec BellState(int dim=4)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01368">itpp_ext_math.cpp:1368</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_abcdaea5c0bfa66e3ce8801ff8ef1c2b0"><div class="ttname"><a href="namespaceitppextmath.html#abcdaea5c0bfa66e3ce8801ff8ef1c2b0">itppextmath::test_GetState_pure</a></div><div class="ttdeci">void test_GetState_pure()</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01810">itpp_ext_math.cpp:1810</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a0bfea3f1b78541f6331a6b20cd7a83fd"><div class="ttname"><a href="namespaceitppextmath.html#a0bfea3f1b78541f6331a6b20cd7a83fd">itppextmath::apply_sigma</a></div><div class="ttdeci">void apply_sigma(itpp::cvec &amp;state, int Pauli_i, int PositionQubit)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01458">itpp_ext_math.cpp:1458</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a56519dfcf9ee1818eda9cae11ff0bf32"><div class="ttname"><a href="namespaceitppextmath.html#a56519dfcf9ee1818eda9cae11ff0bf32">itppextmath::ConcurrenceFromPure</a></div><div class="ttdeci">double ConcurrenceFromPure(const itpp::cvec psi)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01654">itpp_ext_math.cpp:1654</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a675965a2ef652e3bca87e74a0946b343"><div class="ttname"><a href="namespaceitppextmath.html#a675965a2ef652e3bca87e74a0946b343">itppextmath::UDiagUdagger</a></div><div class="ttdeci">itpp::cmat UDiagUdagger(const itpp::cmat &amp;U, const itpp::cvec &amp;E)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00607">itpp_ext_math.cpp:607</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a1db134bcc673ab99ee2bc0edc73cebbb"><div class="ttname"><a href="namespaceitppextmath.html#a1db134bcc673ab99ee2bc0edc73cebbb">itppextmath::ArrayToMatrix</a></div><div class="ttdeci">itpp::Mat&lt; Num_T &gt; ArrayToMatrix(const itpp::Array&lt; itpp::Vec&lt; Num_T &gt; &gt; &amp;A)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00768">itpp_ext_math.cpp:768</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_ab860b21cbbd29f9682209fb7ac337126"><div class="ttname"><a href="namespaceitppextmath.html#ab860b21cbbd29f9682209fb7ac337126">itppextmath::partial_trace_qubits</a></div><div class="ttdeci">itpp::cmat partial_trace_qubits(itpp::cvec state, int which)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00316">itpp_ext_math.cpp:316</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a1cc0f2ca72e8dd850a466114e350ce18"><div class="ttname"><a href="namespaceitppextmath.html#a1cc0f2ca72e8dd850a466114e350ce18">itppextmath::Proyector</a></div><div class="ttdeci">itpp::Mat&lt; Num_T &gt; Proyector(const itpp::Vec&lt; Num_T &gt; &amp;psi)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00650">itpp_ext_math.cpp:650</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_aef230d2cc84f05a6bad47a5c91d95f2d"><div class="ttname"><a href="namespaceitppextmath.html#aef230d2cc84f05a6bad47a5c91d95f2d">itppextmath::vonNeumann</a></div><div class="ttdeci">double vonNeumann(const itpp::vec &amp;lambda)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01657">itpp_ext_math.cpp:1657</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a59fff49eaa8848d0b918cb4b81f5e435"><div class="ttname"><a href="namespaceitppextmath.html#a59fff49eaa8848d0b918cb4b81f5e435">itppextmath::rotational_order</a></div><div class="ttdeci">itpp::Array&lt; itpp::ivec &gt; rotational_order(const itpp::Array&lt; itpp::ivec &gt; &amp;A)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01128">itpp_ext_math.cpp:1128</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a6c557215e9887ded17c2155bbf4762b5"><div class="ttname"><a href="namespaceitppextmath.html#a6c557215e9887ded17c2155bbf4762b5">itppextmath::LinSpace</a></div><div class="ttdeci">itpp::Array&lt; itpp::ivec &gt; LinSpace(const int i_i, const int i_f, const int step=1)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l02015">itpp_ext_math.cpp:2015</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a4fec23b0332add59f23332792a8e6ca1"><div class="ttname"><a href="namespaceitppextmath.html#a4fec23b0332add59f23332792a8e6ca1">itppextmath::hadamard_matrix</a></div><div class="ttdeci">itpp::mat hadamard_matrix()</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01305">itpp_ext_math.cpp:1305</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_abf0356d0d20e239a6e944507ed3324de"><div class="ttname"><a href="namespaceitppextmath.html#abf0356d0d20e239a6e944507ed3324de">itppextmath::Scale</a></div><div class="ttdeci">itpp::Array&lt; itpp::ivec &gt; Scale(const itpp::Array&lt; itpp::ivec &gt; &amp;set_of_vectors, const int scale_factor)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00991">itpp_ext_math.cpp:991</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a3d3e9977b9bdeb3ea61da531c0515d15"><div class="ttname"><a href="namespaceitppextmath.html#a3d3e9977b9bdeb3ea61da531c0515d15">itppextmath::bvec_to_int</a></div><div class="ttdeci">int bvec_to_int(itpp::bvec bool_array)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00725">itpp_ext_math.cpp:725</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_aedd48b707f175c2f42ccb42465412f3b"><div class="ttname"><a href="namespaceitppextmath.html#aedd48b707f175c2f42ccb42465412f3b">itppextmath::Displace</a></div><div class="ttdeci">itpp::Array&lt; itpp::ivec &gt; Displace(const itpp::Array&lt; itpp::ivec &gt; &amp;set_of_vectors, const itpp::ivec displacement_vector)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00998">itpp_ext_math.cpp:998</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a76daabedbbc57e8fd0d48b52163657be"><div class="ttname"><a href="namespaceitppextmath.html#a76daabedbbc57e8fd0d48b52163657be">itppextmath::apply_cnot</a></div><div class="ttdeci">void apply_cnot(itpp::cvec &amp;state, int control, int target)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01591">itpp_ext_math.cpp:1591</a></div></div>
<div class="ttc" id="jquery_8js_html_aa4026ad5544b958e54ce5e106fa1c805"><div class="ttname"><a href="jquery_8js.html#aa4026ad5544b958e54ce5e106fa1c805">b</a></div><div class="ttdeci">var b</div><div class="ttdef"><b>Definition:</b> <a href="jquery_8js_source.html#l00016">jquery.js:16</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a7ea3a197d0c3a54f23af6363e74e4114"><div class="ttname"><a href="namespaceitppextmath.html#a7ea3a197d0c3a54f23af6363e74e4114">itppextmath::Flatten</a></div><div class="ttdeci">itpp::Array&lt; Num_T &gt; Flatten(const itpp::Array&lt; itpp::Array&lt; Num_T &gt; &gt; &amp;vct)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00231">itpp_ext_math.cpp:231</a></div></div>
<div class="ttc" id="namespacecfpmath_html_abf5bd8dc5d8af42a850231816e60e95f"><div class="ttname"><a href="namespacecfpmath.html#abf5bd8dc5d8af42a850231816e60e95f">cfpmath::pow_2</a></div><div class="ttdeci">int pow_2(const int n)</div><div class="ttdef"><b>Definition:</b> <a href="cfp__math_8cpp_source.html#l00169">cfp_math.cpp:169</a></div></div>
<div class="ttc" id="test__spins_8cpp_html_a081a3c90b5ddb319e1866471b948e0c5"><div class="ttname"><a href="test__spins_8cpp.html#a081a3c90b5ddb319e1866471b948e0c5">position</a></div><div class="ttdeci">TCLAP::ValueArg&lt; int &gt; position(&quot;&quot;,&quot;position&quot;,&quot;The position of something&quot;, false, 1,&quot;int&quot;, cmd)</div></div>
<div class="ttc" id="namespaceitppextmath_html_a89117a3a364f78471cf07bdac7de934e"><div class="ttname"><a href="namespaceitppextmath.html#a89117a3a364f78471cf07bdac7de934e">itppextmath::Reorder_state_tensor_form</a></div><div class="ttdeci">itpp::cmat Reorder_state_tensor_form(itpp::cvec vector, int which)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00274">itpp_ext_math.cpp:274</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_adecbf33ed00c63a7a4bce35b76c741ee"><div class="ttname"><a href="namespaceitppextmath.html#adecbf33ed00c63a7a4bce35b76c741ee">itppextmath::DirectSum</a></div><div class="ttdeci">itpp::Mat&lt; Num_T &gt; DirectSum(const itpp::Array&lt; itpp::Mat&lt; Num_T &gt; &gt; &amp;Matrices)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00660">itpp_ext_math.cpp:660</a></div></div>
<div class="ttc" id="namespacecfpmath_html_a6500e09a78acb96aa9644c42d791f7ac"><div class="ttname"><a href="namespacecfpmath.html#a6500e09a78acb96aa9644c42d791f7ac">cfpmath::BitCount</a></div><div class="ttdeci">int BitCount(const unsigned int u)</div><div class="ttdef"><b>Definition:</b> <a href="cfp__math_8cpp_source.html#l00052">cfp_math.cpp:52</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_ae225202b58c132e34b3c319e989ab259"><div class="ttname"><a href="namespaceitppextmath.html#ae225202b58c132e34b3c319e989ab259">itppextmath::BlochToQubit</a></div><div class="ttdeci">itpp::cvec BlochToQubit(double theta, double phi)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01375">itpp_ext_math.cpp:1375</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a59c598f2d335ceca9a4479209da33016"><div class="ttname"><a href="namespaceitppextmath.html#a59c598f2d335ceca9a4479209da33016">itppextmath::unique_elements</a></div><div class="ttdeci">bool unique_elements(const Num_T &amp;A)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00794">itpp_ext_math.cpp:794</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_af040733b94e262246c8401442ad83240"><div class="ttname"><a href="namespaceitppextmath.html#af040733b94e262246c8401442ad83240">itppextmath::ElementwiseRemoveFirstElement</a></div><div class="ttdeci">itpp::Array&lt; Num_T &gt; ElementwiseRemoveFirstElement(const itpp::Array&lt; Num_T &gt; &amp;A)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00929">itpp_ext_math.cpp:929</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_ac683572299a46ad974f32433f4942af6"><div class="ttname"><a href="namespaceitppextmath.html#ac683572299a46ad974f32433f4942af6">itppextmath::UpDownMostIndexFermionicMatrix</a></div><div class="ttdeci">void UpDownMostIndexFermionicMatrix(itpp::cmat &amp;MatrixEven, itpp::cmat &amp;MatrixOdd, const std::string direction, const std::string position)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01141">itpp_ext_math.cpp:1141</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a32239cc4ac99e886a2d64c42a8fe481c"><div class="ttname"><a href="namespaceitppextmath.html#a32239cc4ac99e886a2d64c42a8fe481c">itppextmath::TomographySingleQubit</a></div><div class="ttdeci">itpp::mat TomographySingleQubit(itpp::Array&lt; itpp::cmat &gt; &amp;rhos_f)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01741">itpp_ext_math.cpp:1741</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a222aa8c457a93a8667f89eae38c08c0b"><div class="ttname"><a href="namespaceitppextmath.html#a222aa8c457a93a8667f89eae38c08c0b">itppextmath::exp_minus_i_b_sigma</a></div><div class="ttdeci">itpp::cmat exp_minus_i_b_sigma(itpp::vec b)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01391">itpp_ext_math.cpp:1391</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a2c0da80b7f18e53b39bff77d391a4ad4"><div class="ttname"><a href="namespaceitppextmath.html#a2c0da80b7f18e53b39bff77d391a4ad4">itppextmath::apply_sigma_y</a></div><div class="ttdeci">void apply_sigma_y(itpp::Vec&lt; Num_T &gt; &amp;state, int target_bit)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01429">itpp_ext_math.cpp:1429</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_ac0b2e1a0c9dfa5af9118227349c7679b"><div class="ttname"><a href="namespaceitppextmath.html#ac0b2e1a0c9dfa5af9118227349c7679b">itppextmath::AtimesDiagB</a></div><div class="ttdeci">itpp::Mat&lt; Num_T &gt; AtimesDiagB(const itpp::Mat&lt; Num_T &gt; &amp;A, const itpp::Vec&lt; Num_T &gt; &amp;B)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00681">itpp_ext_math.cpp:681</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_ac08a530c4601ec09e5f166ad73976691"><div class="ttname"><a href="namespaceitppextmath.html#ac08a530c4601ec09e5f166ad73976691">itppextmath::apply_sum_sigma_x</a></div><div class="ttdeci">void apply_sum_sigma_x(itpp::cvec &amp;state)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01470">itpp_ext_math.cpp:1470</a></div></div>
<div class="ttc" id="test__spins_8cpp_html_abf188b893e95a7f7bf6b71cd2ea0ef18"><div class="ttname"><a href="test__spins_8cpp.html#abf188b893e95a7f7bf6b71cd2ea0ef18">Im</a></div><div class="ttdeci">std::complex&lt; double &gt; Im(0, 1)</div></div>
<div class="ttc" id="namespaceitppextmath_html_a3455ade154f0c4bfb3d61b3a618ced9a"><div class="ttname"><a href="namespaceitppextmath.html#a3455ade154f0c4bfb3d61b3a618ced9a">itppextmath::PrintCompactHermitian</a></div><div class="ttdeci">void PrintCompactHermitian(itpp::Mat&lt; std::complex&lt; double &gt; &gt; &amp;rho)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00695">itpp_ext_math.cpp:695</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a26e979969612aaea7a704f4d90e4c4a6"><div class="ttname"><a href="namespaceitppextmath.html#a26e979969612aaea7a704f4d90e4c4a6">itppextmath::all_bit_rotations</a></div><div class="ttdeci">itpp::ivec all_bit_rotations(int n, int size_register)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00750">itpp_ext_math.cpp:750</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a39b5a8e62e81f612edf3092c1743caae"><div class="ttname"><a href="namespaceitppextmath.html#a39b5a8e62e81f612edf3092c1743caae">itppextmath::EmptyIntersection</a></div><div class="ttdeci">bool EmptyIntersection(const itpp::Array&lt; itpp::ivec &gt; &amp;Array1, const itpp::Array&lt; itpp::ivec &gt; &amp;Array2)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00854">itpp_ext_math.cpp:854</a></div></div>
<div class="ttc" id="namespacecfpmath_html_a688f1d2b481a55142e9951be28b3275d"><div class="ttname"><a href="namespacecfpmath.html#a688f1d2b481a55142e9951be28b3275d">cfpmath::set_bit</a></div><div class="ttdeci">int set_bit(const int a, const int bit)</div><div class="ttdef"><b>Definition:</b> <a href="cfp__math_8cpp_source.html#l00068">cfp_math.cpp:68</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_ac8dcabc8b02af619d6cde04eacbcf29c"><div class="ttname"><a href="namespaceitppextmath.html#ac8dcabc8b02af619d6cde04eacbcf29c">itppextmath::Contains</a></div><div class="ttdeci">bool Contains(const itpp::Mat&lt; Num_T &gt; &amp;v, const itpp::Vec&lt; Num_T &gt; &amp;e)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00042">itpp_ext_math.cpp:42</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a11134fb2561fe6ea29284218fbf365f9"><div class="ttname"><a href="namespaceitppextmath.html#a11134fb2561fe6ea29284218fbf365f9">itppextmath::apply_swap</a></div><div class="ttdeci">void apply_swap(itpp::cvec &amp;state, int position1, int position2)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01581">itpp_ext_math.cpp:1581</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_aec6e270e26d591a2e1133ca16d4ac80f"><div class="ttname"><a href="namespaceitppextmath.html#aec6e270e26d591a2e1133ca16d4ac80f">itppextmath::test_unitarity</a></div><div class="ttdeci">double test_unitarity(const itpp::cmat U)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01888">itpp_ext_math.cpp:1888</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a3a498f8d2a2d26403d30503bab3c7c28"><div class="ttname"><a href="namespaceitppextmath.html#a3a498f8d2a2d26403d30503bab3c7c28">itppextmath::Outer</a></div><div class="ttdeci">itpp::Array&lt; Num_T &gt; Outer(const itpp::Array&lt; Num_T &gt; &amp;A, const itpp::Array&lt; Num_T &gt; &amp;B)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00786">itpp_ext_math.cpp:786</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_adf6341f5e389169d62c9e5b265e28e6c"><div class="ttname"><a href="namespaceitppextmath.html#adf6341f5e389169d62c9e5b265e28e6c">itppextmath::DisplaceScaleModulize</a></div><div class="ttdeci">itpp::Array&lt; itpp::ivec &gt; DisplaceScaleModulize(const itpp::Array&lt; itpp::ivec &gt; &amp;set_of_vectors, const itpp::ivec displacement_vector, const int scale_factor, const int n)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01012">itpp_ext_math.cpp:1012</a></div></div>
<div class="ttc" id="jquery_8js_html_ab26645c014aa005ecedef329ecf58c99"><div class="ttname"><a href="jquery_8js.html#ab26645c014aa005ecedef329ecf58c99">k</a></div><div class="ttdeci">var k</div><div class="ttdef"><b>Definition:</b> <a href="jquery_8js_source.html#l00023">jquery.js:23</a></div></div>
<div class="ttc" id="cfp__math_8cpp_html"><div class="ttname"><a href="cfp__math_8cpp.html">cfp_math.cpp</a></div></div>
<div class="ttc" id="test__spins_8cpp_html_a2ee8a150bb54ec98032ed8bbaa10addc"><div class="ttname"><a href="test__spins_8cpp.html#a2ee8a150bb54ec98032ed8bbaa10addc">Delta</a></div><div class="ttdeci">TCLAP::ValueArg&lt; double &gt; Delta(&quot;&quot;,&quot;Delta&quot;,&quot;Energy separation&quot;, false, 1,&quot;double&quot;, cmd)</div></div>
<div class="ttc" id="namespaceitppextmath_html_a973576807093c6ff42014306311f888b"><div class="ttname"><a href="namespaceitppextmath.html#a973576807093c6ff42014306311f888b">itppextmath::Position_FirstIntersection</a></div><div class="ttdeci">int Position_FirstIntersection(const itpp::Array&lt; Num_T &gt; &amp;v, const Num_T &amp;e)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00099">itpp_ext_math.cpp:99</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a76c3aff62b81888e8bd7d56b5dc3fbd4"><div class="ttname"><a href="namespaceitppextmath.html#a76c3aff62b81888e8bd7d56b5dc3fbd4">itppextmath::DoTheyIntersect</a></div><div class="ttdeci">bool DoTheyIntersect(const itpp::Array&lt; itpp::ivec &gt; &amp;Array1, const itpp::Array&lt; itpp::ivec &gt; &amp;Array2)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00072">itpp_ext_math.cpp:72</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a66e07ac3e1e89b87e651dc4872d0edf3"><div class="ttname"><a href="namespaceitppextmath.html#a66e07ac3e1e89b87e651dc4872d0edf3">itppextmath::Elementwiseconcat</a></div><div class="ttdeci">itpp::Array&lt; Num_T &gt; Elementwiseconcat(const Num_T &amp;A, const itpp::Array&lt; Num_T &gt; &amp;B)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00936">itpp_ext_math.cpp:936</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a9635792731019c1bae82eb75d85aec0c"><div class="ttname"><a href="namespaceitppextmath.html#a9635792731019c1bae82eb75d85aec0c">itppextmath::int_to_bool</a></div><div class="ttdeci">itpp::Vec&lt; bool &gt; int_to_bool(const int n, const int total_number_bits)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00734">itpp_ext_math.cpp:734</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a6a5a690ed8231c740e7c2fc5fe73501c"><div class="ttname"><a href="namespaceitppextmath.html#a6a5a690ed8231c740e7c2fc5fe73501c">itppextmath::apply_gate</a></div><div class="ttdeci">void apply_gate(itpp::cvec &amp;state, int nwhich, itpp::cmat gate)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l01482">itpp_ext_math.cpp:1482</a></div></div>
<div class="ttc" id="namespaceitppextmath_html_a1551882a7f03a19b1c2e5b8c07ab0970"><div class="ttname"><a href="namespaceitppextmath.html#a1551882a7f03a19b1c2e5b8c07ab0970">itppextmath::CircularRotateRight</a></div><div class="ttdeci">itpp::Array&lt; Num_T &gt; CircularRotateRight(const itpp::Array&lt; Num_T &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="itpp__ext__math_8cpp_source.html#l00251">itpp_ext_math.cpp:251</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
